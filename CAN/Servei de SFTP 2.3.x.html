<html>
    <head>
        <title>Canigó - Espai Privat : Servei de SFTP 2.3.x</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Canigó - Espai Privat : Servei de SFTP 2.3.x
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jun 16, 2010 by <font color="#0050B2">admin</font>.
				    </div>

				    <h1><a name="ServeideSFTP2.3.x-SERVEIDESFTP"></a>SERVEI DE SFTP</h1>

<p><br clear="all" />
<br clear="all" />
<div>
<ul><a href='#ServeideSFTP2.3.x-SERVEIDESFTP'>
    <li>SERVEI DE SFTP</li></a><a href='#ServeideSFTP2.3.x-Introducci%C3%B3'>
    <li>Introducció</li></a>
<ul><a href='#ServeideSFTP2.3.x-Prop%C3%B2sit'>
    <li>Propòsit</li></a><a href='#ServeideSFTP2.3.x-ContextiEscenarisd%27%C3%9As'>
    <li>Context i Escenaris d'Ús</li></a><a href='#ServeideSFTP2.3.x-VersionsiDepend%C3%A8ncies'>
    <li>Versions i Dependències</li></a><a href='#ServeideSFTP2.3.x-Aquivadirigit'>
    <li>A qui va dirigit</li></a><a href='#ServeideSFTP2.3.x-DocumentsiFontsdeRefer%C3%A8ncia'>
    <li>Documents i Fonts de Referència</li></a><a href='#ServeideSFTP2.3.x-Glossari'>
    <li>Glossari</li></a>
</ul><a href='#ServeideSFTP2.3.x-Descripci%C3%B3Detallada'>
    <li>Descripció Detallada</li></a>
<ul><a href='#ServeideSFTP2.3.x-ArquitecturaiComponents'>
    <li>Arquitectura i Components</li></a><a href='#ServeideSFTP2.3.x-Instal.laci%C3%B3iConfiguraci%C3%B3'>
    <li>Instal.lació  i Configuració</li></a>
<ul><a href='#ServeideSFTP2.3.x-Instal.laci%C3%B3'>
    <li>Instal.lació</li></a><a href='#ServeideSFTP2.3.x-Configuraci%C3%B3'>
    <li>Configuració</li></a>
</ul><a href='#ServeideSFTP2.3.x-Utilitzaci%C3%B3delServei'>
    <li>Utilització del Servei</li></a>
<ul><a href='#ServeideSFTP2.3.x-Realitzarconnexi%C3%B3'>
    <li>Realitzar connexió</li></a><a href='#ServeideSFTP2.3.x-Realitzardesconnexi%C3%B3delservidorSFTP'>
    <li>Realitzar desconnexió del servidor SFTP</li></a><a href='#ServeideSFTP2.3.x-Realitzardownloadd%27unfitxer'>
    <li>Realitzar download d'un fitxer</li></a><a href='#ServeideSFTP2.3.x-Realitzaruploadd%27unfitxer'>
    <li>Realitzar upload d'un fitxer</li></a><a href='#ServeideSFTP2.3.x-Obtenirlallistadenomsdelsfitxersdelservidorremot'>
    <li>Obtenir  la llista de noms dels fitxers del servidor remot</li></a><a href='#ServeideSFTP2.3.x-Crearunfitxeralservidorremot'>
    <li>Crear un fitxer al servidor remot</li></a><a href='#ServeideSFTP2.3.x-Crearundirectorialservidorremot'>
    <li>Crear un directori al servidor remot</li></a><a href='#ServeideSFTP2.3.x-Esborrarunfitxeralservidorremot'>
    <li>Esborrar un fitxer al servidor remot</li></a>
</ul>
</ul><a href='#ServeideSFTP2.3.x-Exemples'>
    <li>Exemples</li></a>
<ul><a href='#ServeideSFTP2.3.x-TestsUnitaris'>
    <li>Tests Unitaris</li></a>
</ul>
</ul></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<h1><a name="ServeideSFTP2.3.x-Introducci%C3%B3"></a>Introducció</h1>


<h2><a name="ServeideSFTP2.3.x-Prop%C3%B2sit"></a>Propòsit</h2>

<p>El servei de SFTP de Canigó permet enviar i rebre arxius entre el servidor on s'executa l'aplicació a altres servidors de forma segura mitjançant l'intercanvi de claus.</p>

<p>El servei està basat en les llibreries JSCH i Commons-VFS, la primera es tracta d'un projecte <em>open source</em> que permet la connexió via SSH a qualsevol màquina. La segona llibrería és un projecte també <em>open_source</em> de la Apache Foundation que permet treballar amb més facilitat amb la JSCH, donant eines per crear connexions SFTP (entre d'altres) contra un servidor.</p>

<h2><a name="ServeideSFTP2.3.x-ContextiEscenarisd%27%C3%9As"></a>Context i Escenaris d'Ús</h2>

<p>El servei de SFTP es troba dins dels serveis d'integració de Canigó.</p>

<p>El seu ús és necessari en cas de voler intercanviar fitxers entre servidors  utilitzant el protocol SFTP, és a dir, protocol FTP de forma segura.</p>

<h2><a name="ServeideSFTP2.3.x-VersionsiDepend%C3%A8ncies"></a>Versions i Dependències</h2>

<p>Les dependències descrites a la següent url son requerides per tal de compilar i fer funcionar el projecte:<br/>
<a href="http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_3/canigo-services-sftp/dependencies.html" title="Visit page outside Confluence">Dependències Servei de SFTP</a></p>

<h2><a name="ServeideSFTP2.3.x-Aquivadirigit"></a>A qui va dirigit</h2>

<p>Aquest document va dirigit als següents perfils:</p>
<ol>
	<li>Programador. Per conèixer l'ús del servei.</li>
	<li>Arquitecte. Per conèixer quins són els components i la configuració del servei.</li>
	<li>Administrador. Per conèixer com configurar el servei en cadascun dels  entorns en cas de necessitat.</li>
</ol>


<h2><a name="ServeideSFTP2.3.x-DocumentsiFontsdeRefer%C3%A8ncia"></a>Documents i Fonts de Referència</h2>

<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> [1] </th>
<th class='confluenceTh'> JSCH </th>
<th class='confluenceTh'> <a href="http://www.jcraft.com/jsch/" title="Visit page outside Confluence">http://www.jcraft.com/jsch/</a> </th>
</tr>
<tr>
<th class='confluenceTh'> [2] </th>
<th class='confluenceTh'> Commons VFS </th>
<th class='confluenceTh'> <a href="http://commons.apache.org/vfs/" title="Visit page outside Confluence">http://commons.apache.org/vfs/</a> </th>
</tr>
</tbody></table>

<h2><a name="ServeideSFTP2.3.x-Glossari"></a>Glossari</h2>

<p><b>SFTP</b><br/>
<em>Secure File Transfer Protocol</em> (Protocol de Transferència Segura d'Arxius), es tracta d'un protocol de transferència de fitxers entre computadors de forma segura.</p>

<p><b>Download</b><br/>
Rebre arxius des d'un servidor.</p>

<p><b>Upload</b><br/>
Enviar arxius a un servidor.</p>

<p><b>Socket</b><br/>
Port del servidor habilitat per realitzar la transferència de fitxers/streams mitjançant el protocol SFTP.</p>

<h1><a name="ServeideSFTP2.3.x-Descripci%C3%B3Detallada"></a>Descripció Detallada</h1>


<h2><a name="ServeideSFTP2.3.x-ArquitecturaiComponents"></a>Arquitectura i Components</h2>

<p><b>Canigó</b> ofereix una arquitectura d'ús del protocol SFTP totalment deslligada de qualsevol implementació.</p>

<p>Els components podem classificar-los en:</p>
<ol>
	<li>Interfícies i Components Genèrics. Interfícies del servei i components d'ús  general amb independència de la implementació escollida.</li>
	<li>Implementació de les interfícies.<br/>
Es pot trobar tota la documentació JavaDoc i el codi font referent aquests components a les següents urls:</li>
</ol>


<p><ins>JavaDoc:</ins> <a href="http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_3/canigo-services-sftp/apidocs/index.html" title="Visit page outside Confluence">http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_3/canigo-services-sftp/apidocs/index.html</a><br/>
<ins>Codi Font:</ins>&nbsp; <a href="http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_3/canigo-services-sftp/xref/index.html" title="Visit page outside Confluence">http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_3/canigo-services-sftp/xref/index.html </a></p>

<h2><a name="ServeideSFTP2.3.x-Instal.laci%C3%B3iConfiguraci%C3%B3"></a>Instal.lació  i Configuració</h2>


<h3><a name="ServeideSFTP2.3.x-Instal.laci%C3%B3"></a>Instal.lació</h3>

<p>La instal.lació del servei requereix de la utilització de la llibreria  'canigo-services-sftp' i les dependències indicades a l'apartat 'Introducció - Versions i Dependències'.</p>

<p>Per la instal.lació dels components Commons VFS i JSCH, no es requereix res a part dels JAR indicats en les dependències "Commons VFS" i "JSCH".</p>

<h3><a name="ServeideSFTP2.3.x-Configuraci%C3%B3"></a>Configuració</h3>

<p>La configuració del Servei de SFTP implica:</p>
<ul>
	<li>Definir el servei.</li>
</ul>


<p>La definició del servei requereix configurar un bean amb un identificador (es recomana usar 'sftpService') i els següents atributs:</p>

<p>Atributs:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atribut</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> class </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Implementació concreta del servei a  utilitzar. <br clear="all" />
<br clear="all" />
Opcions: <br clear="all" />
&#35;  net.gencat.ctti.canigo.services.sftp.impl.SftpServiceImpl </td>
</tr>
<tr>
<td class='confluenceTd'> init-method </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Mètode d'inicialització del servei. <br clear="all" />
<br clear="all" />
Opcions: <br clear="all" />
&#35;  init </td>
</tr>
</tbody></table>
<p>També es poden configurar les següents propietats:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> logService </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Referència a la definició del servei  de traces. </td>
</tr>
<tr>
<td class='confluenceTd'> ftpUrl </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Adreça del servidor. </td>
</tr>
<tr>
<td class='confluenceTd'> ftpPort </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Socket de connexió al servidor. </td>
</tr>
<tr>
<td class='confluenceTd'> ftpUsername </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Usuari per la connexió al servidor. </td>
</tr>
<tr>
<td class='confluenceTd'> ftpPassword </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Contrasenya per la connexió al servidor. </td>
</tr>
<tr>
<td class='confluenceTd'> identityPath <br clear="all" /> </td>
<td class='confluenceTd'> No <br clear="all" /> </td>
<td class='confluenceTd'> Path del fitxer de claus privades. El fitxer ha de tenir format OpenSSH (RSA o DSA). <br clear="all" />
<br clear="all" />
Aquesta propietat està disponible a partir de la versió <b>2.3.7</b> del Framework. <br clear="all" /> </td>
</tr>
<tr>
<td class='confluenceTd'> strictHostKeyChecking </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica si volem intercanviar claus amb el servidor o no. </td>
</tr>
<tr>
<td class='confluenceTd'> knownHosts </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Directori on es troba el fitxer de claus SSH. </td>
</tr>
<tr>
<td class='confluenceTd'> proxyType </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Tipus de proxy. </td>
</tr>
<tr>
<td class='confluenceTd'> proxyHost </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Adreça del proxy. </td>
</tr>
<tr>
<td class='confluenceTd'> proxyPort </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Port del proxy. </td>
</tr>
<tr>
<td class='confluenceTd'> userDirIsRoot <br clear="all" /> </td>
<td class='confluenceTd'> No <br clear="all" /> </td>
<td class='confluenceTd'> Possibilitat d'indicar els paths relatius al directori home de l'usuari.<br/>
<b>true</b> --&gt; Paths relatius a partir del directori home<br/>
<b>false</b> --&gt; Paths absoluts<br/>
Aquesta propietat està disponible a partir de la versió <b>2.3.10</b> del Framework. <br clear="all" /> </td>
</tr>
<tr>
<td class='confluenceTd'> uploadChecksum <br clear="all" /> </td>
<td class='confluenceTd'> No <br clear="all" /> </td>
<td class='confluenceTd'> Ofereix la possibilitat de generar i pujar un fitxer de checksum.<br/>
<b>default</b> --&gt; Generarà i farà l'upload d'un fitxer .md5 a més del fitxer indicat.<br/>
<b>all</b> --&gt; Generarà i farà l'upload d'un fitxer .md5, .sha1 a més del fitxer indicat.<br/>
<b>md5</b> --&gt; Generarà i farà l'upload d'un fitxer .md5 a més del fitxer indicat.<br/>
<b>sha1</b> --&gt; Generarà i farà l'upload d'un fitxer .sha1 a més del fitxer indicat.<br/>
<b>none</b> --&gt; No generarà cap fitxer de checksum. El mateix que si no s'informa aquesta propietat.<br/>
Aquesta propietat està disponible a partir de la versió <b>2.3.10</b> del Framework. <br clear="all" /> </td>
</tr>
<tr>
<td class='confluenceTd'> uploadChecksumException<br clear="all" /> </td>
<td class='confluenceTd'> No <br clear="all" /> </td>
<td class='confluenceTd'> Serveix per a indicar si un error de checksum és bloquejant o no.<br/>
<b>true</b> --&gt; Si es produeix un error al generar el fitxer de checksum, es llançarà una excepció i no es pujarà el fitxer al servidor.<br/>
<b>false</b> --&gt; Si es produeix un error al generar el fitxer de checksum, es mostrarà un log d'error, però continuarà la pujada del fitxer indicat al servidor.<br/>
Aquesta propietat està disponible a partir de la versió <b>2.3.10</b> del Framework. <br clear="all" /> </td>
</tr>
<tr>
<td class='confluenceTd'> downloadChecksum <br clear="all" /> </td>
<td class='confluenceTd'> No <br clear="all" /> </td>
<td class='confluenceTd'> Ofereix la possibilitat de generar i pujar un fitxer de checksum.<br/>
<b>default</b> --&gt; Validarà que el fitxer descarregat és correcte mitjançant el fitxer .md5.<br/>
<b>md5</b> --&gt; Validarà que el fitxer descarregat és correcte mitjançant el fitxer .md5.<br/>
<b>sha1</b> --&gt; Validarà que el fitxer descarregat és correcte mitjançant el fitxer .sha1.<br/>
<b>none</b> --&gt; No realitzarà cap tipus de validació sobre el fitxer descarregat.<br/>
Aquesta propietat està disponible a partir de la versió <b>2.3.10</b> del Framework. <br clear="all" /> </td>
</tr>
<tr>
<td class='confluenceTd'> downloadChecksumValidation <br clear="all" /> </td>
<td class='confluenceTd'> No <br clear="all" /> </td>
<td class='confluenceTd'> Serveix per a indicar el nivell de bloqueig del checksum.<br/>
<b>exception</b> --&gt; Si no coincideix el checksum generat del fitxer descarregat amb el que hi ha al servidor es llançarà una excepció.<br/>
<b>log</b> --&gt; Si no coincideix el checksum generat del fitxer descarregat amb el que hi ha al servidor mostrarà un log d'error.<br/>
<b>none</b> --&gt; Si no coincideix el checksum generat del fitxer descarregat amb el que hi ha al servidor no farà res.<br/>
Aquesta propietat està disponible a partir de la versió <b>2.3.10</b> del Framework. <br clear="all" /> </td>
</tr>
</tbody></table>
<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">...
&lt;!- SFTP service -&gt;
&lt;bean id=<span class="code-quote">"sftpService"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.sftp.impl.SftpServiceImpl"</span> init-method=<span class="code-quote">"init"</span>&gt;
	&lt;property name=<span class="code-quote">"logService"</span>&gt;
		&lt;ref bean=<span class="code-quote">"loggingService"</span> /&gt;
	&lt;/property&gt;
	&lt;property name=<span class="code-quote">"ftpUrl"</span> value=<span class="code-quote">"192.168.1.100"</span>/&gt;
	&lt;property name=<span class="code-quote">"ftpPort"</span> value=<span class="code-quote">"22"</span>/&gt;
	&lt;property name=<span class="code-quote">"ftpUsername"</span> value=<span class="code-quote">"username"</span>/&gt;
	&lt;property name=<span class="code-quote">"ftpPassword"</span> value=<span class="code-quote">"password"</span>/&gt;
	&lt;property name=<span class="code-quote">"knownHosts"</span> value=<span class="code-quote">"C:/ssh/known_hosts"</span>/&gt;
	&lt;property name=<span class="code-quote">"strictHostKeyChecking"</span> value=<span class="code-quote">"yes"</span>/&gt;
&lt;/bean&gt;

...
&lt;bean id=<span class="code-quote">"loggingService"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.logging.log4j.Log4JServiceImpl"</span> init-method=<span class="code-quote">"init"</span>&gt;
...
&lt;/bean&gt;
...</pre>
</div></div><br clear="all" /> Exemple identificació fitxer de claus privades:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">...
&lt;!- SFTP service -&gt;
&lt;bean id=<span class="code-quote">"sftpService"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.sftp.impl.SftpServiceImpl"</span> init-method=<span class="code-quote">"init"</span>&gt;
	&lt;property name=<span class="code-quote">"logService"</span>&gt;
		&lt;ref bean=<span class="code-quote">"loggingService"</span> /&gt;
	&lt;/property&gt;
	&lt;property name=<span class="code-quote">"ftpUrl"</span> value=<span class="code-quote">"192.168.1.100"</span>/&gt;
	&lt;property name=<span class="code-quote">"ftpPort"</span> value=<span class="code-quote">"22"</span>/&gt;
	&lt;property name=<span class="code-quote">"ftpUsername"</span> value=<span class="code-quote">"username"</span>/&gt;
	&lt;property name=<span class="code-quote">"identityPath"</span> value=<span class="code-quote">"c:/ssh/privateKeyRSA.cfg"</span>/&gt;
	&lt;property name=<span class="code-quote">"knownHosts"</span> value=<span class="code-quote">"C:/ssh/known_hosts"</span>/&gt;
	&lt;property name=<span class="code-quote">"strictHostKeyChecking"</span> value=<span class="code-quote">"yes"</span>/&gt;
&lt;/bean&gt;

...
&lt;bean id=<span class="code-quote">"loggingService"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.logging.log4j.Log4JServiceImpl"</span> init-method=<span class="code-quote">"init"</span>&gt;
...
&lt;/bean&gt;
...</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<h2><a name="ServeideSFTP2.3.x-Utilitzaci%C3%B3delServei"></a>Utilització del Servei</h2>


<h3><a name="ServeideSFTP2.3.x-Realitzarconnexi%C3%B3"></a>Realitzar connexió</h3>

<p>Tal i com s'ha comentat a l'apartat 'Arquitectura i Components' les classes  principals per realitzar transferències de fitxers es troben al package 'net.gencat.ctti.canigo.services.sftp'.</p>

<p>Per realitzar una connexió segura només cal inicialitzar el bean tal i com s'ha indicat a l'apartat 'Configuració'.<br/>
Tenim dos formes de fer la connexió al servidor segons haguem indicat o no l'usuari i el password a la configuració, en el cas de que s'hagi indicat, farem la crida de la següent manera:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sftpService!= <span class="code-keyword">null</span> ) {
    sftpService.login();
}</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En canvi, si no hem indicat a través de la configuració l'usuari i la contrasenya per realitzar la connexió, es farà la següent crida:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sftpService!= <span class="code-keyword">null</span> ) {
    sftpService.login(usuari,contrasenya);
}</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
A més a més, l'API del servei permet fer la connexió a un servidor de forma dinàmica, és a dir, es pot indicar l'adreça i port del servidor al que ens volem connectar en temps d'execució, per fer-ho el servei ofereix un tercer mètode de login:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sftpService!= <span class="code-keyword">null</span> ) {
    sftpService.login(usuari,contrasenya,ftpUrl,ftpPort);
}</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
Realitzarem doncs els següents passos:
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>En primer lloc comprovarem que s'ha realitzat correctament la injecció a la  nostra classe del servei de SFTP.</li>
	<li>Seguidament cridem al mètode login() o login(usuari,contrasenya) per realitzar la connexió i l'autentificació al servidor remot mitjançant el protocol SFTP.</li>
</ol>


<p>El mètode retorna un valor booleà (TRUE/FALSE) indicant si la connexió s'ha realitzat correctament.</p>

<p><b>NOTA:</b> Per realitzar una connexió al servidor a través d'un proxy cal informar els següents camps:</p>
<ul>
	<li>proxyType: Tipus de proxy, pot tenir els valors http o socks.</li>
	<li>proxyHost: Adreça del host.</li>
	<li>proxyPort: Port del host.
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"sftpService"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.sftp.impl.SftpServiceImpl"</span> init-method=<span class="code-quote">"init"</span>&gt;
...
    &lt;property name=<span class="code-quote">"proxyType"</span> value=<span class="code-quote">"http"</span>/&gt;
    &lt;property name=<span class="code-quote">"proxyHost"</span> value=<span class="code-quote">"192.168.1.101"</span>/&gt;
    &lt;property name=<span class="code-quote">"proxyPort"</span> value=<span class="code-quote">"22"</span>/&gt;
...
&lt;/bean&gt;</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></li>
</ul>


<h3><a name="ServeideSFTP2.3.x-Realitzardesconnexi%C3%B3delservidorSFTP"></a>Realitzar desconnexió del servidor SFTP</h3>

<p>Per realitzar la desconnexió del servidor FTP seguirem un patró com el mostrat en el següent exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sftpService!= <span class="code-keyword">null</span> ) {
    <span class="code-keyword">if</span> (sftpService.isLogged()) {
        sftpService.logout();
    }
}</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Realitzarem doncs els següents passos:
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>En primer lloc comprovarem que s'ha realitzat correctament la injecció a la  nostra classe del servei de SFTP.</li>
	<li>Realitzar la desconnexió del servidor SFTP cridant al mètode logout().</li>
</ol>


<h3><a name="ServeideSFTP2.3.x-Realitzardownloadd%27unfitxer"></a>Realitzar download d'un fitxer</h3>

<p>Per realitzar un download d'un fitxer seguirem un patró com el mostrat en el següent exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sftpService!= <span class="code-keyword">null</span> ) {
    sftpService.login();
    <span class="code-keyword">if</span> (sftpService.isLogged()) {
        sftpService.downloadFile(fileName, localPath, remotePath);
        sftpService.logout();
    }
}</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Realitzarem doncs els següents passos:
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>En primer lloc comprovarem que s'ha realitzat correctament la injecció a la  nostra classe del servei de SFTP.</li>
	<li>Seguidament cridem al mètode login() per realitzar la connexió i  l'autentificació al servidor remot mitjançant el protocol SFTP.</li>
	<li>En cas de que la connexió al servidor remot s'hagi realitzat correctament es crida al mètode downloadFile() per realitzar el download del fitxer del  servidor remot.</li>
	<li>Realitzar la desconnexió del servidor SFTP.</li>
</ol>


<p>Es crida el mètode downloadFile() que amb els següents paràmetres:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>ordre</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Tipus</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> 1 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Nom del fitxer del servidor remot  que es vol realitzar el download. </td>
</tr>
<tr>
<td class='confluenceTd'> 2 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Directori local on es vol guardar el fitxer. </td>
</tr>
<tr>
<td class='confluenceTd'> 3 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Directori remot on es troba el fitxer a baixar. </td>
</tr>
</tbody></table>
<p>I retorna:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>ordre</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Tipus</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> 1 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> boolean </td>
<td class='confluenceTd'> TRUE o FALSE segons s'ha realitzat correcta o incorrectament el procés. </td>
</tr>
</tbody></table>

<h3><a name="ServeideSFTP2.3.x-Realitzaruploadd%27unfitxer"></a>Realitzar upload d'un fitxer</h3>

<p>Per realitzar un upload d'un fitxer seguirem un patró com el mostrat en el  següent exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sftpService!= <span class="code-keyword">null</span> ) {
    sftpService.login();
    <span class="code-keyword">if</span> (sftpService.isLogged()) {
        sftpService.uploadFile(fileName, localPath, remotePath);
        sftpService.logout();
    }
}</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Realitzarem doncs els següents passos:
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>En primer lloc comprovarem que s'ha realitzat correctament la injecció a la  nostra classe del servei de SFTP.</li>
	<li>Seguidament cridem al mètode login() per realitzar la connexió i  l'autentificació al servidor remot mitjançant el protocol SFTP.</li>
	<li>En cas de que la connexió al servidor remot s'hagi realitzat correctament es  crida al mètode uploadFile() per realitzar el upload del fitxer del servidor local al servidor remot.</li>
	<li>Realitzar la desconnexió del servidor SFTP.</li>
</ol>


<p>Es crida el mètode uploadFile() que amb els següents paràmetres:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>ordre</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Tipus</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> 1 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Nom del fitxer del servidor remot  que es vol realitzar el upload. </td>
</tr>
<tr>
<td class='confluenceTd'> 2 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Directori local on es troba el fitxer a pujar. </td>
</tr>
<tr>
<td class='confluenceTd'> 3 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Directori remot on es vol guardar el fitxer. </td>
</tr>
</tbody></table>

<h3><a name="ServeideSFTP2.3.x-Obtenirlallistadenomsdelsfitxersdelservidorremot"></a>Obtenir  la llista de noms dels fitxers del servidor remot</h3>

<p>Per obtenir la llista de fitxers en una carpeta d'un servidor remot seguirem  un patró com el mostrat en el següent exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sftpService!= <span class="code-keyword">null</span> ) {
    sftpService.login();
    <span class="code-keyword">if</span> (sftpService.isLogged()) {
        FileObject[] listFiles = sftpService.listFiles(remotePath);
        sftpService.logout();
    }
}</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Realitzarem doncs els següents passos:
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>En primer lloc comprovarem que s'ha realitzat correctament la injecció a la  nostra classe del servei de SFTP.</li>
	<li>Seguidament cridem al mètode login() per realitzar la connexió i  l'autentificació al servidor remot mitjançant el protocol SFTP.</li>
	<li>En cas de que la connexió al servidor remot s'hagi realitzat correctament es  crida al mètode listFiles() per obtenir una llista de fitxers en una carpeta  d'un servidor remot.</li>
</ol>


<p>Es crida el mètode listFiles() que amb els següents paràmetres:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>ordre</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Tipus</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> 1 </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Nom de la carpeta del servidor remot d'on es vol obtenir la llista de fitxers. </td>
</tr>
</tbody></table>
<p>El mètode retorna un array de FileObject, interfícies de la llibrería Commons VFS que ens donen una sèrie de mètodes per a treballar amb els fitxers remots.</p>

<h3><a name="ServeideSFTP2.3.x-Crearunfitxeralservidorremot"></a>Crear un fitxer al servidor remot</h3>

<p>Per crear un fitxer al servidor remot seguirem un patró com el mostrat en el següent  exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sftpService!= <span class="code-keyword">null</span> ) {
    sftpService.login();
    <span class="code-keyword">if</span> (sftpService.isLogged()) {
        createFile(fileName, remotePath);
        sftpService.logout();
    }
}</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Realitzarem doncs els següents passos:
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>En primer lloc comprovarem que s'ha realitzat correctament la injecció a la  nostra classe del servei de SFTP.</li>
	<li>Seguidament cridem al mètode login() per realitzar la connexió i  l'autentificació al servidor remot mitjançant el protocol SFTP.</li>
	<li>En cas de que la connexió al servidor remot s'hagi realitzat correctament es  crida al mètode createFile() per crear el fitxer en el servidor remot.</li>
</ol>


<p>Es crida el mètode createFile() que amb els següents paràmetres:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>ordre</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Tipus</b> </th>
<th class='confluenceTh'> &#42;<b>Descripció</b>&#42; </th>
</tr>
<tr>
<td class='confluenceTd'> 1 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Nom del fitxer a crear en el servidor remot. </td>
</tr>
<tr>
<td class='confluenceTd'> 2 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Directori remot on es vol crear el fitxer. </td>
</tr>
</tbody></table>
<p>El mètode retorna un boolean TRUE o FALSE segons s'ha realitzat correcta o incorrectament el procés.</p>

<h3><a name="ServeideSFTP2.3.x-Crearundirectorialservidorremot"></a>Crear un directori al servidor remot</h3>

<p>Per crear un directori al servidor remot seguirem un patró com el mostrat en el següent  exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sftpService!= <span class="code-keyword">null</span> ) {
    sftpService.login();
    <span class="code-keyword">if</span> (sftpService.isLogged()) {
        createFolder(folderName, remotePath);
        sftpService.logout();
    }
}</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Realitzarem doncs els següents passos:
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>En primer lloc comprovarem que s'ha realitzat correctament la injecció a la  nostra classe del servei de SFTP.</li>
	<li>Seguidament cridem al mètode login() per realitzar la connexió i  l'autentificació al servidor remot mitjançant el protocol SFTP.</li>
	<li>En cas de que la connexió al servidor remot s'hagi realitzat correctament es  crida al mètode createFolder() per crear el fitxer en el servidor remot.</li>
</ol>


<p>Es crida el mètode createFolder() que amb els següents paràmetres:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>ordre</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Tipus</b> </th>
<th class='confluenceTh'> &#42;<b>Descripció</b>&#42; </th>
</tr>
<tr>
<td class='confluenceTd'> 1 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Nom del directori a crear en el servidor remot. </td>
</tr>
<tr>
<td class='confluenceTd'> 2 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Directori remot on es vol crear el directori. </td>
</tr>
</tbody></table>
<p>El mètode retorna un boolean TRUE o FALSE segons s'ha realitzat correcta o incorrectament el procés.</p>

<h3><a name="ServeideSFTP2.3.x-Esborrarunfitxeralservidorremot"></a>Esborrar un fitxer al servidor remot</h3>

<p>Per esborrar un fitxer al servidor remot seguirem un patró com el mostrat en el següent  exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sftpService!= <span class="code-keyword">null</span> ) {
    sftpService.login();
    <span class="code-keyword">if</span> (sftpService.isLogged()) {
        deleteFile(fileName, remotePath);
        sftpService.logout();
    }
}</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Realitzarem doncs els següents passos:
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>En primer lloc comprovarem que s'ha realitzat correctament la injecció a la  nostra classe del servei de SFTP.</li>
	<li>Seguidament cridem al mètode login() per realitzar la connexió i  l'autentificació al servidor remot mitjançant el protocol SFTP.</li>
	<li>En cas de que la connexió al servidor remot s'hagi realitzat correctament es  crida al mètode deleteFile() per crear el fitxer en el servidor remot.</li>
</ol>


<p>Es crida el mètode deleteFile() que amb els següents paràmetres:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>ordre</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Tipus</b> </th>
<th class='confluenceTh'> &#42;<b>Descripció</b>&#42; </th>
</tr>
<tr>
<td class='confluenceTd'> 1 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Nom del fitxer a esborrar en el servidor remot. </td>
</tr>
<tr>
<td class='confluenceTd'> 2 </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> String </td>
<td class='confluenceTd'> Directori remot on es troba el fitxer. </td>
</tr>
</tbody></table>
<p>El mètode retorna un boolean TRUE o FALSE segons s'ha realitzat correcta o incorrectament el procés.</p>

<h1><a name="ServeideSFTP2.3.x-Exemples"></a>Exemples</h1>


<h2><a name="ServeideSFTP2.3.x-TestsUnitaris"></a>Tests Unitaris</h2>

<p>Un exemple d'utilització del servei de SFTP són els tests unitaris, a on  s'obté el bean del servei a partir del fitxer de definició  (applicationContext.xml).</p>

<p>S'ha de tenir en compte que s'ha de disposar d'accés a un servidor remot mitjançant el protocol SFTP per poder realitzar els tests.</p>

<p>package net.gencat.ctti.canigo.services.sftp.test;</p>

<p>...</p>

<p>La utilització del servei es independent de la configuració del mateix. Així,  un possible fitxer de configuració del servei seria:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;?xml version=<span class="code-quote">"1.0"</span> encoding=<span class="code-quote">"UTF-8"</span>?&gt;
&lt;!DOCTYPE beans PUBLIC <span class="code-quote">"-<span class="code-comment">//SPRING//DTD BEAN//EN"</span> <span class="code-quote">"http://www.springframework.org/dtd/spring-beans.dtd"</span>&gt;
</span>&lt;beans&gt;
    &lt;bean id=<span class="code-quote">"sftpService"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.sftp.impl.SftpServiceImpl"</span> init-method=<span class="code-quote">"init"</span>&gt;
        &lt;property name=<span class="code-quote">"logService"</span>&gt;
            &lt;ref bean=<span class="code-quote">"loggingService"</span> /&gt;
        &lt;/property&gt;
        &lt;property name=<span class="code-quote">"ftpUsername"</span> value=<span class="code-quote">"user"</span>/&gt;
        &lt;property name=<span class="code-quote">"ftpPassword"</span> value=<span class="code-quote">"pass"</span>/&gt;
        &lt;property name=<span class="code-quote">"ftpUrl"</span> value=<span class="code-quote">"192.168.131.75"</span>/&gt;
        &lt;property name=<span class="code-quote">"ftpPort"</span> value=<span class="code-quote">"22"</span>/&gt;
        &lt;property name=<span class="code-quote">"knownHosts"</span> value=<span class="code-quote">"C:/ssh/known_hosts"</span>/&gt;
        &lt;property name=<span class="code-quote">"strictHostKeyChecking"</span> value=<span class="code-quote">"yes"</span>/&gt;
    &lt;/bean&gt;

    &lt;!-- LOGGING service  --&gt;
    &lt;bean id=<span class="code-quote">"loggingService"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.logging.log4j.Log4JServiceImpl"</span>&gt;
        &lt;property name=<span class="code-quote">"configurator"</span>&gt;
            &lt;ref local=<span class="code-quote">"loggingConfigurator"</span>/&gt;
        &lt;/property&gt;
    &lt;/bean&gt;

    &lt;!-- configurator bean --&gt;
    &lt;bean id=<span class="code-quote">"loggingConfigurator"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.logging.log4j.xml.HostDOMConfigurator"</span> init-method=<span class="code-quote">"init"</span>&gt;
        &lt;property name=<span class="code-quote">"configFileName"</span>&gt;
            &lt;value&gt;classpath:log4j-test.xml&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">...

    <span class="code-keyword">public</span> void testLogin() <span class="code-keyword">throws</span> Exception {
        <span class="code-keyword">try</span> {
            SftpService sftpService = getSftpService();

            assertTrue(sftpService.login());

            <span class="code-keyword">if</span> (sftpService.isLogged()) {
                sftpService.logout();
            }
        } <span class="code-keyword">catch</span> (SftpServiceException e) {
            log.error(e.getCause());
        }
    }


    <span class="code-keyword">public</span> void testLoginFailed() <span class="code-keyword">throws</span> Exception {
        <span class="code-keyword">try</span> {
            SftpService sftpService = getSftpService();

            assertFalse(sftpService.login(<span class="code-quote">"username"</span>, <span class="code-quote">"incorrectPassword"</span>));

            <span class="code-keyword">if</span> (sftpService.isLogged()) {
                sftpService.logout();
            }
        } <span class="code-keyword">catch</span> (SftpServiceException e) {
            log.error(e.getCause());
        }
    }

    <span class="code-keyword">public</span> void testUploadFile() <span class="code-keyword">throws</span> Exception {
        <span class="code-object">String</span> file = <span class="code-quote">"file_"</span>+<span class="code-object">System</span>.currentTimeMillis()+<span class="code-quote">".txt"</span>;
        <span class="code-keyword">try</span> {
            SftpService sftpService = getSftpService();
            sftpService.login();

            sftpService.uploadFile(file, localPath, remotePath);
            assertTrue(sftpService.existsFile(remotePath, file));
            <span class="code-keyword">if</span>(sftpService.isLogged()) {
                sftpService.logout();
            }
        } <span class="code-keyword">catch</span> (SftpServiceException e) {
            log.error(e.getCause());
        }
    }


    <span class="code-keyword">public</span> void testDownloadFile() <span class="code-keyword">throws</span> Exception {
        <span class="code-keyword">try</span> {
            SftpService sftpService = getSftpService();
            sftpService.login();

            <span class="code-keyword">if</span>(!sftpService.existsFile(remotePath, fileName)) {
                sftpService.uploadFile(fileName, localPath, remotePath);
            }
            sftpService.downloadFile(fileName, localPath, remotePath);
            <span class="code-keyword">if</span>(sftpService.isLogged()) {
                sftpService.logout();
            }

            File file = <span class="code-keyword">new</span> File(localPath+<span class="code-quote">"/"</span>+fileName);
            assertTrue(file.exists());
        } <span class="code-keyword">catch</span> (SftpServiceException e) {
            log.error(e.getCause());
        }
    }


    <span class="code-keyword">public</span> void testCreateFolder() <span class="code-keyword">throws</span> Exception {
        <span class="code-object">String</span> folder = <span class="code-quote">"folder_"</span>+<span class="code-object">System</span>.currentTimeMillis();
        <span class="code-keyword">try</span> {
            SftpService sftpService = getSftpService();
            sftpService.login();

            sftpService.createFolder(remotePath,folder);
            assertTrue(sftpService.existsFolder(remotePath,folder));
            <span class="code-keyword">if</span>(sftpService.isLogged()) {
                sftpService.logout();
            }
        } <span class="code-keyword">catch</span> (SftpServiceException e) {
            log.error(e.getCause());
        }
    }


    <span class="code-keyword">public</span> void testDeleteFile() <span class="code-keyword">throws</span> Exception {
        <span class="code-object">String</span> file = <span class="code-quote">"file_"</span>+<span class="code-object">System</span>.currentTimeMillis()+<span class="code-quote">".txt"</span>;
        <span class="code-keyword">try</span> {
            SftpService sftpService = getSftpService();
            sftpService.login();

            sftpService.createFile(remotePath,file);
            assertTrue(sftpService.deleteFile(remotePath,file));
            <span class="code-keyword">if</span>(sftpService.isLogged()) {
                sftpService.logout();
            }
        } <span class="code-keyword">catch</span> (SftpServiceException e) {
            log.error(e.getCause());
        }
    }

    <span class="code-keyword">public</span> void testListFiles() <span class="code-keyword">throws</span> Exception {
        <span class="code-keyword">try</span> {
            SftpService sftpService = getSftpService();
            sftpService.login();

            assertNotNull(sftpService.listFiles(remotePath));
            <span class="code-keyword">if</span>(sftpService.isLogged()) {
                sftpService.logout();
            }
        } <span class="code-keyword">catch</span> (SftpServiceException e) {
            log.error(e.getCause());
        }
    }


    <span class="code-keyword">private</span> SftpService getSftpService() {
        BeanFactory beanFactory = <span class="code-keyword">new</span> ClassPathXmlApplicationContext(<span class="code-quote">"applicationContext.xml"</span>);
        SftpService sftpService = (SftpService)beanFactory.getBean(<span class="code-quote">"sftpService"</span>);
        logService = sftpService.getLogService();
        log = logService.getLog(SftpServiceTest.class);
        assertNotNull(sftpService);

        <span class="code-keyword">return</span> sftpService;
    }
...</pre>
</div></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Servei de SFTP 2.3.x_attachments/image002.jpg">image002.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Servei de SFTP 2.3.x_attachments/image003.jpg">image003.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Servei de SFTP 2.3.x_attachments/image004.jpg">image004.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Servei de SFTP 2.3.x_attachments/image001.jpg">image001.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="border/border_bottom.gif"><img src="border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Apr 14, 2015 09:28</font></td>
		    </tr>
	    </table>
    </body>
</html>