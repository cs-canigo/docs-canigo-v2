<html>
    <head>
        <title>Canigó - Connector SGDE</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Canigó - Connector SGDE
                                                    </span>
				    </div>
			
				    <h1><a name="ConnectorSGDE-CONNECTORSGDE"></a>CONNECTOR SGDE</h1>

<p><br clear="all" />
<br clear="all" />
<div>
<ul><a href='#ConnectorSGDE-CONNECTORSGDE'>
    <li>CONNECTOR SGDE</li></a><a href='#ConnectorSGDE-Introducci%C3%B3'>
    <li>Introducció</li></a>
<ul><a href='#ConnectorSGDE-Prop%C3%B2sit'>
    <li>Propòsit</li></a><a href='#ConnectorSGDE-ContextiEscenarisd%27%C3%BAs'>
    <li>Context i Escenaris d'ús</li></a><a href='#ConnectorSGDE-VersionsiDepend%C3%A8ncies'>
    <li>Versions i Dependències</li></a><a href='#ConnectorSGDE-Aquivadirigit'>
    <li>A qui va dirigit</li></a>
</ul><a href='#ConnectorSGDE-Descripci%C3%B3Detallada'>
    <li>Descripció Detallada</li></a>
<ul><a href='#ConnectorSGDE-AltaServei'>
    <li>Alta Servei</li></a><a href='#ConnectorSGDE-ArquitecturaiComponents'>
    <li>Arquitectura i Components</li></a>
<ul><a href='#ConnectorSGDE-Interf%C3%ADciesiComponentsGen%C3%A8rics'>
    <li>Interfícies i Components Genèrics</li></a><a href='#ConnectorSGDE-Requeriments'>
    <li>Requeriments</li></a>
</ul><a href='#ConnectorSGDE-Instal.laci%C3%B3iConfiguraci%C3%B3'>
    <li>Instal.lació i Configuració</li></a>
<ul><a href='#ConnectorSGDE-Instal.laci%C3%B3'>
    <li>Instal.lació</li></a><a href='#ConnectorSGDE-Configuraci%C3%B3'>
    <li>Configuració</li></a>
</ul><a href='#ConnectorSGDE-Utilitzaci%C3%B3delConnector'>
    <li>Utilització del Connector</li></a>
</ul>
</ul></div><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<h1><a name="ConnectorSGDE-Introducci%C3%B3"></a>Introducció</h1>

<p>L'SGDE o Servei de Gestió del Document Electrònic ofereix una sèrie de serveis relacionats amb la gestió de documents electrònics. Aquests serveis els ofereixen les plataformes que integren l'SGDE. Actualment existeixen dues:</p>
<ul class="alternate" type="square">
	<li>Plataforma Adobe</li>
	<li>STD</li>
</ul>


<p>Podeu trobar mes informació sobre els serveis i funcionalitats del SGDE <a href="http://canigo.ctti.gencat.net/confluence/display/CANPUB/Sobre+l%27SGDE" title="Visit page outside Confluence">aquí</a>.</p>

<h2><a name="ConnectorSGDE-Prop%C3%B2sit"></a>Propòsit</h2>

<p>El propòsit del connector és proporcionar una API que pugui ser utilitzada de forma fàcil pels integradors d'aquest connector per consumir els diferents serveis del SGDE.</p>

<h2><a name="ConnectorSGDE-ContextiEscenarisd%27%C3%BAs"></a>Context i Escenaris d'ús</h2>

<p>El connector SGDE es troba dins els connectors funcionals de la Generalitat.</p>

<h2><a name="ConnectorSGDE-VersionsiDepend%C3%A8ncies"></a>Versions i Dependències</h2>

<p><font color="black">En el present apartat es mostren quines són les versions i dependències necessàries per fer ús del Connector.</font></p>

<p><font color="black">Les dependències descrites a la següent url són requerides per tal de fer funcionar el servei:</font><br/>
<a href="http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_3_19/canigo-connectors-root/canigo-connectors-sgde/dependencies.html" title="Visit page outside Confluence">Dependències del Connector SGDE</a></p>

<h2><a name="ConnectorSGDE-Aquivadirigit"></a>A qui va dirigit</h2>

<p><font color="black">Aquest document va dirigit als següents perfils:</font></p>
<ol>
	<li><font color="black">Programador. Per conèixer l'ús del connector.</font></li>
	<li><font color="black">Arquitecte. Per conèixer quins són els components i la configuració del connector.</font></li>
</ol>


<h1><a name="ConnectorSGDE-Descripci%C3%B3Detallada"></a>Descripció Detallada</h1>

<p>Aquest connector ofereix els següents serveis:</p>

<p>	<b>Serveis Plataforma Adobe</b></p>

<ul class="alternate" type="square">
	<li><b>renderitzarFormulari:</b> Servei per extreure dades d'un formulari.</li>
	<li><b>extreureDadesFormulari:</b> Servei per extreure dades d'un formulari.</li>
	<li><b>convertirPdfaImatge:</b> Servei per convertir un formulari a imatge.</li>
	<li><b>convertirPdfaPdfA:</b> Servei per convertir un formulari a imatge.</li>
	<li><b>aplanarPDF:</b> Servei per aplanar un pdf.</li>
	<li><b>signarPDF:</b> Servei per a signar un pdf pla.</li>
</ul>


<p>	<b>Serveis STD</b></p>

<ul class="alternate" type="square">
	<li><b>generarCSV:</b> Servei per la generació d'un Codi Segur a partir d'un arxiu i una clau.</li>
	<li><b>composarPDFStream:</b> Servei que composa un PDF a partir d'una plantilla i d'un document PDF enviat en Stream en la mateixa petició.</li>
	<li><b>composarPDFRemot:</b> Servei que composa un PDF a partir d'una plantilla i d'un document PDF previament pujat al filesystem del STD.</li>
	<li><b>convertirPDF:</b> Servei que converteix un document Ofimàtic (Word, Excel, PowerPoint, Imatges, OpenOffice,...) en PDF.</li>
	<li><b>convertirComposarPDF:</b> Servei que converteix i posteriorment composa un arxiu ofimàtic.</li>
</ul>


<h2><a name="ConnectorSGDE-AltaServei"></a>Alta Servei</h2>

<p>Per poder utilitzar l'SGDE s'ha d'estar donat d'alta en el servei. Per poder fer-ho s'han de seguir els següents passos:</p>

<p>1.- Enviar un mail a oficina-tecnica.canigo.ctti@gencat.cat sol?licitant l'alta a qualsevol de les plataformes que integren el SGDE; Plataforma Adobe o STD.</p>
<ul class="alternate" type="square">
	<li>Plataforma Adobe: El mail a de contenir la sol?licitud d'alta a l'aplicació d'AutoServei disponible <a href="http://canigo.ctti.gencat.cat/confluence/download/attachments/4/Formulari+d%27altes.xls?version=1" title="Visit page outside Confluence">aqui</a>.</li>
	<li>STD: El mail ha de redactar-se tal qual es descriu en el <a href="http://canigo.ctti.gencat.net/confluence/download/attachments/6466/CSCanigo.MU.P00.E01_manual_usuari_STD.doc?version=5" title="Visit page outside Confluence">manual d'usuari</a> del servei. Aquest mail ha de contenir una plantilla degudament complimentada que es pot trobar <a href="http://canigo.ctti.gencat.net/confluence/pages/viewpage.action?pageId=6466" title="Visit page outside Confluence">aquí</a>.<br/>
2.- El Centre de Frameworks i Solucions d'Arquitectura respondrà a aquest mail una vegada doni d'alta l'aplicació amb un mail tipus, <br/>
3.- L'alta a qualsevol de les dues plataformes s'han de realitzar primer sobre l'entorn de PRE i posteriorment a l'entorn de PRO.</li>
</ul>


<h2><a name="ConnectorSGDE-ArquitecturaiComponents"></a>Arquitectura i Components</h2>

<h3><a name="ConnectorSGDE-Interf%C3%ADciesiComponentsGen%C3%A8rics"></a>Interfícies i Components Genèrics</h3>

<p><font color="black">Es pot trobar tota la documentació JavaDoc i el codi font referent aquests components a les següents url's:</font></p>

<p><font color="red"><ins>JavaDoc:</ins></font><font color="red">&nbsp;</font><a href="http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_3_19/canigo-connectors-root/canigo-connectors-sgde/apidocs/index.html" title="Visit page outside Confluence">http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_3_19/canigo-connectors-root/canigo-connectors-sgde/apidocs/index.html</a><br/>
<font color="red"><ins>Codi Font:</ins></font><font color="red">&nbsp;</font><font color="red">&nbsp;</font>[ <a href="http://canigo.ctti.gencat.net/repository/maven2/canigo/connectors/canigo-connectors-sgde/1.0.0/" title="Visit page outside Confluence">http://canigo.ctti.gencat.net/repository/maven2/canigo/connectors/canigo-connectors-sgde/1.0.0/</a>]</p>

<h3><a name="ConnectorSGDE-Requeriments"></a>Requeriments</h3>

<p><font color="black">El connector</font> SGDE és compatible amb les versions 1.5 o superior de Java. Per versions inferiors no es garantit el seu correcte funcionament.</p>

<p>El seu ús esta certificat per funcionar correctament en servidors d'aplicacions WL9.2 i Tomcat5.x.</p>

<h2><a name="ConnectorSGDE-Instal.laci%C3%B3iConfiguraci%C3%B3"></a>Instal.lació i Configuració</h2>


<h3><a name="ConnectorSGDE-Instal.laci%C3%B3"></a>Instal.lació</h3>

<p><font color="black">La instal.lació del connector requereix de la utilització de la llibreria 'canigo-connectors-sgde' i les dependències indicades a l'apartat '</font>Introducció-Versions i Dependències<font color="black">'.</font></p>

<p>La instal?lació passa per <font color="black"> modificar el pom.xml de l'aplicació per incloure les llibreries del Connector com a dependència.</font><br clear="all" /></p>
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;dependency&gt;
    &lt;groupId&gt;canigo.connectors&lt;/groupId&gt;
    &lt;artifactId&gt;canigo-connectors-sgde&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;canigo.connectors&lt;/groupId&gt;
	&lt;artifactId&gt;canigo-connectors-sgde-support&lt;/artifactId&gt;
	&lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div></div>

<table cellpadding='5' width='85%' cellspacing='8px' class='noteMacro' border="0" align='center'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="./icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b class="strong">IMPORTANT</b><br />
<p>En el cas de que es vulgui integrar aquest connector en una aplicació que disposi del connector de la PICA, és farà necessari afegir les següents exclusions en aquests últim, per exemple el connector AVISALERT.</p>
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;dependency&gt;
	&lt;groupId&gt;canigo.connectors&lt;/groupId&gt;
	&lt;artifactId&gt;canigo-connectors-pica&lt;/artifactId&gt;
	&lt;version&gt;1.0&lt;/version&gt;
	&lt;exclusions&gt;
		&lt;exclusion&gt;
			&lt;groupId&gt;xmlbeans&lt;/groupId&gt;
            &lt;artifactId&gt;xbean&lt;/artifactId&gt;
		&lt;/exclusion&gt;
        &lt;exclusion&gt;
        	&lt;groupId&gt;org.apache.axis2&lt;/groupId&gt;
        	&lt;artifactId&gt;axis2-jaxws&lt;/artifactId&gt;
        &lt;/exclusion&gt;
		&lt;exclusion&gt;
			&lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;
			&lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;
		&lt;/exclusion&gt;
        &lt;exclusion&gt;
        	&lt;groupId&gt;org.apache.woden&lt;/groupId&gt;
			&lt;artifactId&gt;woden&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
        	&lt;groupId&gt;org.apache.ws.commons.schema&lt;/groupId&gt;
        	&lt;artifactId&gt;XmlSchema&lt;/artifactId&gt;
        &lt;/exclusion&gt;
	&lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;canigo.connectors&lt;/groupId&gt;
    &lt;artifactId&gt;canigo-connectors-pica-avisosalertes&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;exclusions&gt;
      	&lt;exclusion&gt;
      		&lt;groupId&gt;org.apache.axis2&lt;/groupId&gt;
      		&lt;artifactId&gt;axis2-jaxws&lt;/artifactId&gt;
      	&lt;/exclusion&gt;
      	&lt;exclusion&gt;
      		&lt;groupId&gt;org.apache.woden&lt;/groupId&gt;
      		&lt;artifactId&gt;woden&lt;/artifactId&gt;
      	&lt;/exclusion&gt;
      	&lt;exclusion&gt;
			&lt;groupId&gt;org.apache.ws.commons.schema&lt;/groupId&gt;
			&lt;artifactId&gt;XmlSchema&lt;/artifactId&gt;
		&lt;/exclusion&gt;
	&lt;/exclusions&gt;
&lt;/dependency&gt;</pre>
</div></div></td></tr></table>

<h3><a name="ConnectorSGDE-Configuraci%C3%B3"></a>Configuració</h3>
<p><br clear="all" />
1.- Per poder configurar el connector SGDE és necessari tindre definit el bean d'Spring següent en l'aplicació:</p>

<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"sgdeConnector"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.connectors.canigo_connectors_sgde.impl.SGDEServiceImpl"</span> init-method=<span class="code-quote">"setupService"</span>&gt;
	&lt;property name=<span class="code-quote">"loggingService"</span> ref=<span class="code-quote">"loggingService"</span>&gt;&lt;/property&gt;
	&lt;property name=<span class="code-quote">"formsWSDLUrl"</span> value=<span class="code-quote">"http:<span class="code-comment">//eformularis.pre.intranet.gencat.cat/ServeisInvocacio/serveis/ServeisInvocacioV1?wsdl"</span> /&gt;
</span>	&lt;property name=<span class="code-quote">"stdWSDLUrl"</span> value=<span class="code-quote">"http:<span class="code-comment">//sgde.pre.intranet.gencat.cat/ServeisInvocacioSTD/services/ServeisSTD?wsdl"</span> /&gt;
</span>&lt;/bean&gt;</pre>
</div></div>

<p>NOTA: Les url's de l'exemple corresponen a l'entorn de PRE-producció.</p>

<h2><a name="ConnectorSGDE-Utilitzaci%C3%B3delConnector"></a>Utilització del Connector</h2>

<p><br clear="all" />
1.- Referenciar al servei SGDE des de l'acció que es vulgui utilitzar (action-servlet-aaa.xml):</p>

<div class="code"><div class="codeContent">
<pre class="code-java">&lt;property name=<span class="code-quote">"sgdeService"</span> ref=<span class="code-quote">"sgdeConnector"</span>&gt;&lt;/property&gt;</pre>
</div></div>

<p>2.- En l'acció, s'hauran de crear els getters i setters corresponents per al connector de SGDE:</p>

<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">private</span> ISGDEService sgdeService;
<span class="code-keyword">public</span> ISGDEService getSgdeService() {
	<span class="code-keyword">return</span> sgdeService;
}

<span class="code-keyword">public</span> void setSgdeService(ISGDEService sgdeService) {
	<span class="code-keyword">this</span>.sgdeService = sgdeService;
}</pre>
</div></div>

<p>3.- Finalment fer la crida al servei en l'Action corresponent:</p>

<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-object">byte</span>[] STD_ARXIU_PDF_TEST1 = IOUtils.toByteArray(<span class="code-object">Thread</span>.currentThread().getContextClassLoader().getResourceAsStream(<span class="code-quote">"data_sgde/prueba_composar.pdf"</span>));
ResultSTD result = sgdeService.generarCSV(<span class="code-quote">"ctti"</span>, <span class="code-quote">"cscanigo"</span>, STD_ARXIU_PDF_TEST1, <span class="code-quote">"cscanigo"</span>);</pre>
</div></div>

<p>Per més informació sobre els diferents serveis que ofereix el SGDE consultar la documentació disponible <a href="http://canigo.ctti.gencat.cat/confluence/pages/viewpage.action?pageId=6463" title="Visit page outside Confluence">aquí</a>.</p>

				    
                    			    </td>
		    </tr>
	    </table>
	  
    </body>
</html>