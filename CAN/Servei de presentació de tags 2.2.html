<html>
    <head>
        <title>Canigó - Servei de presentació de tags 2.2</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Canigó - Servei de presentació de tags 2.2
                                                    </span>
				    </div>
			
				    <h1><a name="Serveidepresentaci%C3%B3detags2.2-SERVEIDEPRESENTACI%C3%93DETAGS"></a>SERVEI DE PRESENTACIÓ DE TAGS</h1>

<p><br clear="all" />
<div>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-SERVEIDEPRESENTACI%C3%93DETAGS'>
    <li>SERVEI DE PRESENTACIÓ DE TAGS</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Introducci%C3%B3'>
    <li>Introducció</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-Prop%C3%B2sit'>
    <li>Propòsit</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-ContextiEscenarisd%27%C3%9As'>
    <li>Context  i Escenaris d'Ús</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-VersionsiDepend%C3%A8ncies'>
    <li>Versions  i Dependències</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-Versions'>
    <li>Versions</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Depend%C3%A8nciesb%C3%A0siques'>
    <li>Dependències  bàsiques</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-Aquivadirigit'>
    <li>A qui  va dirigit</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-DocumentsiFontsderefer%C3%A8ncia'>
    <li>Documents  i Fonts de referència</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Glossari'>
    <li>Glossari</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-Descripci%C3%B3Detallada'>
    <li>Descripció  Detallada</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-ArquitecturaiComponents'>
    <li>Arquitectura  i Components</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-ArquitecturadeProcedimentd%27Inicialitzaci%C3%B3Intern'>
    <li>Arquitectura  de Procediment d'Inicialització Intern</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Interf%C3%ADciesiComponentsGen%C3%A8rics'>
    <li>Interfícies  i Components Genèrics</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-Instal.laci%C3%B3iConfiguraci%C3%B3'>
    <li>Instal.lació  i Configuració</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-Instal.laci%C3%B3'>
    <li>Instal.lació</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Configuraci%C3%B3General'>
    <li>Configuració  General</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Configuraci%C3%B3delTag%27ConfigurationTag%27'>
    <li>Configuració  del Tag 'ConfigurationTag'</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Configuraci%C3%B3delstagsdeFormulari'>
    <li>Configuració  dels tags de Formulari</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Configuraci%C3%B3delstagsdeLlistats'>
    <li>Configuració  dels tags de Llistats</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-Configuraci%C3%B3delstagsenelJSP'>
    <li>Configuració  dels tags en el JSP</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Tagsavan%C3%A7ats'>
    <li>Tags avançats</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-DirtyFormWarning'>
    <li>Dirty Form  Warning</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-SearchPanel'>
    <li>Search  Panel</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Autocomplete'>
    <li>Autocomplete</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Botonsambimatges'>
    <li>Botons amb  imatges</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-TagSwapSelect'>
    <li>Tag  Swap Select</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Pestanyes'>
    <li>Pestanyes</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-TabPanelTag'>
    <li>TabPanelTag</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-TabPageTag'>
    <li>TabPageTag</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-GridBagLayout'>
    <li>GridBagLayout</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Paginaci%C3%B3deselects'>
    <li>Paginació de  selects</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Formatilimitaci%C3%B3d%27entradadedades'>
    <li>Format  i limitació d'entrada de dades</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-Llistatseditables'>
    <li>Llistats editables</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-Introducci%C3%B3'>
    <li>Introducció</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-SetListTag'>
    <li>SetListTag</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-DefinePropertyTag'>
    <li>DefinePropertyTag</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-SelectionTag'>
    <li>SelectionTag</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-DeleteRowsTag'>
    <li>DeleteRowsTag</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-AddRowTag'>
    <li>AddRowTag</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-Serveidevalidacionseneljsp'>
    <li>Servei de  validacions en el jsp</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-Motorderegles'>
    <li>Motor  de regles</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-Definici%C3%B3deregles'>
    <li>Definició de  regles</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Eventsdevalidaci%C3%B3'>
    <li>Events de  validació</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-Presentaci%C3%B3demissatges'>
    <li>Presentació  de missatges</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-FormiFormValidator'>
    <li>Form i  FormValidator</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-TextiFieldValidator'>
    <li>Text i  FieldValidator</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-IconErroriTextError'>
    <li>IconError i  TextError</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-Validacionsenllistatseditables'>
    <li>Validacions  en llistats editables</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-Utilitzaci%C3%B3delServei'>
    <li>Utilització  del Servei</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-%C3%9Asdelstagsalesp%C3%A0ginesJSP'>
    <li>Ús  dels tags a les pàgines JSP</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-ComentarisEspec%C3%ADficsaalgunsTags'>
    <li>Comentaris  Específics a alguns Tags</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Especificaci%C3%B3delModedelFormulari'>
    <li>Especificació  del Mode del Formulari</li></a>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-EinesdeSuport'>
    <li>Eines  de Suport</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-DebugdelesP%C3%A0gines'>
    <li>Debug de les  Pàgines</li></a>
</ul>
</ul><a href='#Serveidepresentaci%C3%B3detags2.2-Annexos'>
    <li>Annexos</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-JSTL'>
    <li>JSTL</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-AltresTags'>
    <li>Altres  Tags</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Aspectesd%27Usabilitat'>
    <li>Aspectes  d'Usabilitat</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-CSS%28CascadeStyleSheets%29'>
    <li>CSS  (Cascade Style Sheets)</li></a>
<ul><a href='#Serveidepresentaci%C3%B3detags2.2-Importaci%C3%B3defitxersd%27estils'>
    <li>Importació  de fitxers d'estils</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-Utilitzaci%C3%B3deidsiclasses'>
    <li>Utilització de ids i classes</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-EfectesComuns'>
    <li>Efectes Comuns</li></a><a href='#Serveidepresentaci%C3%B3detags2.2-PseudoClasses'>
    <li>Pseudo  Classes</li></a>
</ul>
</ul>
</ul></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h1><a name="Serveidepresentaci%C3%B3detags2.2-Introducci%C3%B3"></a>Introducció</h1>


<h2><a name="Serveidepresentaci%C3%B3detags2.2-Prop%C3%B2sit"></a>Propòsit</h2>

<p>El Servei de Tags té com a propòsit principal oferir un ventall de components  a utilitzar dins de les nostres pàgines. En l'actualitat es basen en l'ús de  pàgines JSP (Java Server Pages), per ser ara mateix la tecnologia de presentació  més estesa.</p>

<p>canigo, en el seu afany de proporcionar la màxima flexibilitat i facilitat  als desenvolupadors ha seleccionat, estès i millorat algunes propostes de la  comunitat. En molts dels components es fan servir tecnologies Web d'última  generació i s'estenen solucions openSource ja existents. Tanmateix s'ha definit  una política de configuració que facilita l'herència de valors de les propietats  entre components, aspecte no assolible amb la tecnologia de tags JSP.</p>

<p>En l'actualitat existeix una nova generació de desenvolupament Web anomenada  AJAX <sup>1</sup>(<b>Asynchronous JavaScript And XML)</b>. Tot i que el  desenvolupador no necessita del coneixement d'aquest tecnologia, canigo s'ha  adaptat a aquesta nova generació en la implementació interna dels seus tags.</p>

<p>Es considera prerequisit per a la lectura d'aquest document el coneixement en  HTML, CSS i l'ús de Struts.</p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-ContextiEscenarisd%27%C3%9As"></a>Context  i Escenaris d'Ús</h2>

<p>El Servei de Tags es troba dins dels serveis de Presentació de  canigo.</p>

<p>Per a la utilització dels tags de canigo es requereix d'un entorn basat en  les següents tecnologies:</p>
<ol>
	<li>JSP</li>
	<li>JSTL</li>
	<li>Struts</li>
</ol>


<h2><a name="Serveidepresentaci%C3%B3detags2.2-VersionsiDepend%C3%A8ncies"></a>Versions  i Dependències</h2>

<p>En el present apartat es mostren quines són les versions i dependències  necessàries per fer ús del Servei.</p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Versions"></a>Versions</h3>

<p>Novetats en versió 1.1.</p>
<ul>
	<li>Configuració dels tags en el JSP ( Aparatat 2.3)</li>
	<li>Tags Avançats ( Apartat 2.4)</li>
	<li>Llistats editables (Apartat 2.5)</li>
	<li>Validacions en el jsp. ( Apartat 2.6)</li>
</ul>


<h3><a name="Serveidepresentaci%C3%B3detags2.2-Depend%C3%A8nciesb%C3%A0siques"></a>Dependències  bàsiques</h3>

<p>Les dependències descrites a la següent url son requerides per tal de fer funcionar el servei:<br/>
<a href="http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_0/canigo-services-web/dependencies.html" title="Visit page outside Confluence">Dependències Servei de presentació de tags</a></p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-Aquivadirigit"></a>A qui  va dirigit</h2>

<p>Aquest document va dirigit als següents perfils:</p>
<ol>
	<li>Programador. Per configurar els tags i editar les pàgines</li>
	<li>Dissenyador. Per definir els estils i la composició de les pàgines</li>
</ol>


<h2><a name="Serveidepresentaci%C3%B3detags2.2-DocumentsiFontsderefer%C3%A8ncia"></a>Documents  i Fonts de referència</h2>

<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>&nbsp;</th>
<th class='confluenceTh'> Ubicació dels labels </th>
<th class='confluenceTh'> <a href="http://illuminosity.net/thoughts/archives/styling/" title="Visit page outside Confluence">http://illuminosity.net/thoughts/archives/styling/</a> </th>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Llibreria per accessKey </td>
<td class='confluenceTd'> <a href="http://www.gerv.net/software/aul/" title="Visit page outside Confluence">http://www.gerv.net/software/aul/</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Llibreria Struts Layout </td>
<td class='confluenceTd'> http://struts.application\-servers.com/ </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Formularis accessibles </td>
<td class='confluenceTd'> http://www.websemantics.co.uk/tutorials/accessible\_forms/#texttop </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Advanced CSS </td>
<td class='confluenceTd'> <a href="http://www.yourhtmlsource.com/stylesheets/advancedcss.html" title="Visit page outside Confluence">http://www.yourhtmlsource.com/stylesheets/advancedcss.html</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Overlib </td>
<td class='confluenceTd'> <a href="http://www.bosrup.com/web/overlib/" title="Visit page outside Confluence">http://www.bosrup.com/web/overlib/</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Dom tooltip </td>
<td class='confluenceTd'> <a href="http://www.mojavelinux.com/projects/domtooltip/HOWTO.html" title="Visit page outside Confluence">http://www.mojavelinux.com/projects/domtooltip/HOWTO.html</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Dynarch Calendar </td>
<td class='confluenceTd'> <a href="http://www.dynarch.com/projects/calendar/" title="Visit page outside Confluence">http://www.dynarch.com/projects/calendar/</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> DHTML Internet Explorer </td>
<td class='confluenceTd'> <a href="http://msdn.microsoft.com/workshop/author/dhtml/reference/objects.asp" title="Visit page outside Confluence">http://msdn.microsoft.com/workshop/author/dhtml/reference/objects.asp</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Prototype library </td>
<td class='confluenceTd'> <a href="http://prototype.conio.net/" title="Visit page outside Confluence">http://prototype.conio.net/</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Value List </td>
<td class='confluenceTd'> <a href="http://valuelist.sourceforge.net/" title="Visit page outside Confluence">http://valuelist.sourceforge.net/</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Struts Layout </td>
<td class='confluenceTd'> <a href="http://struts.application-servers.com/doc/tags/layout.html" title="Visit page outside Confluence">http://struts.application-servers.com/doc/tags/layout.html</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Ditchnet JSP Tags </td>
<td class='confluenceTd'> <a href="http://209.61.157.8:8080/taglibs/" title="Visit page outside Confluence">http://209.61.157.8:8080/taglibs/</a> </td>
</tr>
</tbody></table>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-Glossari"></a>Glossari</h2>

<p><b>TLD (Tag Library Descriptor)</b></p>

<p>Un TLD és un fitxer en format XML que permet a un desenvolupador definir un  conjunt de tags. Per cada tag es poden descriure els seus atributs i la classe  associada que generarà el contingut de sortida a la pàgina en la que es faci  servir.</p>

<p>Tot i que l'ús de tags específics permet eliminar l'ús de codi Java des de  les nostres pàgines JSP, no eliminen la necessitat de crear codi Java. S'han de  crear igualment classes Java que facin el treball del tag. Aquestes classes han  de estendre les classes definides al package 'tagext' de J2EE.</p>

<h1><a name="Serveidepresentaci%C3%B3detags2.2-Descripci%C3%B3Detallada"></a>Descripció  Detallada</h1>


<h2><a name="Serveidepresentaci%C3%B3detags2.2-ArquitecturaiComponents"></a>Arquitectura  i Components</h2>

<p>L'arquitectura del Servei de Tags és basa en l'ús de llibreries de tags  JSP.</p>

<p>Es recomana una lectura prèvia de la url '<a href="http://java.sun.com/products/jsp/tutorial/TagLibrariesTOC.html" title="Visit page outside Confluence">http://java.sun.com/products/jsp/tutorial/TagLibrariesTOC.html</a>' per conèixer què és una llibreria de tags, com es creen i com s'utilitzen.</p>

<p>A mode de resum, l'arquitectura que hi ha al darrera de les llibreries de  tags és la mostrada a continuació:</p>
<ol>
	<li>El contenidor del Servidor d'Aplicacions en generar el contingut de sortida  a partir de la pàgina JSP troba la referència '&lt;%taglib&gt;' on s'indica la  localització de la llibreria de tags que resol tot tag de la pàgina que  contingui el prefix 'fwk'.</li>
	<li>Quan troba el tag &lt;fwk:text&gt; accedeix al descriptor tld i troba quina  és la classe que generarà el contingut a substituir en la localització del  tag</li>
	<li>El tag realitza la sortida a partir dels atributs passats a la pàgina JSP.  Aquest contingut s'incorpora a la pàgina</li>
</ol>


<p>Seguint la filosofia  d'independència màxima de la implementació canigo defineix interfícies per tots  els tags. En l'actualitat s'ofereixen implementacions basades en JSP i Struts.  Degut a la filosofia que permet configurar de forma externa els tags de les  pàgines, la migració a altra tecnologia serà molt més fàcil.
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-ArquitecturadeProcedimentd%27Inicialitzaci%C3%B3Intern"></a>Arquitectura  de Procediment d'Inicialització Intern</h3>

<p>La configuració dels tags es realitza mitjançant el Servei de Configuració  com si de classes planes es tractessin. El model inherent a JSP, pel qual és el  contenidor qui instancia els tags no ens permet de fer ús directe del patró  'Dependency Injection'. En qualsevol cas, es fa ús dels mecanismes definits pel  Servei de Configuració per a inicialitzar els tags.</p>

<p>El procediment seguit per a la inicialització d'un tag és el següent:</p>

<p><img src="Servei de presentació de tags 2.2_attachments/image003.jpg" align="absmiddle" border="0" /></p>
<ol>
	<li>Es rep la petició de l'usuari (segons per exemple un submit) en el que  arriba un paràmetre 'reqCode' que indica el mètode de l'acció Struts que  s'executarà. Una vegada finalitzada l'acció aquesta retorna la pàgina JSP que  mostrarà el contingut de la resposta.</li>
	<li>En la generació del contingut de sortida el contenidor del servidor crida a  la inicialització de cadascun dels tags inclosos a la pàgina JSP.</li>
</ol>


<p>Imaginem que a la pàgina JSP tenim un component definit de la següent  forma:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text styleId=<span class="code-quote">"firstname"</span> property=<span class="code-quote">"firstname"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
És obligatori que definim aquestes 2 propietats a les nostres pàgines.  L'atribut 'property' és equivalent al que fa servir Struts, que ens permet  lligar quin atribut de l'objecte volem presentar. L'atribut 'styleId' servirà  per obtenir la configuració del tag des del fitxer de configuració.
<br clear="all" />
<br clear="all" />
El propi tag, dins el seu mètode d'inicialització crida a la classe 'TagUtil'  indicant-li quin és el seu 'styleId' per obtenir les seves propietats.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ul>
	<li>La classe TagUtil consulta el fitxer de configuració 'action-servlet.xml' i  obté el bloc definit dins l'entrada corresponent al 'reqCode' que ha arribat com  a paràmetre i les propietats definides per el 'styleId' del tag.</li>
</ul>


<p><br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;property name=<span class="code-quote">"tagsConfiguration"</span>&gt;
&lt;map&gt;
	&lt;entry key=<span class="code-quote">"*"</span> "&gt;
		&lt;list&gt;
			...
			&lt;bean id=<span class="code-quote">"..."</span> class=<span class="code-quote">"..."</span>&gt;
			&lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"nombreEstiloId"</span> "/&gt;
			&lt;/bean&gt;
			&lt;/list&gt;
			&lt;/entry&gt;
			&lt;entry key=<span class="code-quote">"reqCode"</span>&gt;
			&lt;list&gt;
			&lt;bean ...&gt;
			&lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"nombreEstiloId"</span>/&gt;
			&lt;/bean&gt;
		&lt;/list&gt;
	&lt;/entry&gt;
&lt;/map&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Segons el reqCode que arribi com a paràmetre a la url '...?reqCode=...'  s'escollirà una entry o una altra per configurar els tags de la  pàgina.<br/>
L'estil indicat lliga amb l'atribut 'styleId' que s'ha definit a la  pàgina JSP
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>El tag, mitjançant commons beanutils copia les propietats definides sobre  les seves propietats. A continuació realitza la generació de la sortida segons  les propietats definides.</li>
</ol>


<h3><a name="Serveidepresentaci%C3%B3detags2.2-Interf%C3%ADciesiComponentsGen%C3%A8rics"></a>Interfícies  i Components Genèrics</h3>

<p>Es pot trobar tota la documentació JavaDoc y el codi font referent aquests components a les següents urls:</p>

<p><ins>JavaDoc:</ins> <a href="http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_0/canigo-services-web/apidocs/index.html" title="Visit page outside Confluence">http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_0/canigo-services-web/apidocs/index.html</a><br/>
<ins>Codi Font:</ins>&nbsp; <a href="http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_0/canigo-services-web/xref/index.html" title="Visit page outside Confluence">http://canigo.ctti.gencat.net/confluence/canigodocs/site/canigo2_0/canigo-services-web/xref/index.html</a></p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-Instal.laci%C3%B3iConfiguraci%C3%B3"></a>Instal.lació  i Configuració</h2>

<p>Prerequisit: Per al correcte funcionament d'aquest servei és important que  prèviament s'hagin realitzat les configuracions especificades a l'apartat  'Configuració Bàsica' del document 'Serveis de Presentació'.</p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Instal.laci%C3%B3"></a>Instal.lació</h3>

<p>Per a la instal.lació del Servei de Tags es requereix de l'ús del fitxer  'canigo-services-web.jar' i les dependències indicades a l'apartat 'Versions i  Dependències'.</p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Configuraci%C3%B3General"></a>Configuració  General</h3>

<p>A diferència del tradicional mecanisme de tags JSP en el que dins la pàgina s'especifiquen les propietats del tag, canigo va més enllà i permet tractar els  tags com classes Java normals, a fi que es puguin injectar les seves propietats  mitjançant el Servei de Configuració.</p>

<p>Aquesta aplicació es fa només pels components d'entrada de formularis, degut  a la necessitat que tenen diferenciada segons l'acció realitzada.</p>

<p>canigo fa ús del Servei de Configuració per a definir els diferents  comportaments d'una mateixa plana de presentació segons el cas d'ús. Això  implica que una mateixa plana JSP pot tenir diferents configuracions de  visualització i comportament dinàmic, descrites de manera declarativa. Les  nostres pàgines JSP seran molt simples, ja que s'externalitzaran les seves  propietats en aquests fitxers de configuració, en els quals podem utilitzar la  potència de l'herència per definir propietats comuns.</p>

<p>Per cada acció Struts configurada al fitxer 'action-servlet.xml' definirem la  propietat 'tagsConfiguration' on definirem el següent format:</p>

<p>La configuració del Servei de Tags implica els següents passos:</p>
<ol>
	<li>Definir la propietat de configuració de l'acció</li>
	<li>Definir les propietats de cada tag</li>
</ol>


<p>Definició de la configuració per l'acció<br/>
<img src="Servei de presentació de tags 2.2_attachments/image026.jpg" align="absmiddle" border="0" /></p>

<p>La definició de les propietats que s'usaran pels tags d'una pantalla es poden  definir per cada acció de l'aplicació. Així, per exemple podríem representar en  una creació alguns aspectes de forma diferent.<br/>
Per definir quines són les  propietats dels tags per un reqCode en concret es definirà la propietat  'tagsConfiguration'. Aquesta propietat és un mapa, on:</p>
<ol>
	<li>La clau es farà servir com a cerca de la configuració segons el 'reqCode'  rebut al paràmetre.</li>
</ol>


<p>Si es defineix amb el valor '*' es considerà com la configuració per defecte,  en tant que s'aplicarà en els següents casos:</p>
<ol>
	<li>No arriba 'reqCode' a la url</li>
	<li>Si no es troba configuració d'un determinat tag en la configuració segons el  'reqCode' rebut, es cercarà en la configuració per defecte '*'</li>
	<li>Si la definició específica hereta de la definició realitzada a la  configuració per defecte '*'</li>
</ol>


<ol>
	<li>El valor de l'entrada correspondrà a una llista de beans que definirà les  propietats de cadascun dels tags</li>
</ol>


<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean name=<span class="code-quote">"/accounts"</span>"
class=<span class="code-quote">"net.gencat.ctti.canigo.samples.jpetstore.struts.action.AccountAction"</span>&gt;
...
&lt;property name=<span class="code-quote">"tagsConfiguration"</span>"&gt;
&lt;map&gt;
&lt;entry key=<span class="code-quote">"*"</span>"&gt;
&lt;list&gt;

&lt;bean id=<span class="code-quote">"idForm"</span> ...&gt;
&lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"actionForm"</span>/&gt;
&lt;/bean&gt;

&lt;bean id=<span class="code-quote">"idFirstName"</span> ...&gt;
&lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"firstname"</span>/&gt;
&lt;property name=<span class="code-quote">"accesskey"</span> value=<span class="code-quote">"forms.accountForm.field.firstname.accesskey"</span>/&gt;
&lt;property name=<span class="code-quote">"key"</span> value=<span class="code-quote">"forms.accountForm.field.firstname"</span>/&gt; ...
&lt;/bean&gt;

&lt;entry key=<span class="code-quote">"edit"</span>"&gt;
&lt;list&gt;
&lt;bean id=<span class="code-quote">"idFirstName"</span> parent=<span class="code-quote">"textFieldTag"</span>&gt;
&lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"name"</span>/&gt;

&lt;/bean&gt;
&lt;/list&gt;
&lt;/entry&gt;
&lt;/map&gt;
&lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
&gt;&gt;Acció de Struts amb injecció de les seves propietats (veure document  'Serveis de Presentació' per a més referència).<br/>
ddDefinició de la propietat  'tagsConfiguration'<br/>
DDPer qualsevol reqCode es farà servir la configuració  dels tags aquí indicada<br/>
En cas que arribés el paràmetre 'reqCode' amb valor  'edit' es farà servir aquesta configuració
<br clear="all" />
<br clear="all" />
Una vegada definida la propietat de configuració de l'acció podem definir les  propietats de cadascun dels tags.<br/>
Definició de les propietats d'un tag
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean name=<span class="code-quote">"/action"</span>

class=<span class="code-quote">"....XXXAction"</span>&gt;

...

&lt;property  name=<span class="code-quote">"tagsConfiguration"</span>&gt;

&lt;map&gt;

&lt;entry  key=<span class="code-quote">"*"</span>&gt;

&lt;list&gt;

&lt;bean id=<span class="code-quote">""  class="</span>"&gt;

...

&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
La configuració d'un tag és equivalent a la configuració de qualsevol altre  element (consultar el document 'Servei de Configuració' per més referència).
<br clear="all" />
<br clear="all" />
A l'atribut 'class' doncs s'especificarà quin és la classe concreta  d'implementació del tag que farem servir.<br/>
En el cas de Struts farem ús de les següents classes:
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.FormTag</li>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.OptionsFieldTag</li>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.ActionTag</li>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.TextFieldTag</li>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.TextAreaFieldTag</li>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.CheckboxFieldTag</li>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.FileFieldTag</li>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.SelectFieldTag</li>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.ActionImageTag</li>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.SubmitTag</li>
	<li>net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.PasswordFieldTag</li>
</ol>


<p>En tots ells és necessari configurar les següents propietats:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Identificador del tag. És  l'identificador de connexió amb el camp 'styleId' del tag a la pàgina JSP. </td>
</tr>
</tbody></table>
<p>Addicionalment, depenent del tag podrem configurar altres propietats. Tots  ells permeten configurar les propietats dels tags en el que es basen. Podem per  tant configurar qualsevol dels atributs de Struts mitjançant el fitxer de  configuració.</p>

<p>La potència real d'aquesta forma de treballar versus els clàssics tags JSP és  que podem usar l'herència i definir propietats genèriques a un grup de tags.  Així, podem definir propietats comunes a varis tags mitjançant el Servei de  Configuració tal i com es mostra en el següent exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;!-- TAG's <span class="code-keyword">default</span> configuration --&gt;
&lt;bean id=<span class="code-quote">"formTag"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.web.struts.taglib.forms.FormTag"</span>/&gt;

&lt;bean id=<span class="code-quote">"actionImageTag"</span> class="net.gencat.ctti.canigo.services.web.struts.taglib.forms.
ActionImageTag"/&gt;
&lt;bean id=<span class="code-quote">"submitTag"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.web.struts.taglib.forms.SubmitTag"</span>/&gt;

&lt;bean id=<span class="code-quote">"textFieldTag"</span> class="net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.
TextFieldTag"&gt;
&lt;property name=<span class="code-quote">"i18nService"</span> ref=<span class="code-quote">"i18nService"</span>/&gt;
&lt;property name=<span class="code-quote">"validationService"</span> ref=<span class="code-quote">"webValidationService"</span>/&gt;
&lt;property name=<span class="code-quote">"layout"</span> value=<span class="code-quote">"<span class="code-keyword">true</span>"</span>/&gt;
&lt;/bean&gt;
...

&lt;bean id=<span class="code-quote">"checkboxFieldTag"</span> class="net.gencat.ctti.canigo.services.web.struts.taglib.forms.
fields.CheckboxFieldTag"&gt;
&lt;property name=<span class="code-quote">"i18nService"</span> ref=<span class="code-quote">"i18nService"</span>/&gt;
&lt;property name=<span class="code-quote">"validationService"</span> ref=<span class="code-quote">"webValidationService"</span>/&gt;
&lt;property name=<span class="code-quote">"layout"</span> value=<span class="code-quote">"<span class="code-keyword">true</span>"</span>/&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En aquest exemple, es defineixen les propietats comunes als diferents tipus  de components. Així podem fer ús de l'herència per definir els components  específics de la nostra aplicació com per exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean parent=<span class="code-quote">"textFieldTag"</span>&gt;

&lt;property name=<span class="code-quote">"styleId"</span>  value=<span class="code-quote">"id"</span>/&gt; &lt;property name=<span class="code-quote">"mode"</span> value=<span class="code-quote">"E,I,I"</span>/&gt;

&lt;property  name=<span class="code-quote">"key"</span> value=<span class="code-quote">"forms.accountForm.field.id"</span>/&gt;

&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Aquí s'ha eliminat la necessitat de definir el id del tag i s'ha fet ús de  l'herència mitjançant el tag 'textFieldTag' que fa referència al '&lt;bean  id="textFieldTag"&gt;' que s'ha definit en el fitxer extern.
<br clear="all" />
<br clear="all" />
Podem, per últim, estructurar la següent forma el nostre fitxer de  l'aplicació:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;?xml version=<span class="code-quote">"1.0"</span> encoding=<span class="code-quote">"UTF-8"</span> ?&gt;
&lt;!DOCTYPE beans PUBLIC <span class="code-quote">"-<span class="code-comment">//SPRING//DTD BEAN//EN"</span>
</span><span class="code-quote">"http:<span class="code-comment">//www.springframework.org/dtd/spring-beans.dtd"</span>&gt;
</span>
&lt;beans&gt;
&lt;!- TAG's <span class="code-keyword">default</span> configuration -&gt;

&lt;bean id=<span class="code-quote">"formTag"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.web.taglib.config.FormTagConfiguration"</span>/&gt;
&lt;bean id=<span class="code-quote">"fieldTag"</span>&gt;
...
&lt;/bean&gt;

&lt;bean id=<span class="code-quote">"textFieldTag"</span> class="net.gencat.ctti.canigo.services.web.taglib.config.
TextFieldTagConfiguration<span class="code-quote">" parent="</span>fieldTag"&gt;
&lt;/bean&gt;

&lt;<span class="code-keyword">import</span> resource=<span class="code-quote">"action-servlet-accounts.xml"</span>/&gt;
&lt;<span class="code-keyword">import</span> resource=<span class="code-quote">"action-servlet-categories.xml"</span>/&gt;
&lt;<span class="code-keyword">import</span> resource=<span class="code-quote">"action-servlet-products.xml"</span>/&gt;
&lt;<span class="code-keyword">import</span> resource=<span class="code-quote">"action-servlet-items.xml"</span>/&gt;

&lt;/beans&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
On mitjançant el tag 'import' es fa referència a diferents fitxers de  configuració (grups per acció, per una sola acció, etc.)
<br clear="all" />
<br clear="all" />
A continuació s'ofereix explicació de la configuració de cadascun dels  tags.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Configuraci%C3%B3delTag%27ConfigurationTag%27"></a>Configuració  del Tag 'ConfigurationTag'</h3>

<p>Ús: Obligatori, doncs genera les llibreries dels components</p>

<p>El tag Configuration de canigo s'encarrega de generar totes les llibreries  necessàries que requereixen els tags.</p>

<p>Per a generar les llibreries necessàries accedeix al fitxer de propietats de  Spring i per cada tag definit obté les seves propietats. Segons els valors  d'aquestes propietats genera les llibreries. Per exemple, en el cas de  especificar 'showCalendar' a un TextField, generarà les llibreries de calendari,  així com la llibreria de literals de calendari de l'idioma de l'usuari entre  d'altres.</p>

<p>Atributs:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> id </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Usar el valor 'configurationTag' </td>
</tr>
<tr>
<td class='confluenceTd'> class </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Usar  'net.gencat.ctti.canigo.services.web.struts.taglib.configuration.ConfigurationTag' </td>
</tr>
</tbody></table>
<p>Propietats:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Usar el valor 'defaultConfiguration' </td>
</tr>
<tr>
<td class='confluenceTd'> i18nService </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Referència al Servei  d'Internacionalització </td>
</tr>
</tbody></table>
<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"configurationTag"</span>  class="net.gencat.ctti.canigo.services.web.struts.taglib.
configuration.ConfigurationTag"&gt;
	&lt;property  name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"defaultConfiguration"</span>/&gt;
	&lt;property  name=<span class="code-quote">"i18nService"</span> ref=<span class="code-quote">"i18nService"</span>/&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
I a la pàgina JSP (es recomana definir-lo al template de Struts Layout):
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:configuration styleId=<span class="code-quote">"defaultConfiguration"</span> /&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Configuraci%C3%B3delstagsdeFormulari"></a>Configuració  dels tags de Formulari</h3>

<p>Configuració del Tag Form</p>

<p>Aquest tag es basa en Struts, pel que sempre podem definir les propietats que  el tag 'form' de Struts proporciona. En aquest apartat només es definiran  aquelles propietats addicionals que ofereix canigo.
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:form action=<span class="code-quote">"accounts.<span class="code-keyword">do</span>"</span> reqCode=<span class="code-quote">"edit"</span> width=<span class="code-quote">"500"</span>  method=<span class="code-quote">"post"</span>&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Atributs addicionals:
<br clear="all" />
<br clear="all" />
&#124;&#124; <b>Atribut</b> &#124;&#124; <b>Requerit</b> &#124;&#124; <b>Valor</b> &#124;&#124;
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> reqCode </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Aquest paràmetre permet especificar quin nom de funció de la Action es cridarà en el moment de fer el submit del  formulari. Exemple: Si especifiquem com a 'reqCode=save' es cridarà al mètode  'save' de l'acció de Struts. </td>
</tr>
<tr>
<td class='confluenceTd'> layout </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Aquesta propietat permet definir si  volem generar o no el layout pel formulari. Per defecte, el tag crea un  &lt;table&gt; que agruparà els components input interns. Aquests components  interns generaran '&lt;tr&gt;'&lt;td&gt;' de forma automàtica a menys que  configurem la seva propietat 'layout' a false. <br clear="all" />
<br clear="all" />
En qualsevol cas, també s'ofereixen tags que ens permetran definir el nombre de columnes i files, crear una fila on ubicar tots els components (cas en el que no  crearan &lt;tr&gt;), etc. (veure 'Tags de Layout'). </td>
</tr>
<tr>
<td class='confluenceTd'> validationProperties </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Mitjançant aquesta propietat de  tipus 'Properties' podem especificar com es farà la validació de les dades  entrades al formulari. <br clear="all" />
<br clear="all" />
Veure informació detallada del  seu ús a continuació </td>
</tr>
</tbody></table>
<ol>
	<li>Configuració de l'atribut 'validationProperties'</li>
</ol>


<p><img src="Servei de presentació de tags 2.2_attachments/image006.gif" align="absmiddle" border="0" /></p>

<p>Dins el tag &lt;props&gt; podem definir les següents propietats:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atribut</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> validationType </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Es permeten els valors: <br clear="all" />
<br clear="all" />
&#35; SERVER. La validació es realitzarà mitjançant Ajax  contra el Servei de Validació en el servidor. El resultat de la validació  apareixerà a la mateixa pàgina HTML del client <br clear="all" />
&#35; CLIENT. La  validació es realitza mitjançant Javascript generat al client <br clear="all" /> </td>
</tr>
<tr>
<td class='confluenceTd'> validatorName </td>
<td class='confluenceTd'> Depén validationnType </td>
<td class='confluenceTd'> Especifica quin és el nom de  validador definit al fitxer 'validation.xml' del servidor que es farà servir per  validar els camps entrats (veure 'Servei de Validació' per més referència) <br clear="all" />
<br clear="all" />
En el cas que s'hagi usat 'SERVER' com a  'validatorType', no cal indicar 'validatorName' si es vol usar com a nom de  validador el 'pojoClass' configurat a l'acció associada al formulari. <br clear="all" /> </td>
</tr>
</tbody></table>
<p>Exemple segons validationType 'SERVER':
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;property name=<span class="code-quote">"validationProperties"</span>&gt;

&lt;props&gt;

&lt;prop  key=<span class="code-quote">"validationType"</span>&gt;SERVER&lt;/prop&gt;

&lt;/props&gt;

&lt;/property&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image007.jpg" align="absmiddle" border="0" /><br/>
Exemple segons  validationType 'CLIENT':
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean parent=<span class="code-quote">"formTag"</span>&gt;

&lt;property name=<span class="code-quote">"styleId"</span>  value=<span class="code-quote">"actionForm"</span>/&gt; &lt;property  name=<span class="code-quote">"validationProperties"</span>&gt;

&lt;props&gt;

&lt;prop  key=<span class="code-quote">"validationType"</span>&gt;CLIENT&lt;/prop&gt;

&lt;prop  key=<span class="code-quote">"validatorName"</span>&gt;account&lt;/prop&gt;

&lt;/props&gt;

...

&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image008.jpg" align="absmiddle" border="0" /><br/>
Configuració de  Propietats comunes a tots els tags d'entrada de dades en formulari
<br clear="all" />
<br clear="all" />
Quan desenvolupem una aplicació en la que intervenen formularis que es poden  mostrar de manera diferenciada segons els privilegis de l'usuari o l'acció  escollida existeixen 2 formes tradicionals de definir-los:
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>Creant una pàgina JSP per cada possible presentació del mateix  formulari</li>
	<li>Imbricant codi condicional que faci el control (segons els privilegis, el  paràmetre de la url, etc.) i executi la creació dels tags de diferents  maneres</li>
</ol>


<p>Tant una com l'altra solució requereixen d'un esforç massa gran. En la  primera opció, un canvi que impliqui afegir un camp o retocar un ja existent pot  requerir de la necessitat de modificar vàries pàgines JSP, mentre que en la  segona solució la pàgina es fa molt difícil de llegir i mantenir.</p>

<p>canigo permet l'ús de modes de formulari que s'aplicaran als components  continguts en ell. Segons el mode especificat, els components es mostraran d'una  o un altra forma (ocults, editables, no editables, etc.)</p>

<p>Els tags input de canigo es basen en els tags proporcionats per Struts, de  forma que podem sempre definir les seves propietats als nostres fitxers de  configuració.</p>

<p>En aquest apartat només es mostren les propietats addicionals que ofereix  canigo:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> key </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Clau del literal a generar com a  'label' del component. </td>
</tr>
<tr>
<td class='confluenceTd'> layout </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indicar 'false' si no es volen  generar els tags '&lt;tr&gt;','&lt;td&gt;' per als components. Per defecte és  'true' si no indiquem aquesta propietat </td>
</tr>
<tr>
<td class='confluenceTd'> accessKey </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Permet fer ús d'accés per teclat al  component. <br clear="all" />
S'ha d'especificar la clau del fitxer  d'internacionalització que defineix el caràcter que ha de subratllar (del valor  del 'key' definit) i considerar per generar l'event de focus si es fa servir  'ALT+valor key' </td>
</tr>
<tr>
<td class='confluenceTd'> mode </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Mode de visualització del component  segons el mode que s'hagi assignat al formulari (veure apartat 'Utilització del  Servei' per conèixer com assignar el mode del formulari). <br clear="all" />
<br clear="all" />
S'ha d'indicar un valor amb 3 parts separades per ','. La primera  indica en quin mode apareixerà el component si el mode del formulari és de  creació, la segona part en quin mode ha d'aparèixer si el mode del formulari és  d'edició i la tercera part en quin mode ha d'aparèixer si el mode del formulari  és de consulta. <br clear="all" />
<br clear="all" />
Exemple: 'E,E,I' <br clear="all" />
<br clear="all" />
A continuació s'ofereix més detall dels valors possibles i del seu ús. </td>
</tr>
<tr>
<td class='confluenceTd'> required </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Mostrar el camp com obligatori. No  cal definir-lo si s'ha definit al 'Servei de Validació' que el camp és  obligatori. <br clear="all" />
<br clear="all" />
A continuació s'oferirà més detall dels  valors possibles i del seu ús. </td>
</tr>
<tr>
<td class='confluenceTd'> tooltipKey, tooltipTitleKey i  tooltipOptions </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Permeten generar un tooltip d'ajuda  al component <br clear="all" />
<br clear="all" />
A continuació s'oferirà més detall dels  valors possibles i del seu ús. </td>
</tr>
<tr>
<td class='confluenceTd'> selectOnFocus </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> En rebre el focus el component  tindrà tot el seu contingut seleccionat. Especificar 'false' si no es vol  utilitzar aquest comportament per defecte. </td>
</tr>
<tr>
<td class='confluenceTd'> i18nService </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Referència al servei  d'internacionalització </td>
</tr>
<tr>
<td class='confluenceTd'> validationService </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Referència al servei de validació </td>
</tr>
</tbody></table>
<ul>
	<li>'key' i 'layout '(Generació de etiquetes i layout als  components)</li>
</ul>


<p>En tota aplicació Web tenim que utilitzar formularis. Aquests solen estar  estructurats mitjançant una graella en la que es mostren els components de  formulari (camps d'entrada de dades, de selecció, botons d'opció, etc.) i a  l'esquerra una etiqueta associada al camp.</p>

<p>Mitjançant Struts, JSTL i l'ús del tag '&lt;label&gt;' (descuidat per molts  desenvolupadors però existent a l'estàndard HTML fa molt de temps) la  realització d'un component implicaria el següent codi:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;tr&gt;&lt;td&gt;

&lt;label <span class="code-keyword">for</span>=<span class="code-quote">"id"</span> ...&gt;

&lt;fmt:message  key=<span class="code-quote">"key.id "</span>/&gt;

&lt;/label&gt;

&lt;html:text property=<span class="code-quote">"id"</span> size=<span class="code-quote">"20"</span>  maxlength=<span class="code-quote">"20"</span>/&gt;

&lt;/td&gt;&lt;/tr&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Resulta obvi que a mesura que anem afegint components a la nostra pàgina JSP  aquesta es fa feixuga de llegir, ja que incorpora gran quantitat de layout i  etiquetes. Per què no un tag que generi tot aquest codi i fos senzill  d'utilitzar? Amb el nou tag proporcionat per canigo el codi equivalent  seria:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text styleId=<span class="code-quote">"id"</span> property=<span class="code-quote">"id"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean parent=<span class="code-quote">"textFieldTag"</span>&gt;

&lt;property name=<span class="code-quote">"styleId"</span>  value=<span class="code-quote">"firstname"</span>/&gt;

...

&lt;property name=<span class="code-quote">"key"</span>  value=<span class="code-quote">"forms.accountForm.field.firstname"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ul>
	<li>accessKey (accés per teclat)</li>
</ul>


<p>Per a poder accedir mitjançant el teclat a qualsevol camp, podem usar  l'atribut 'accesskey'. Mitjançant HTML podríem crear el següent codi:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;label  <span class="code-keyword">for</span>=<span class="code-quote">"nombre"</span>&gt;&lt;u&gt;N&lt;/u&gt;ombre&lt;/label&gt;

&lt;input type=<span class="code-quote">"text"</span>  accesskey=<span class="code-quote">"n"</span> id=<span class="code-quote">"nombre"</span> name=<span class="code-quote">"nombre"</span>&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <b>Mode tradicional</b>
<br clear="all" />
<br clear="all" />
<br clear="all" />
canigo genera de forma automàtica <sup>2</sup> el codi d'accés als  components. En conjunció amb el servei de internacionalització defineix quina és  la clau que defineix quin és el caràcter a subratllar.<br/>
Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean parent=<span class="code-quote">"textFieldTag"</span>&gt;

&lt;property name=<span class="code-quote">"styleId"</span>  value=<span class="code-quote">"firstname"</span>/&gt;

&lt;property name=<span class="code-quote">"accesskey"</span>

value=<span class="code-quote">"forms.accountForm.field.firstname.accesskey"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ul>
	<li>mode</li>
</ul>


<p>El mode dels camps permet especificar si un camp "input" ha de ser editable,  de lectura, ocult o que no aparegui en el formulari segons el mode de display  del formulari. Això permet per exemple que un camp que forma part de la clau  primària només sigui editable durant la creació, o mostrar camps calculats només  quan es visualitza la informació i no quan s'edita.</p>

<p>El comportament per defecte és que els camps es mostrin editables si el mode  del formulari es CREATE o EDIT, i es mostrin de lectura (valor text pla sense  component HTML i un hidden amb el valor del camp) si el mode del formulari és  INSPECT.</p>

<p>Aquest comportament per defecte pot alterar-se en els camps mitjançant  l'atribut 'mode'. El valor que s'ha d'assignar a aquest atribut ha de seguir el  patró 'X,Y,Z'; on X és el comportament que tindrà el camp en cas que el mode del  formulari sigui 'FormUtils.CREATE_MODE', Y el comportament en el mode edició  ('FormUtils.EDIT_MODE') i Z en mode de consulta ('FormUtils.INSPECT_MODE'). Els  valors possibles per X,Y i Z són:</p>
<ol>
	<li>E: editable</li>
	<li>I: inspeccionable (de consulta), amb un camp ocult corresponent</li>
	<li>S: mostrar, igual que 'I' però no es genera camp ocult</li>
	<li>N: no es mostra</li>
	<li>P: present (com 'S' si el valor del camp no és null i com 'N' si el valor  del camp és nul)</li>
	<li>H: ocult (no es mostra, però sí es genera un camp ocult)</li>
	<li>R : de lectura (es genera el camp però amb l'atribut 'readonly')</li>
	<li>D: desactivat (es genera el camp amb l'atribut 'disabled')</li>
</ol>


<p>Una vegada especificat en quin mode funcionarà el formulari, els components  apareixeran segons el mode especificat, sense que per això s'hagi de generar  codi JSP addicional.</p>
<ul>
	<li>required</li>
</ul>


<p>Es pot especificar que es mostri una imatge o text al principi de l'etiqueta  per indicar que un camp és requerit si especifiquem el valor 'true' per la  propietat 'required'.</p>

<p>Aquesta propietat <b>no és necessària</b> especificar-la si en el Servei de  Validació s'ha configurat que el camp és obligatori. El tag accedeix al servei i  pregunta si el camp associat és requerit. Per a que això funcioni cal que  s'especifiqui la propietat 'validationService' al tag.</p>

<p>El comportament proporcionat per canigo crea el contingut '<br/>
'&lt;span  class='required'&gt;*&lt;/span&gt;' abans del tag HTML '&lt;label&gt;' . Aquest  comportament està definit al fitxer  'scripts/ajax/behaviour/canigo-behaviours.js'. En cas de voler canviar aquest  comportament podem accedir al fitxer i fer els canvis necessaris al codi:</p>

<p>Podem configurar l'estil de l'asterisc modificant al fitxer d'estils la  següent entrada:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">label span.required \{ color: #c32; \}</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image009.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ul>
	<li>tooltipKey, tooltipTitleKey y tooltipOptions</li>
</ul>


<p>Aquestes 3 propietats ens permeten especificar l'ajuda contextual als camps.</p>
<ol>
	<li>tooltipKey. Clau del literal del missatge a mostrar dins el tooltip</li>
	<li>tooltipTitleKey. Clau del literal a mostrar si volem mostrar un títol com a  capçalera del tooltip</li>
	<li>tooltipOptions. Opcions aplicades segons la implementació (en el cas actual  sota DOM Tooltip).</li>
</ol>


<p>Per a ser utilitzat el tag 'Configuration' importa el fitxer js  'scrips/ajax/ajaxtags/canigo&#45; ajaxtags.js'. Si es vol canviar el comportament  per defecte es poden fer els canvis necessaris a aquest fitxer.</p>

<p>En aquest codi es genera de forma automàtica el link que mostrarà el tooltip  en passar per sobre. Addicionalment podem configurar els estils dels tooltips  segons la definició dels estils mostrats a continuació:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">a.tooltip:link \{text-decoration: none; \}

a.tooltip:visited  \{text-decoration: none; \}

a.tooltip:hover \{text-decoration: none;  cursor:help; \}

a.tooltip:active \{\}</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Un dels estils més útils és 'cursor:help' dins a hover, ja que ens apareixerà  el cursor d'ajuda quan passem per sobre de l'etiqueta del component.
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image010.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
NOTA: El cursor d'ajuda  no apareix en el gràfic<br/>
Configuració del Tag Text<br/>
El tag de text permet l'entrada de dades i es basa en el tag de Struts. Per  tant, totes les propietats definides a Struts permeten ser definides a  canigo.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<p>A més de les propietats pròpies als components de formulari i de les de  Struts s'han incorporat les següents propietats:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> autoTab </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Especificar 'true' si es vol  realitzar autotabulació en haver introduït el nombre de caràcters especificat a  la propietat '<b>maxLength</b>' del component. </td>
</tr>
<tr>
<td class='confluenceTd'> convertTo </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Permet definir quines conversions es  volen realitzar al valor introduït al camp de forma automàtica en perdre el  focus del component. <br clear="all" />
<br clear="all" />
Cal especificar les diferents  conversions a aplicar separades per ','. Es proporcionen les següents  conversions: <br clear="all" />
<br clear="all" />
&#35; uppercase. Passa tot el contingut a  majúscules <br clear="all" />
&#35; lowercase. Passa tot el contingut a minúscules <br clear="all" />
&#35; trim. Elimina els blancs de l'esquerra i dreta del valor. Entre les  paraules s'encarrega també de deixar un únic blanc. <br clear="all" /> </td>
</tr>
<tr>
<td class='confluenceTd'> showCalendar </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indicant 'true' podem especificar  que el camp d'edició ha de mostrar un calendari de selecció de data. <br clear="all" />
<br clear="all" />
En cas de que en el servei de validació s'hagi  especificat que el camp associat té una validació de data, el tag comprovarà el  format definit i serà aquest el que permetrà a canigo saber quin és el format de  la data que ha de copiar en seleccionar una data dins el calendari. </td>
</tr>
</tbody></table>
<ul>
	<li>showCalendar</li>
</ul>


<p>Per a que el calendari es mostri correctament cal:</p>
<ol>
	<li>Definir el valor 'date' en l'atribut 'depends' dins el fitxer de  configuració del 'Servei de Validació'. Definir en 'datePattern' el patró a  complir</li>
</ol>


<ol>
	<li>Incorporar el css a utilitzar
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;style type=<span class="code-quote">"text/css"</span>&gt;@<span class="code-keyword">import</span>  url(css/calendars/dynarch/calendar-blue.css);&lt;/style&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image011.jpg" align="absmiddle" border="0" /><br clear="all" />
Podem usar diferents  fitxers d'estils o definir un propi. Els fitxers d'estils existents es troben a  'css/calendars/dynarch'.</li>
</ol>


<p>Els literals del calendari es troben definits en fitxers '.js' que es troben  al directori 'scripts/calendars/dynarch/lang/'. El tag 'Configuration' és qui  s'encarrega d'afegir la referència al fitxer corresponent a l'idioma de  l'usuari.</p>

<p><em>Integració amb el Servei de Validació</em></p>

<p>Per a que s'usi un format de data específic, canigo consulta per la propietat  associada al tag (indicada mitjançant l'atribut 'property' del tag) si es tracta  d'un objecte de tipus 'java.util.Date'. Si és així, obté el format que s'ha  d'aplicar segons l'idioma de l'usuari. Podem configurar quin serà el format de  data utilitzat per cada llenguatge definit una nova clau i el seu patró en la  propietat 'localeDatePatternsMap' del fitxer 'property-editors.xml' tal i com es  mostra a continuació:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">...
&lt;bean id=<span class="code-quote">"customEditors"</span> class=<span class="code-quote">"java.util.HashMap"</span>&gt;
&lt;constructor-arg&gt;
&lt;map&gt;
&lt;entry key=<span class="code-quote">"java.util.Date"</span>&gt;
&lt;bean class=<span class="code-quote">"net.gencat.ctti.canigo.services.i18n.spring.beans.propertyeditors.CustomDateEditor"</span>&gt;
&lt;property name=<span class="code-quote">"i18nService"</span> ref=<span class="code-quote">"i18nService"</span>/&gt;
&lt;property name=<span class="code-quote">"localeDatePatternsMap"</span>&gt;
&lt;map&gt; &lt;entry&gt; &lt;key&gt;&lt;value&gt;es&lt;/value&gt;&lt;/key&gt; &lt;value&gt;dd/MM/yyyy&lt;/value&gt;
&lt;/entry&gt;
&lt;entry&gt; &lt;key&gt;&lt;value&gt;en&lt;/value&gt;&lt;/key&gt; &lt;value&gt;MM/dd/yyyy&lt;/value&gt; &lt;/entry&gt;
&lt;/map&gt;
&lt;/property&gt;
...
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Configuració del Tag 'Password'
<br clear="all" />
<br clear="all" />
El tag de password permet definir les mateixes propietats que el tag  'Text'.<br/>
Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean parent=<span class="code-quote">"passwordFieldTag"</span>&gt;

&lt;property name=<span class="code-quote">"mode"</span>  value=<span class="code-quote">"E,I,I"</span>/&gt;

&lt;property name=<span class="code-quote">"styleId"</span>  value=<span class="code-quote">"password"</span>/&gt;

&lt;property name=<span class="code-quote">"key"</span>  value=<span class="code-quote">"forms.accountForm.field.password"</span>/&gt;

&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Configuració del Tag 'TextArea'
<br clear="all" />
<br clear="all" />
<br clear="all" />
&#124;&#124; <b>Propietat</b> &#124;&#124; <b>Requerit</b> &#124;&#124; <b>Valor</b> &#124;&#124;
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> rows </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Número de files </td>
</tr>
<tr>
<td class='confluenceTd'> cols </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Número de columnes </td>
</tr>
<tr>
<td class='confluenceTd'> decoratorProperties </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Permet especificar la generació  d'una àrea amb justificats, formats, ... </td>
</tr>
</tbody></table>
<ul>
	<li><b>decoratorProperties</b></li>
</ul>


<p>Permet especificar la generació d'un textarea en el que es permetin  justificats, formats, colors, etc. El contingut aquí introduït serà enviat com  HTML.</p>

<p>Per especificar els decoratorProperties usarem els següents valors:</p>
<ol>
	<li>theme: 'advanced' o 'simple' (si volem més o menys opcions)</li>
	<li>mode: 'exact'</li>
</ol>


<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean parent=<span class="code-quote">"textAreaFieldTag"</span>&gt;
    &lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"comments"</span>/&gt;
    &lt;property name=<span class="code-quote">"key"</span> value=<span class="code-quote">"forms.accountForm.field.comments"</span>/&gt;
    &lt;property name=<span class="code-quote">"rows"</span> value=<span class="code-quote">"10"</span>/&gt;
    &lt;property name=<span class="code-quote">"cols"</span> value=<span class="code-quote">"40"</span>/&gt; &lt;property name=<span class="code-quote">"decoratorProperties"</span>&gt;
    &lt;map&gt;
        &lt;entry&gt;
            &lt;key&gt;&lt;value&gt;theme&lt;/value&gt;&lt;/key&gt;
            &lt;value&gt;advanced&lt;/value&gt;
        &lt;/entry&gt;
        &lt;entry&gt;
            &lt;key&gt;&lt;value&gt;mode&lt;/value&gt;&lt;/key&gt;
            &lt;value&gt;exact&lt;/value&gt;
        &lt;/entry&gt;
    &lt;/map&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Mitjançant l'exemple a dalt mostrat tindríem un component com el mostrat a  continuació:
<br clear="all" />
<br clear="all" />
\\\\ <img src="Servei de presentació de tags 2.2_attachments/image012.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<b>Configuració del Tag 'Select'</b><br/>
Permet definir les mateixes propietats que les definides per Struts i les  propietats generals a tots els tags d'entrada de formulari definides  anteriorment.<br/>
Addicionalment es proporcionen 2 funcionalitats prou importants:
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>Generació d'opcions segons una query de base de dades</li>
	<li>Generació de les opcions segons el valor escollit en un altre select de  forma dinàmica sense refresc de la pàgina</li>
	<li>Generació de les opcions segons query de la base de  dades</li>
</ol>


<p>Si volem mostrar una llista d'opcions que prové d'una base de dades canigo  canigo ofereix la possibilitat de definir la font de les dades.</p>

<p>Per això cal que seguim els següents passos:</p>
<ul>
	<li>Definir l'adaptador que s'usarà basat en Hibernate
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean  name=<span class="code-quote">"defaultOptionBaseHibernateAdapter"</span>

class=<span class="code-quote">"net.mlw.vlh.adapter.hibernate3.Hibernate30Adapter"</span>&gt;

&lt;property  name=<span class="code-quote">"sessionFactory"</span> ref=<span class="code-quote">"sessionFactory"</span>/&gt;

&lt;property  name=<span class="code-quote">"defaultNumberPerPage"</span> value=<span class="code-quote">"5"</span>/&gt;

&lt;property  name=<span class="code-quote">"defaultSortColumn"</span> value=<span class="code-quote">"id"</span>/&gt;

&lt;property  name=<span class="code-quote">"defaultSortDirection"</span> value=<span class="code-quote">"asc"</span>/&gt;

&lt;property  name=<span class="code-quote">"removeEmptyStrings"</span> value=<span class="code-quote">"<span class="code-keyword">true</span>"</span>/&gt;

&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></li>
</ul>


<p>El seu ús és equivalent al definit pel Servei de Llistats.</p>
<ul>
	<li>Gestors de les llistes
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean name=<span class="code-quote">"defaultOptionValueListHandler"</span>
class=<span class="code-quote">"net.mlw.vlh.DefaultValueListHandlerImpl"</span>&gt;
&lt;property name=<span class="code-quote">"config.adapters"</span>&gt;
&lt;map&gt;
&lt;entry key=<span class="code-quote">"categoriesList"</span>&gt;
&lt;bean parent=<span class="code-quote">"defaultOptionBaseHibernateAdapter"</span>&gt;
&lt;property name=<span class="code-quote">"hql"</span>&gt;
&lt;value&gt;
FROM
net.gencat.ctti.canigo.samples.jpetstore.model.Category
AS vo WHERE 1=1
/~descn: AND vo.descn LIKE \{descn\} ~/
/sortColumn: ORDER BY vo.[sortColumn] [sortDirection]/
&lt;/value&gt;
&lt;/property&gt;
&lt;/bean&gt;
&lt;/entry&gt;

&lt;/map&gt;
&lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></li>
</ul>


<p>En la propietat 'config.adapters' definirem les diferents queries a executar  per a recuperar les llistes. Aquestes queries es troben definides en HQL, pel  que obtenim objectes.</p>
<ul>
	<li>key. Nom de la llista (aquest nom serà utilitzat des de la definició del  tag)</li>
</ul>


<ul>
	<li>hql. Definició de la consulta Hibernate per a obtenir la llista de  valors
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;entry key=<span class="code-quote">"nomLlista"</span>&gt;

&lt;bean  parent=<span class="code-quote">"defaultOptionBaseHibernateAdapter"</span>&gt;

&lt;property  name=<span class="code-quote">"hql"</span>&gt;

...</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></li>
	<li>Definir les següents entrades:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean  id=<span class="code-quote">"defaultOptionValueListHandlerHelper"</span>

class=<span class="code-quote">"net.mlw.vlh.web.mvc.ValueListHandlerHelper"</span>&gt;

&lt;property  name=<span class="code-quote">"valueListHandler"</span>&gt;

&lt;ref bean=<span class="code-quote">"defaultOptionValueListHandler"</span>  /&gt;

&lt;/property&gt;

&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean  name=<span class="code-quote">"defaultOptionListSource"</span>

class="net.gencat.ctti.canigo.services.web.taglib.util.options.vlh.hibernate3.
VlhOptionListSourceImpl"&gt;

&lt;property  name=<span class="code-quote">"valueListHandlerHelper"</span>&gt;

&lt;ref  bean=<span class="code-quote">"defaultOptionValueListHandlerHelper"</span>  /&gt;

&lt;/property&gt;

&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></li>
</ul>


<ol>
	<li>Definir la informació de la font de la nostra llista</li>
	<li>optionListName: Referència a la definició de la llista definida al pas  2</li>
	<li>optionLabelName: Atribut de l'objecte recuperat que servirà d'etiqueta de  l'opció</li>
	<li>optionLabelProperty: Atribut de l'objecte recuperat que servirà de valor de  l'opció
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"categoriesOptionListSource"</span>  parent=<span class="code-quote">"defaultOptionListSource"</span>&gt;

&lt;property name=<span class="code-quote">"optionListName"</span>  value=<span class="code-quote">"categoriesList"</span>/&gt;

&lt;property name=<span class="code-quote">"optionLabelName"</span>  value=<span class="code-quote">"name"</span>/&gt;

&lt;property name=<span class="code-quote">"optionLabelProperty"</span> value=<span class="code-quote">"id"</span>/&gt;

&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></li>
</ol>


<ul>
	<li>Incorporar la llista al servei d'opcions
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"optionsListService"</span>  class="net.gencat.ctti.canigo.services.web.taglib.util.
options.OptionsListServiceBase"&gt;
	&lt;property  name=<span class="code-quote">"optionsListSources"</span>&gt;
		&lt;map&gt;
			&lt;entry  key=<span class="code-quote">"categoriesList"</span>&gt;
			&lt;ref  bean=<span class="code-quote">"categoriesOptionListSource"</span>/&gt;&lt;/entry&gt;
			&lt;entry  key=<span class="code-quote">"animalsList"</span>&gt;
			&lt;ref  bean=<span class="code-quote">"animalsOptionListSource"</span>/&gt;&lt;/entry&gt;
		&lt;/map&gt;
	&lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></li>
	<li>Per últim definir a la propietat 'optionsListService' del tag una referència  al servei d'opcions (propietat 'optionsListService') i afegir el nom de la  llista a la propietat 'optionsListName':</li>
</ul>


<p><br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"selectFieldTag"</span>  class="net.gencat.ctti.canigo.services.web.struts.taglib.
forms.fields.SelectFieldTag"&gt;

...

&lt;property name=<span class="code-quote">"optionsListService"</span>  ref=<span class="code-quote">"optionsListService"</span>/&gt;

...

&lt;bean parent=<span class="code-quote">"selectFieldTag"</span>&gt;
	&lt;property name=<span class="code-quote">"key"</span>  value=<span class="code-quote">"forms.accountForm.field.preferredCategory"</span>/&gt;
	&lt;property  name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"preferredCategoryId"</span>/&gt;
	&lt;property  name=<span class="code-quote">"optionsListName"</span> value=<span class="code-quote">"categoriesList"</span>/&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ul>
	<li>Generació de les opcions segons el valor escollit en un altre  select</li>
</ul>


<p>En cas de voler presentar la llista d'opcions d'un select segons la selecció  realitzada a un altra selecció, definirem a més del definit en la secció  anterior un nou atribut 'selectFieldSource' en el que definirem:</p>
<ol>
	<li>source. Nom de la propietat 'styleId' utilitzada en el select font</li>
	<li>paramName. Nom del paràmetre de la query definit entre {}.</li>
</ol>


<p>Per exemple, imaginem que volem mostrar la llista d'animals segons la  categoria escollida.<br/>
<img src="Servei de presentació de tags 2.2_attachments/image013.jpg" align="absmiddle" border="0" /><br/>
Podem definir la hql de  la llista 'animalsList' tal i com es mostra a continuació:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;entry key=<span class="code-quote">"animalsList"</span>&gt;

&lt;bean  parent=<span class="code-quote">"defaultOptionBaseHibernateAdapter"</span>&gt;

&lt;property  name=<span class="code-quote">"hql"</span>&gt;

&lt;value&gt;

FROM

net.gencat.ctti.canigo.samples.jpetstore.model.Product

AS  vo WHERE 1=1

/~category: AND vo.category.id LIKE \{category\} ~/

/sortColumn: ORDER BY vo.[sortColumn]  [sortDirection]/

&lt;/value&gt;

&lt;/property&gt;

&lt;/bean&gt;

&lt;/entry&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En aquesta hql apareix el paràmetre {category} dins el LIKE que és el que  ens permetrà lligar que se'ns retornin els productes amb la categoria  indicada.
<br clear="all" />
<br clear="all" />
Per a que s'envii com a criteri valor dins {category} el valor escollit a  la select source definirem com a 'paramName' el valor 'category'.
<br clear="all" />
La configuració correcte en el action-servlet seria la següent:&nbsp;
<br clear="all" />
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean parent=<span class="code-quote">"selectFieldTag"</span>&gt;
&lt;property name=<span class="code-quote">"key"</span> value=<span class="code-quote">"forms.accountForm.field.preferredAnimal"</span>/&gt;
&lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"preferredAnimalId"</span>/&gt;
&lt;property name=<span class="code-quote">"optionsListName"</span> value=<span class="code-quote">"animalsList"</span>/&gt; &lt;property name=<span class="code-quote">"selectFieldSource"</span>&gt;
&lt;map&gt;
&lt;entry&gt;
&lt;key&gt;&lt;value&gt;source&lt;/value&gt;&lt;/key&gt;
&lt;value&gt;preferredCategoryId&lt;/value&gt;
&lt;/entry&gt;

&lt;entry&gt;
&lt;key&gt;&lt;value&gt;paramName&lt;/value&gt;&lt;/key&gt;
&lt;value&gt;category&lt;/value&gt;
&lt;/entry&gt; &lt;/map&gt;

&lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
També podem fer que el select sigui dependent de més de un camp. El procés es exactament igual però posant els valors separats amb comes tal i com indiquem en el següent exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;entry&gt;
&lt;key&gt;&lt;value&gt;source&lt;/value&gt;&lt;/key&gt;
&lt;value&gt;source1,source2&lt;/value&gt;
&lt;/entry&gt;

&lt;entry&gt;
&lt;key&gt;&lt;value&gt;paramName&lt;/value&gt;&lt;/key&gt;
&lt;value&gt;paramName1,paramName2&lt;/value&gt;
&lt;/entry&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Configuració del Tag 'Checkbox'
<br clear="all" />
<br clear="all" />
Permet definir les mateixes propietats que les definides per Struts i les  propietats generals a tots els tags d'entrada de formulari definides  anteriorment.<br/>
Exemple:<br/>
<img src="Servei de presentació de tags 2.2_attachments/image014.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"checkboxFieldTag"</span> class="net.gencat.ctti.canigo.services.web.struts.
taglib.forms.fields.CheckboxFieldTag"&gt;
&lt;property name=<span class="code-quote">"i18nService"</span> ref=<span class="code-quote">"i18nService"</span>/&gt;
&lt;property name=<span class="code-quote">"validationService"</span> ref=<span class="code-quote">"webValidationService"</span>/&gt;
&lt;property name=<span class="code-quote">"layout"</span> value=<span class="code-quote">"<span class="code-keyword">true</span>"</span>/&gt;
&lt;/bean&gt;

&lt;bean parent=<span class="code-quote">"checkboxFieldTag"</span>&gt;
&lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"lower18"</span>/&gt; &lt;property name=<span class="code-quote">"key"</span> value="forms.
accountForm.field.lower18"/&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Configuració del Tag 'File'
<br clear="all" />
<br clear="all" />
Aquest tag permet especificar l'ús d'un fitxer de upload<br/>
Veure 'Servei de Upload de Fitxers' per a més referència de la configuració  necessària.<br/>
El tag requereix que es configuri la propietat 'encType' del tag 'Form' amb  el següent valor:
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<p><b>"multipart/form-data"</b></p>

<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean parent=<span class="code-quote">"fileFieldTag"</span>&gt;

&lt;property name=<span class="code-quote">"styleId"</span>  value=<span class="code-quote">"file"</span>/&gt;

&lt;property name=<span class="code-quote">"mode"</span> value=<span class="code-quote">"E,I,I"</span>/&gt;

&lt;property  name=<span class="code-quote">"key"</span> value=<span class="code-quote">"forms.fileForm.field.file"</span>/&gt;

&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Configuraci%C3%B3delstagsdeLlistats"></a>Configuració  dels tags de Llistats</h3>

<p>Veure document 'Servei de Llistats'.</p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-Configuraci%C3%B3delstagsenelJSP"></a>Configuració  dels tags en el JSP</h2>

<p>El nou servei de configuració permet definir totes les propietats de text o  referències de components en el JSP. Això fa que no sigui necessari tenir  definit un styleId que faci referència en el action-services-XXX.xml en la  propietats tagsConfiguration de l'action.</p>

<p>Cal remarcar que per propietats complexes, com Maps o Lists, no es dona  suport i necessàriament s'han d'escriure en els fitxers d'Spring i  relacionar-les amb el styelId.</p>

<p>Aquesta utilitat simplifica el desenvolupament ja que es pot tenir configurat  totes les dades del tag en el propi JSP sense necessitat d'haver d'escriure les  propietats en fitxers Spring.</p>

<p>Per fer referències a components dins el tag JSP s'ha creat l'atribut <em>services</em> en tots el tags que permet especificar la propietat i la  referència del component que se li ha d'injectar al tag.</p>

<p>Seguidament es mostra un exemple.</p>

<p>&lt;fwk:text styleId="password" layout="false"  property="password"<br/>
services="i18nService:i18nService,validationService:webValidationService"  /&gt;</p>

<p>En l'exemple anterior s'estan injectant els beans d'spring amb id  'i18nService' i 'webValidationService' en les propietats 'i18nService' i  'validationService' del tag, respectivament.</p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-Tagsavan%C3%A7ats"></a>Tags avançats</h2>

<p>Aquests tags hi són a partir de la versió 1.1.</p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-DirtyFormWarning"></a>Dirty Form  Warning</h3>

<p>El dirty form warning és una funcionalitat que permet a l'usuari avisar quan  es córrer el risc de perdre els canvis en un formulari.</p>

<p>Quan es clicka un link i produeix una descàrrega del formulari que té canvis,  surt un missatge d'avís de pèrdua de les dades. Llavors l'usuari pot decidir que  es procedeixi a la descàrrega del formulari per presentar una nova pàgina o  decidir aturar l'acció per no perdre les dades.</p>

<p>L'event que s'escolta per llençar l'avís és el onBeforeUnload suportat per  Internet Explorer 6 i FireFox 1.5.</p>

<p>El tag que dona aquesta funcionalitat és el dirtyFormWarning</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
canigo-dirtyFormWarning-tag.js</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Identificador per lligar amb  configuració XML </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del formulari que és vol escoltar  dels canvis. </td>
</tr>
<tr>
<td class='confluenceTd'> messageKey </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Clau internacionalitzada del  missatge </td>
</tr>
<tr>
<td class='confluenceTd'> Message </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Text del missatge a mostrar </td>
</tr>
</tbody></table>
<p>Exemple d'ús:</p>

<p>&lt;fwk: DirtyFormWarning source="actionForm" messageKey="errors.lostChanges"  /&gt;</p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-SearchPanel"></a>Search  Panel</h3>

<p>El panell de cerca és una utilitat que permet a l'usuari poder trobar el  valor adient d'un camp.<br/>
La cerca és fa mitjançant mostrant un panell amb un  camp per omplir dades a cercar i un botó per engegar la cerca. El resultat és  mostra sota del camp de text.</p>

<p>El panell de cerca permet mostrar de les dades que compleixen la condició més  dades relacionades. Per exemple si s'estan buscant cognoms de persones, el  panell de cerca permet mostrar a part del cognom, el nom, el càrrec que ocupa,  centre, etc per tal d'ajudar a l'usuari a escollir correctament i en cas de  repetició, poder discriminar.</p>

<p>Aquesta és la gran diferència amb l'autocomplete o els selects, que només  mostren un dada en concret.</p>

<p>Les cerques es poden fer tantes com es vulguin, però un cop es seleccioni una  dada, el panell s'amagarà. Si es torna a pitjar el botó de cercar, el panell de  cerca tornarà a aparèixer amb les dades de la última cerca.</p>

<p>El tag que ofereix aquesta funcionalitat és el searchPanel</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
canigo-ajaxtags-searchPanel.js</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Identificador per lligar amb  configuració XML </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del component gràfic que escolarà  l'event onClick per mostrar el panell. </td>
</tr>
<tr>
<td class='confluenceTd'> popupId </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Identificador del div que conté el  panell de cerca. </td>
</tr>
<tr>
<td class='confluenceTd'> target </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Camp de text que es copiarà el valor  seleccionat </td>
</tr>
<tr>
<td class='confluenceTd'> optionListName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Query que executa el panell. </td>
</tr>
<tr>
<td class='confluenceTd'> styleClass </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Estil CSS per aplicar al panell. </td>
</tr>
<tr>
<td class='confluenceTd'> indicator </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Identificador del div que es mostra  al fer la petició a servidor. </td>
</tr>
<tr>
<td class='confluenceTd'> tableProperties </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de les propietats del bean que  es volen mostrar en la cerca </td>
</tr>
<tr>
<td class='confluenceTd'> selectedProperty </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Propietat a copiar al target </td>
</tr>
<tr>
<td class='confluenceTd'> columnLabel </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Claus dels noms de les propietats  internacionalitzades </td>
</tr>
<tr>
<td class='confluenceTd'> method </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Nom del mètode que s'encarregarà de  fer la presentació, enlloc de fer la per defecte. </td>
</tr>
<tr>
<td class='confluenceTd'> queryParameter </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom del paràmetre de la query. </td>
</tr>
<tr>
<td class='confluenceTd'> services </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Parelles de nom servei:servei . nom  servei és l'atribut que conté el servei, i servei és el nom del servei en  spring. </td>
</tr>
</tbody></table>
<ul>
	<li>
	<ul>
		<li>popupId&#42;</li>
	</ul>
	</li>
</ul>


<p>Identificador del div que conté el panell de cerques. Va bé per poder definir  estils .</p>
<ul>
	<li>
	<ul>
		<li>optionsListName&#42;</li>
	</ul>
	</li>
</ul>


<p>Nom de la query a executar. Ha d'estar definida en  canigo-services-weblist.xml.</p>
<ul>
	<li>
	<ul>
		<li>queryParameter&#42;</li>
	</ul>
	</li>
</ul>


<p>Nom del paràmetre de la query que se li associarà el valor del camp entrat a  buscar.</p>
<ul>
	<li>
	<ul>
		<li>tableProperties&#42;</li>
	</ul>
	</li>
</ul>


<p>Llista de propietats del bean que retorna la query. Es permeten propietats  relacionades. Per exemple si la query retorna elements R i aquests tenen un  relació L que conté elements C, es pot posar L.id, que seria el id de l'element  C associat.</p>
<ul>
	<li>
	<ul>
		<li>selectedProperty&#42;</li>
	</ul>
	</li>
</ul>


<p>Nom de la propietat del bean que retorna la query que es vol copiar al camp  de text target.<br/>
Aquest propietat pot estar dins les tableProperties.</p>
<ul>
	<li>
	<ul>
		<li>columnLabel&#42;</li>
	</ul>
	</li>
</ul>


<p>Claus de multillenguatge pel nom de les columnes de la taula de resultats. El  nombre de columnLabels i de tableProperties ha de ser igual. En cas de no ser-ho  el searchPanel avisa del conflicte.</p>
<ul>
	<li>
	<ul>
		<li>method&#42;</li>
	</ul>
	</li>
</ul>


<p>Nom de mètode javascript que sap fer el pintat del resultats. Aquest  paràmetre permet a l'usuari canviar l'aspecte de la presentació de resultats.  Aquesta funció ha conèixer el format json que retorna servidor per poder  presentar les dades.</p>

<p>Exemple:canigo-services-web-list.xml
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean name=<span class="code-quote">"valueListHandler"</span>
class=<span class="code-quote">"net.mlw.vlh.DefaultValueListHandlerImpl"</span>&gt;
&lt;property name=<span class="code-quote">"config.adapters"</span>&gt;
&lt;map&gt;
&lt;entry key=<span class="code-quote">"accountList"</span>&gt;
&lt;bean parent=<span class="code-quote">"baseHibernateAdapter"</span>&gt;
&lt;property name=<span class="code-quote">"hql"</span>&gt;
&lt;value&gt;
FROM
net.gencat.ctti.canigo.samples.jpetstore.model.Account
AS vo WHERE 1=1
/~firstname: AND vo.firstname LIKE \{firstname\} ~/
/~lastname: AND vo.lastname LIKE \{lastname\} ~/
/sortColumn: ORDER BY vo.[sortColumn] [sortDirection]/
&lt;/value&gt;
&lt;/property&gt;
&lt;/bean&gt;
&lt;/entry&gt;
&lt;/map&gt;
&lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
JSP:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;input type=<span class="code-quote">"button"</span> value=<span class="code-quote">"search"</span> id=<span class="code-quote">"searchPanelButton"</span> /&gt;
&lt;fwk:searchPanel
styleId=<span class="code-quote">"searchPanel"</span>
source=<span class="code-quote">"searchPanelButton"</span>
target=<span class="code-quote">"city"</span>
popupId=<span class="code-quote">"searchPanelDiv"</span>
optionsListName=<span class="code-quote">"accountList"</span>
tableProperties=<span class="code-quote">"firstname,lastname,city"</span>
selectedProperty=<span class="code-quote">"city"</span>
columnLabels=<span class="code-quote">"name.label,lastname.label,city.label"</span>
indicator=<span class="code-quote">"indicator"</span>
queryParameter=<span class="code-quote">"firstname"</span> /&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Per fer servir el searchPanel s'han d'importar els següents scripts:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;!-- Search panel --&gt;
&lt;script
src=<span class="code-quote">"/canigo-samples-jPetstore/scripts/ajax/ajaxtags/canigo-ajaxtags-searchPanel.js"</span>

type=<span class="code-quote">"text/javascript"</span>&gt;
&lt;/script&gt;
&lt;script type='text/javascript'
src='/canigo-samples-jPetstore/AppJava/dwr/<span class="code-keyword">interface</span>/searchPanelService.js'&gt;&lt;/script&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image015.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Autocomplete"></a>Autocomplete</h3>

<p>L'autocomplete permet a l'usuari mostrar una llista de suggeriments pel valor  que ha escrit.<br/>
L'usuari clickant una de les opcions mostrades li evita  escriure i li corrobora que la dada és correcte.</p>

<p>En el framework aquesta funcionalitat s'obté amb el tag autocomplete. Aquest  autocomplete és importat de la llibreria ajaxtags 1.1 i s'ha adaptat perquè  cridi al servei de cerques del framework i mostri correctament el resultat.  Entre el servidor i client viatja una cadena json.</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
canigo-ajaxtags-autocomplete.js</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del component gràfic que escolarà  l'event onKeyUp per mostrar els suggeriments. </td>
</tr>
<tr>
<td class='confluenceTd'> target </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Camp de text que es copiarà el valor  seleccionat </td>
</tr>
<tr>
<td class='confluenceTd'> optionListName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Query que executa el panell. </td>
</tr>
<tr>
<td class='confluenceTd'> styleClass <br clear="all" /> </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Estil CSS per aplicar al panell. </td>
</tr>
<tr>
<td class='confluenceTd'> indicator </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Identificador del div que es mostra  al fer la petició a servidor. </td>
</tr>
<tr>
<td class='confluenceTd'> minimumCharacters </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nombre de caràcters mínims per  executar la query. </td>
</tr>
<tr>
<td class='confluenceTd'> errorFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció a cridar en cas d'error </td>
</tr>
<tr>
<td class='confluenceTd'> emptyFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció a cridar en cas de no haver  resultats </td>
</tr>
<tr>
<td class='confluenceTd'> postFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció a cridar després de rebre  dades. </td>
</tr>
</tbody></table>
<ul>
	<li>
	<ul>
		<li>source&#42;</li>
	</ul>
	</li>
</ul>


<p>Component gràfic que es vol escoltar els events de teclat per tal de mostrar  un autocomplete.</p>
<ul>
	<li>
	<ul>
		<li>target&#42;</li>
	</ul>
	</li>
</ul>


<p>Camp de text que es desitja copiar el valor seleccionat en l'autocomplete.  Normalment serà igual que el source.</p>
<ul>
	<li>
	<ul>
		<li>optionsListName&#42;</li>
	</ul>
	</li>
</ul>


<p>Consulta definida en canigo-services-web-options-list.xml</p>
<ul>
	<li>
	<ul>
		<li>minimumCharacters&#42;</li>
	</ul>
	</li>
</ul>


<p>Nombre de caràcters mínims en el camp de text origen per tal de disparar la  consulta.</p>
<ul>
	<li>
	<ul>
		<li>errorFunction&#42;</li>
	</ul>
	</li>
</ul>


<p>Funció a executar en cas d'error de dades o de comunicació.</p>
<ul>
	<li>
	<ul>
		<li>emptyFunction&#42;</li>
	</ul>
	</li>
</ul>


<p>Funció a executar en cas d'element buit.</p>
<ul>
	<li>
	<ul>
		<li>postFunction&#42;</li>
	</ul>
	</li>
</ul>


<p>Funció a executar després de presentar les dades.</p>

<p>Exemple:</p>

<p>canigo-services-web-options-list.xml
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean name=<span class="code-quote">"defaultOptionValueListHandler"</span>
class=<span class="code-quote">"net.mlw.vlh.DefaultValueListHandlerImpl"</span>&gt;
&lt;property name=<span class="code-quote">"config.adapters"</span>&gt;
&lt;map&gt;
&lt;entry key=<span class="code-quote">"animalsList"</span>&gt;
&lt;bean parent=<span class="code-quote">"defaultOptionBaseHibernateAdapter"</span>&gt;
&lt;property name=<span class="code-quote">"hql"</span>&gt;
&lt;value&gt;
FROM
net.gencat.ctti.canigo.samples.jpetstore.model.Product
AS vo WHERE 1=1
/~name: AND vo.name LIKE \{name\} ~/
/~category: AND vo.category.id LIKE \{category\} ~/
/sortColumn: ORDER BY vo.[sortColumn] [sortDirection]/
&lt;/value&gt;
&lt;/property&gt;
&lt;/bean&gt;
&lt;/entry&gt;
&lt;/map&gt;
&lt;/property&gt;
&lt;/bean&gt;

&lt;bean id=<span class="code-quote">"animalsOptionListSource"</span> parent=<span class="code-quote">"defaultOptionListSource"</span>&gt;
&lt;property name=<span class="code-quote">"optionListName"</span> value=<span class="code-quote">"animalsList"</span>/&gt;
&lt;property name=<span class="code-quote">"optionLabelName"</span> value=<span class="code-quote">"name"</span>/&gt;
&lt;property name=<span class="code-quote">"optionLabelProperty"</span> value=<span class="code-quote">"id"</span>/&gt;
&lt;/bean&gt;

&lt;bean id=<span class="code-quote">"optionsListService"</span> class="net.gencat.ctti.canigo.services.web.taglib.
util.options.OptionsListServiceBase"&gt;
&lt;property name=<span class="code-quote">"optionsListSources"</span>&gt;
&lt;map&gt;
&lt;entry key=<span class="code-quote">"animalsList"</span>&gt;&lt;ref bean=<span class="code-quote">"animalsOptionListSource"</span>/&gt;&lt;/entry&gt; &lt;/map&gt;
&lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
JSP:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text styleId=<span class="code-quote">"preferredProduct2.id"</span> styleClass=<span class="code-quote">"fieldtext"</span> property=<span class="code-quote">"preferredProduct2.id"</span> /&gt;

&lt;fwk:autocomplete
source=<span class="code-quote">"preferredProduct2.id"</span> target=<span class="code-quote">"preferredProduct2.id"</span>
parameters=<span class="code-quote">"preferredProduct2.id"</span> className=<span class="code-quote">"autocomplete"</span>
minimumCharacters=<span class="code-quote">"1"</span> indicator=<span class="code-quote">"indicator"</span>
optionsListName=<span class="code-quote">"animalsList"</span> /&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image016.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Botonsambimatges"></a>Botons amb  imatges</h3>

<p>El tag fwk:button permet definir botons amb el contingut que és vulgui, entre  d'altres per exemple amb taules, imatges, text, etc.</p>

<p>Aquest tag és basat amb l'element d'html button, que és nou en l'html  4.0.<br/>
La missió del tag és encapsular aquest element, oferint tots els serveis  que dona l'especificació.</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del botó </td>
</tr>
<tr>
<td class='confluenceTd'> styleClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> CSS del botó </td>
</tr>
<tr>
<td class='confluenceTd'> Tabindex </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Índex de tabulació </td>
</tr>
<tr>
<td class='confluenceTd'> Value </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Camp valor </td>
</tr>
<tr>
<td class='confluenceTd'> Title </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Títol del botó </td>
</tr>
<tr>
<td class='confluenceTd'> Lang </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> Dir </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> Disabled </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Si està deshabilitat o no </td>
</tr>
</tbody></table>
<p>Events:  onblur,onchange,onclick,ondbclick,onfocus,onkeydown,onkeypress,onkeyup,onmousedown,onmousemove,onmouseout, onmouseover,onmouseup</p>

<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:button styleId=<span class="code-quote">"desa"</span> type=<span class="code-quote">"submit"</span>&gt;

&lt;img src=<span class="code-quote">"&lt;c:url  value="</span>/images/save.jpg<span class="code-quote">"/&gt;"</span> /&gt;

&lt;fmt:message  key=<span class="code-quote">"jsp.includes.submit"</span> /&gt;

&lt;/fwk:button&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image017.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-TagSwapSelect"></a>Tag  Swap Select</h3>

<p>Aquest component ofereix un tag que permeten moure o copiar elements entre  dos selects múltiples. El seu ús es ben senzill.</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
canigo-options-tag.js</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del component gràfic que  escoltarà l'event onClick per fer l'acció configurada. </td>
</tr>
<tr>
<td class='confluenceTd'> action </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Acció, que pot ser MOVE o COPY </td>
</tr>
<tr>
<td class='confluenceTd'> scope </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Àmbit de l'acció. Pot ser ALL o  SELECTED. </td>
</tr>
<tr>
<td class='confluenceTd'> fromSelect </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Select origen </td>
</tr>
<tr>
<td class='confluenceTd'> toSelect </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Select destí. </td>
</tr>
</tbody></table>
<ul>
	<li><b>source</b></li>
</ul>


<p>Component gràfic que se li associa a l'event de onClick l'acció configurada.  Normalment serà un botó.</p>
<ul>
	<li><b>action</b></li>
</ul>


<p>La acció pot ser moure o copiar elements d'un select cap a un altre. Els  possibles valors són COPY o MOVE.</p>
<ul>
	<li><b>scope</b></li>
</ul>


<p>Dades del select origen. Poden ser les dades seleccionades o totes. Els dos  possibles valors són ALL o SELECTED</p>
<ul>
	<li><b>fromSelect</b></li>
</ul>


<p>Select origen de dades.</p>
<ul>
	<li><b>toSelect</b></li>
</ul>


<p>Select destí de dades.</p>

<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;!-- Selects --&gt;
&lt;fwk:select styleId=<span class="code-quote">"allAnimals"</span> property=<span class="code-quote">"allAnimals"</span> multiple=<span class="code-quote">"<span class="code-keyword">true</span>"</span> styleClass=<span class="code-quote">"multipleSelect"</span> /&gt;
&lt;fwk:select styleId=<span class="code-quote">"hateAnimals"</span> property=<span class="code-quote">"hateAnimals"</span> multiple=<span class="code-quote">"<span class="code-keyword">true</span>"</span>
styleClass=<span class="code-quote">"multipleSelect"</span> /&gt;

&lt;!-- Botons --&gt;
&lt;input type=<span class="code-quote">"button"</span> id=<span class="code-quote">"moveAllRight"</span> value=<span class="code-quote">"&gt;&gt;"</span> class=<span class="code-quote">"botonsswap"</span> /&gt;
&lt;input type=<span class="code-quote">"button"</span> id=<span class="code-quote">"moveRight"</span> value=<span class="code-quote">"&gt;"</span> class=<span class="code-quote">"botonsswap"</span> /&gt;
&lt;input type=<span class="code-quote">"button"</span> id=<span class="code-quote">"moveLeft"</span> value=<span class="code-quote">"&lt;"</span> class=<span class="code-quote">"botonsswap"</span> /&gt;
&lt;input type=<span class="code-quote">"button"</span> id=<span class="code-quote">"moveAllLeft"</span> value=<span class="code-quote">"&lt;&lt;"</span> class=<span class="code-quote">"botonsswap"</span> /&gt;

&lt;! -- decoradors de swap --&gt;
&lt;fwk:swapTag source=<span class="code-quote">"moveAllRight"</span> scope=<span class="code-quote">"ALL"</span> action=<span class="code-quote">"MOVE"</span> fromSelect=<span class="code-quote">"allAnimals"</span>
toSelect=<span class="code-quote">"hateAnimals"</span> /&gt;
&lt;fwk:swapTag source=<span class="code-quote">"moveRight"</span> scope=<span class="code-quote">"SELECTED"</span> action=<span class="code-quote">"MOVE"</span>
fromSelect=<span class="code-quote">"allAnimals"</span> toSelect=<span class="code-quote">"hateAnimals"</span> /&gt;
&lt;fwk:swapTag source=<span class="code-quote">"moveAllLeft"</span> scope=<span class="code-quote">"ALL"</span> action=<span class="code-quote">"MOVE"</span>
fromSelect=<span class="code-quote">"hateAnimals"</span> toSelect=<span class="code-quote">"allAnimals"</span> /&gt;
&lt;fwk:swapTag source=<span class="code-quote">"moveLeft"</span> scope=<span class="code-quote">"SELECTED"</span> action=<span class="code-quote">"MOVE"</span>
fromSelect=<span class="code-quote">"hateAnimals"</span> toSelect=<span class="code-quote">"allAnimals"</span> /&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
L'exemple és la construcció de dos selects, amb quatre botons que  permeten:
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ul class="alternate" type="square">
	<li>moveAllRight: mou totes les dades del select allAnimals al  hateAnimals.</li>
	<li>moveRight: mou les dades seleccionades del select allAnimals  al hateAnimals.</li>
	<li>moveAllLeft: mou totes les dades del select hateAnimals al  allAnimals.</li>
	<li>moveLeft: mou les dades seleccionades del select hateAnimals al  allAnimals.
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image018.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<h3><a name="Serveidepresentaci%C3%B3detags2.2-Pestanyes"></a>Pestanyes</h3></li>
</ul>


<p>Aquest component està compost per dos tags que permeten la construcció de  pestanyes (Tabs).</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
canigo-ajaxtags-tabs.js</p>

<p>Els tags són els següents:</p>

<h4><a name="Serveidepresentaci%C3%B3detags2.2-TabPanelTag"></a>TabPanelTag</h4>

<p>El tag TabPanelTag és el tag pare que s'encarrega de crear les pestanyes i  divs ocults, on es guardarà el contingut de les pàgines de les diferents  pestanyes. En el cos d'aquest tag és on definirem totes les pestanyes  (TabPageTag).</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> panelStyleId </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Id del panell que contindrà totes  les pestanyes. </td>
</tr>
<tr>
<td class='confluenceTd'> contentStyleId </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Part comú de l'id dels divs de les  pestanyes. </td>
</tr>
<tr>
<td class='confluenceTd'> currentStyleId </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Id de la pestanya seleccionada. </td>
</tr>
</tbody></table>
<ul>
	<li><b>panelStyleId</b></li>
</ul>


<p>Aquesta propietat defineix l'id del panell pare contenidor dels divs de les  pestanyes. Amb aquest id podrem canviar l'estil general dels tabs.</p>
<ul>
	<li><b>contentStyleId</b></li>
</ul>


<p>Part comú de l'id dels divs de les pestanyes. El tag pare crearà cada div amb  un id diferent. Aquest id es formarà amb la propietat 'contentStyleId' + '_tab'  + index. Aquest índex ve donat pel número de pestanya dins del tag pare  (TabPanelTag).<br/>
Si per exemple donem a 'contentStyleId' el valor 'content' i  definim 3 pestanyes, es crearan 3 divs amb els següents ids:</p>
<ul class="alternate" type="square">
	<li>content_tab0</li>
	<li>content_tab1</li>
	<li>content_tab2</li>
</ul>


<ul>
	<li><b>currentStyleId</b></li>
</ul>


<p>Aquesta propietat defineix l'id del la pestanya que està activa (la seleccionada). Amb aquest id podrem definir l'estil de la pestanya activa.</p>

<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:tabPanel panelStyleId=<span class="code-quote">"pestanas"</span>

contentStyleId=<span class="code-quote">"tabContent"</span>  currentStyleId=<span class="code-quote">"active"</span>&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h4><a name="Serveidepresentaci%C3%B3detags2.2-TabPageTag"></a>TabPageTag</h4>

<p>El tag TabPageTag defineix una pàgina de les pestanyes. Aquest tag no té  sentit si no es troba dins d'un tag TabPanelTag.<br/>
Les pestanyes poden ser, bàsicament, de dos tipus: client o servidor.<br/>
<b>&#45;</b> Les clients ja tenen  el contingut en els divs quan es carrega la pàgina.<br/>
<b>&#45;</b> Les servidor  tenen els divs buits, es carreguen mitjançant AJAX quan es selecciona <b>la pestanya</b>. Quan això succeeix, s'envia una petició al servidor i es carrega en  contingut del div mitjançant Javascript i XmlHttpRequest, sense necessitat de  recarregar la pàgina sencera.<br/>
En Internet Explorer, no es suporta que un  formulari contingui un altra formulari dins. Llavors si la pestanya servidor  conté un formulari i la plana actual ja en té un de general, donarà un  error.</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> linkStyleClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Classe de la pestanya (per aplicar  estils a la pestanya). </td>
</tr>
<tr>
<td class='confluenceTd'> isActive </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica si la pestanya és 'enabled' o  no (disabled); </td>
</tr>
<tr>
<td class='confluenceTd'> existingDivId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Id del div on es troba el contingut  de la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> caption </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Títol de la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> captionKey </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Clau que correspon al títol de la  pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> defaultTab </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica el tab actiu per defecte. </td>
</tr>
<tr>
<td class='confluenceTd'> imageCaption </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica la ruta de la imatge que  volem afegir a la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> imagePosition </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica posició de la imatge que  volem afegir a la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> baseUrl </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica la url on trobem el contingut  de la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> parameters </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Paràmetres de la url. </td>
</tr>
</tbody></table>
<ul>
	<li><b>isActive</b></li>
</ul>


<p>Si el valor es 'false', la pestanya quedarà desactivada (disabled) i no es  podrà seleccionar.</p>
<ul>
	<li><b>existingDivId</b></li>
</ul>


<p>Id del div on es troba el contingut de la pestanya. Això s'utilitza quan el  contingut de la pestanya no es vol posar dins del cos (body) del tag de la  pestanya (TabPageTag), sinó que es vol usar el contingut d'un altre div.</p>
<ul>
	<li><b>defaultTab</b></li>
</ul>


<p>Si el valor es 'true', la pestanya quedarà activada al carregar la pàgina.  Només es pot definir una pestanya com a 'defaultTab'.</p>
<ul>
	<li><b>imageCaption</b></li>
</ul>


<p>Afegeix una imatge a la pestanya. Indica la ruta de la imatge que volem  afegir. Per defecte posa la imatge a l'esquerra del títol(caption o captionKey)  de la pestanya.</p>
<ul>
	<li><b>imagePosition</b></li>
</ul>


<p>Indica la posició de la imatge. Els possibles valors són:<br/>
&#45;  left<br/>
&#45;   right<br/>
Per defecte és 'left'.</p>
<ul>
	<li><b>baseUrl</b></li>
</ul>


<p>Només per pestanyes carregades mitjançant servidor. Indica la url on trobem  el contingut de la pestanya. Aquesta url ha de retornar una jsp, que serà el  contingut.</p>

<p>Exemple pestanya client:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:tab captionKey=<span class="code-quote">"tabs.account.pestanya2"</span>styleClass=<span class="code-quote">"contingut_tab"</span> linkStyleClass=<span class="code-quote">"pestanya2"</span>
imageCaption=<span class="code-quote">"/canigo-samples-jPetstore/images/ast.gif"</span> imagePosition=<span class="code-quote">"right"</span>&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Exemple pestanya servidor:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:tab captionKey=<span class="code-quote">"tabs.account.server"</span> styleClass=<span class="code-quote">"contingut_tab"</span>
linkStyleClass=<span class="code-quote">"pestanya4"</span> baseUrl=<span class="code-quote">"accountList.<span class="code-keyword">do</span>?reqCode=addRowEditList"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Exemple complet:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:tabPanel panelStyleId=<span class="code-quote">"pestanas"</span>
    contentStyleId=<span class="code-quote">"tabContent"</span> currentStyleId=<span class="code-quote">"active"</span>&gt;
    &lt;fwk:tab captionKey=<span class="code-quote">"tabs.account.pestanya1"</span> defaultTab=<span class="code-quote">"<span class="code-keyword">true</span>"</span>
    styleClass=<span class="code-quote">"contingut_tab"</span> linkStyleClass=<span class="code-quote">"pestanya1"</span>
    imageCaption=<span class="code-quote">"/canigo-samples-jPetstore/images/asc.gif"</span>&gt;
    &lt;fwk:text styleId=<span class="code-quote">"firstname"</span> styleClass=<span class="code-quote">"fieldtext"</span>
    property=<span class="code-quote">"firstname"</span>&gt;
    &lt;/fwk:tab&gt;
    &lt;fwk:tab captionKey=<span class="code-quote">"tabs.account.pestanya2"</span>
    styleClass=<span class="code-quote">"contingut_tab"</span> linkStyleClass=<span class="code-quote">"pestanya2"</span> imageCaption="/
    canigo-samples-jPetstore/images/ast.gif"
    imagePosition=<span class="code-quote">"right"</span>&gt;
    &lt;fwk:text styleId=<span class="code-quote">"country"</span> property=<span class="code-quote">"country"</span>&gt;
    &lt;/fwk:tab&gt;
    &lt;fwk:tab captionKey=<span class="code-quote">"tabs.account.server"</span>
    styleClass=<span class="code-quote">"contingut_tab"</span> linkStyleClass=<span class="code-quote">"pestanya4"</span> baseUrl="accountList.<span class="code-keyword">do</span>?
    reqCode=addRowEditList"/&gt;
&lt;/fwk:tabPanel&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image019.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-GridBagLayout"></a>GridBagLayout</h3>

<p>El tag de GridBagLayout és un component que permet la creació de taules que  ofereixen un fàcil control de les propietats dels elements que continguin.  Mitjançant la definició d'aquest Tag podrem controlar les propietats de cada  cel&#45; la (TD) individualment o conjuntament (amb les propietats de cada línia &#45;TR&#45;  o de tota la taula &#45;TABLE-).</p>

<p>Per definir les propietats pròpies a la Taula, als TDs i als TRs, s'han de  definir el el tag les propietats pròpies de les Taules, dels TDs i dels TRs:</p>

<p>Les propietats referents al component taula es definiran amb el seu nom i el  prefix 'grid'. Així, si volem definir la propietat 'style' de la taula,  definirem la propietat gridStyle en el tag:</p>

<p>gridStyle="border:1px solid black;"</p>

<p>Les propietats referents als components de la taula (TD i TR) es definiran  amb el seu nom habitual. Per especificar a quina o quines cel&#45; les es vol aplicar  la propietat, es farà de la següent manera:</p>

<p>Si ens volem referir a una cel.la en concret, indicarem el número de fila i de columna que ocupa, separat pel caràcter ':'. Afegirem el valor de la  propietat després el caràcter '=':</p>

<p>style="2:1=border:1px solid black"</p>

<p>Així, segons aquest exemple, la cel.la de la fila 2 columna 1 tindrà l'estil 'border:1px solid black'.</p>

<p>Si volem definir una propietat per més d'una cel.la, ho farem separant les definicions amb el caràcter ',':</p>

<p>style="2:1=border:1px solid black,2:2=background-color:blue"</p>

<p>Si volem definir una propietat per tota una fila o tota una columna, ho farem  mitjançant el caràcter '*':</p>

<p>style="2:*=border:1px solid black "</p>

<p>En l'exemple anterior, l'estil definit s'aplicarà a tota la fila 2. En aquest  cas, però, s'aplicarà l'estil a totes les cel.les (TDs) de la fila, no a  l'element fila (TR). Si volem aplicar la propietat al TR, ho farem mitjançant  '**':</p>

<p>style="2:**=border:1px solid black"</p>

<p>En aquest cas, l'estil s'aplicarà al TR de la fila 2. Això només ho podrem  fer amb les files, ja que compten amb l'element TR. Per les columnes, només  podrem aplicar '*', i l'estil s'aplicarà a tots els TDs de la columna  individualment.</p>

<p>També podem definir alguna propietat per totes les cel.les de la taula  mitjançant '<b>:</b>':</p>

<p>style="<b>:</b>=background-color:blue"</p>

<p>En aquest exemple s'aplica l'estil a tots els TDs de la taula. Si volem  fer-ho amb tots els TRs, ho farem mitjançant '<b>:</b>&#42;':</p>

<p>style="<b>:</b>&#42;=background-color:blue"</p>

<p>La següent taula recull el diferents valors que hem definit per referir-nos a  les cel.les:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Valor</b> </th>
<th class='confluenceTh'> <b>Definició</b> </th>
</tr>
<tr>
<td class='confluenceTd'> 1:1 </td>
<td class='confluenceTd'> Fila 1 columna 1 </td>
</tr>
<tr>
<td class='confluenceTd'> &#42;:1 </td>
<td class='confluenceTd'> Tots els TDs de la columna 1 </td>
</tr>
<tr>
<td class='confluenceTd'> 1:&#42; </td>
<td class='confluenceTd'> Tots els TDs de la fila 1 </td>
</tr>
<tr>
<td class='confluenceTd'> 1:*&#42; </td>
<td class='confluenceTd'> TR de la fila 1 </td>
</tr>
<tr>
<td class='confluenceTd'> &#42;:&#42; </td>
<td class='confluenceTd'> Tots els TDs de la taula </td>
</tr>
<tr>
<td class='confluenceTd'> &#42;:*&#42; </td>
<td class='confluenceTd'> Tots els TRs de la taula </td>
</tr>
</tbody></table>
<p>A més de les propietats pròpies a les Taules,TDs i TRs s'han incorporat les  següents propietats:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> size </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Defineix el nombre de files i  columnes que tindrà el grid: <br clear="all" />
Exemple: <br clear="all" />
size="2,3" &#45;&gt;  Crearà 2 files i 3 columnes. </td>
</tr>
</tbody></table>
<p>El contingut de cada cel&#45; la del grid el definirem en el cos del Tag  GridBadLayout. Cada node que trobem serà el contingut de cada cel&#45; la, tenint en  compte l'ordre en que els anem trobant. Si volem que una cel&#45; la contingui més  d'un element, els haurem d'agrupar algun altre element (com, per exemple, un  'div' o un 'span'), ja que el tag parssejarà el seu contingut com si es tractés  d'un document XML, posant en cada cel&#45; la del grid el contingut de cada node de  primer nivell:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:gridBagLayout size=<span class="code-quote">"1,3"</span>
gridBorder=<span class="code-quote">"1"</span>
gridStyle=<span class="code-quote">"border:1px solid black;"</span>
colspan=<span class="code-quote">"1:1=2"</span>
rowspan=<span class="code-quote">"1:1=2"</span>&gt;

&lt;span&gt;&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"text1"</span> id=<span class="code-quote">"text1"</span> value=<span class="code-quote">"text1"</span>/&gt;&lt;/span&gt;
&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"gridText"</span> id=<span class="code-quote">"gridText"</span>/&gt;
&lt;span&gt;&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"gridT"</span> id=<span class="code-quote">"gridT"</span> value=<span class="code-quote">"gridT"</span>/&gt;&lt;/span&gt;

&lt;/fwk:gridBagLayout&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En l'exemple anterior, es crearà una taula amb una fila i 3 columnes. En la  primera cel&#45; la hi posarà el contingut del primer node del cos del tag:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;span&gt;&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"text1"</span> id=<span class="code-quote">"text1"</span>  value=<span class="code-quote">"text1"</span>/&gt;&lt;/span&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En la segona hi posarà el segon node:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"gridText"</span> id=<span class="code-quote">"gridText"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
I, finalment, en la tercera, hi posarà el tercer i últim node:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;span&gt;&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"gridT"</span> id=<span class="code-quote">"gridT"</span>  value=<span class="code-quote">"gridT"</span>/&gt;&lt;/span&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
&#45;  Errors de construcció del grid
<br clear="all" />
<br clear="all" />
Si en el contingut del tag hi tenim més elements que cel.les hem definit en  l'atribut 'size', el tag llançarà una excepció. Si, en canvi, hi ha més cel.les  que elements, el tag crearà les cel.les restants buides.<br/>
El tag suporta també les propietats 'colspan' i 'rowspan'. Aquestes  propietats es defineixen quan una cel.la ha d'ocupar més una fila o d'una columna. Amb aquestes propietats es poden definir incongruències. En aquests  casos, el tag llançarà excepcions. Aquestes incongruències poden ser:
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<p><b>&#45;</b> Definir una propietat fora de límits:<br/>
Això succeeix quan definim  una propietat 'colspan' o 'rowspan' amb un valor que està fora dels límits del  grid:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:gridBagLayout size=<span class="code-quote">"1,3"</span> colspan=<span class="code-quote">"1:3=2"</span>&gt;

...</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En l'exemple anterior, definim la propietat 'colspan' de la tercera i última  columna cel.la del grid amb valor 2. Això només podria ser si el grid tingués 4 columnes. Així, el tag llançarà una excepció indicant el motiu de l'error.
<br clear="all" />
<br clear="all" />
<br clear="all" />
&#45; Definir una propietat d'una cel.la que està solapada per la propietat  'colspan' o 'rowspan' d'una altra cel.la:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:gridBagLayout size=<span class="code-quote">"1,3"</span> colspan=<span class="code-quote">"1:1=2"</span>

style=<span class="code-quote">"1:2=border:1px  solid black"</span>&gt;

...</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En l'exemple anterior definim la propietat 'style' de la cel.la 1:2, però  aquesta cel.la està solapada per la propietat 'colspan' de la cel.la 1:1. Així, el tag llançarà una excepció indicant l'error.
<br clear="all" />
<br clear="all" />
<br clear="all" />  <b>&#45;  Exemple complet de GridBagLayout</b>
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:gridBagLayout size=<span class="code-quote">"3,3"</span>
gridBorder=<span class="code-quote">"1"</span>
gridStyle=<span class="code-quote">"border:1px solid black;"</span>
colspan=<span class="code-quote">"1:1=2"</span>
rowspan=<span class="code-quote">"1:1=2"</span>
style=<span class="code-quote">":=border:1px solid black;,*:0=background-color:blue"</span>
onmouseover=<span class="code-quote">":*=<span class="code-keyword">this</span>.className='selected';"</span>
onmouseout=<span class="code-quote">":*=<span class="code-keyword">this</span>.className='zebra0';"</span>&gt;

&lt;span&gt;&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"span1"</span> id=<span class="code-quote">"span1"</span> value=<span class="code-quote">"span1"</span>/&gt;&lt;/span&gt;
&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"gridText"</span> id=<span class="code-quote">"gridText"</span>/&gt;
&lt;span&gt;&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"gridT"</span> id=<span class="code-quote">"gridT"</span> value=<span class="code-quote">" gridT "</span>/&gt;&lt;/span&gt;

&lt;span&gt;&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"span2"</span> id=<span class="code-quote">"span2"</span> value=<span class="code-quote">"span2"</span>/&gt;&lt;/span&gt;
&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"gridText"</span> id=<span class="code-quote">"gridText"</span> value=<span class="code-quote">"gridText"</span>/&gt;
&lt;span&gt;&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"gridT"</span> id=<span class="code-quote">"gridT"</span> value=<span class="code-quote">"gridT"</span>/&gt;&lt;/span&gt;

&lt;/fwk:gridBagLayout&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Paginaci%C3%B3deselects"></a>Paginació de  selects</h3>

<p>El pagedSelect permet a l'usuari mostrar una llista paginada de suggeriments  pel valor que ha escrit. Aquest només mostra un camp en concret, que és el que  és copia al camp de text.<br/>
L'usuari clickant una de les opcions mostrades li  evita escriure i li corrobora que la dada és correcte.</p>

<p>És molt útil per mostrar llistes suggeriments de molts elements, ja que té la  paginació.</p>

<p>Aquest pagedSelect és importat de la llibreria ajaxtags 1.1 i s'ha adaptat  perquè cridi al servei de cerques del framework i mostri correctament el  resultat. Entre el servidor i client viatja una cadena json.</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
ajaxtags-canigo-pagedSelect.js</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del component gràfic. </td>
</tr>
<tr>
<td class='confluenceTd'> selectedKey </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Camp de la query que serà la clau de  la option </td>
</tr>
<tr>
<td class='confluenceTd'> selectedValue </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Camp de la query que serà el valor  de la option </td>
</tr>
<tr>
<td class='confluenceTd'> property </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom del component. </td>
</tr>
<tr>
<td class='confluenceTd'> dependentFields </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Camps amb el valor dels  queryParameters </td>
</tr>
<tr>
<td class='confluenceTd'> queryParameters </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Paràmetres de la query </td>
</tr>
<tr>
<td class='confluenceTd'> optionsListName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la query </td>
</tr>
</tbody></table>
<ul>
	<li><b>styleId</b></li>
</ul>


<p>Id del component gràfic. Serveix per poder aplicar estils al component i poder-lo configurar a partir d'un xml (action-servlet-xxx.xml).</p>
<ul>
	<li><b>selectedKey</b></li>
</ul>


<p>Camp de la query que serà la clau de la option</p>
<ul>
	<li><b>selectedValue</b></li>
</ul>


<p>Camp de la query que serà el valor de la option</p>
<ul>
	<li><b>property</b></li>
</ul>


<p>Nom del component.</p>
<ul>
	<li><b>dependentFields</b></li>
</ul>


<p>Valor que tindran els paràmetres<br/>
Aquest camp contindrà tots els valors  dels paràmetres de la query (queryParameters) separats per comes.</p>
<ul>
	<li><b>queryParameters</b></li>
</ul>


<p>Nom dels paràmetres dins la query. En la query es fa referència a aquests  noms mitjançant la nomenclatura:</p>

<p>/~nomParametre: ... &#126;/</p>

<p>Aquest camp contindrà tots els paràmetres de la query separats per comes.</p>
<ul>
	<li>
	<ul>
		<li>optionsListName&#42;</li>
	</ul>
	</li>
</ul>


<p>Nom de la query. Aquesta query estarà definida dins de "canigo-services-web  &#45;list.xml".</p>

<p>Exemple:</p>

<p>canigo-services-web-list.xml
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean name=<span class="code-quote">"valueListHandler"</span>
class=<span class="code-quote">"net.mlw.vlh.DefaultValueListHandlerImpl"</span>&gt;
&lt;property name=<span class="code-quote">"config.adapters"</span>&gt;
&lt;map&gt;
&lt;entry key=<span class="code-quote">"categoriesList"</span>&gt;
&lt;bean parent=<span class="code-quote">"baseHibernateAdapter"</span>&gt;
&lt;property name=<span class="code-quote">"hql"</span>&gt;
&lt;value&gt;
FROM
net.gencat.ctti.canigo.samples.jpetstore.model.Category AS vo

WHERE 1=1
/~descn: AND vo.descn LIKE \{descn\} ~/
/sortColumn: ORDER BY vo.[sortColumn] [sortDirection]/
&lt;/value&gt;
&lt;/property&gt;
&lt;/bean&gt;
&lt;/entry&gt;
&lt;/map&gt;
&lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
JSP:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"depValue"</span> value=<span class="code-quote">"Birds"</span>/&gt;

&lt;fwk: PagedSelect
styleId=<span class="code-quote">"preferredCategory.id"</span>
selectedKey=<span class="code-quote">"id"</span>
selectedValue=<span class="code-quote">"name"</span>
property=<span class="code-quote">"preferredCategory.id"</span>
dependentFields=<span class="code-quote">"depValue"</span>
queryParameters=<span class="code-quote">"descn"</span>
optionsListName=<span class="code-quote">"categoriesList"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Exemple amb un sol resultat:
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image020.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
Exemple amb varis resultats (amb paginació):<br/>
<img src="Servei de presentació de tags 2.2_attachments/image021.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Formatilimitaci%C3%B3d%27entradadedades"></a>Format  i limitació d'entrada de dades</h3>

<p>Aquest component permet controlar el format i la limitació de l'entrada de  dades d'un camp d'un formulari. Aquest component el podem utilitzar de dues  maneres: mitjançant un decorador (<b>fwk:formatKeyStroke</b>) o directament en  la configuració del tag text del Framework (<b>fwk:text</b>).</p>

<p>És molt habitual el seu ús en números de telèfon, targetes de crèdit, dates,  etc.</p>

<p>Dependències:</p>

<p>masks.js</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> mask </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Màscara que es vol aplicar a un camp  d'un formulari. </td>
</tr>
<tr>
<td class='confluenceTd'> maskType </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Tipus de màscara que es vol aplicar:  text, date, number </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> &#42; </td>
<td class='confluenceTd'> Nom del component. </td>
</tr>
</tbody></table>
<ul>
	<li><b>mask</b></li>
</ul>


<p>Màscara que volem aplicar a un camp d'un formulari. Depenent del tipus de  màscara seguirem un patró o un altre.</p>
<ul>
	<li><b>maskType</b></li>
</ul>


<p>Tipus de màscara. Pot ser de 3 tipus:</p>

<p>&#45;  Text: màscara de text.<br/>
Amb aquest tipus de màscara podem aplicar els  següents patrons:</p>

<p>x: lletra [a-z].<br/>
X: lletra [A-Z].<br/>
&#35;: número [0-9].<br/>
&#42;: lletra o  número [a-z][A-Z][0-9].</p>

<p>Qualsevol altre caràcter que aparegui a la màscara s'escriurà automàticament.</p>

<p>Exemple:</p>

<p>xxxx## &#45;&gt; hola22<br/>
(###) #x*-#### &#45;&gt; (614) 7a7-6094<br/>
telf (##)  ###.##.## &#45;&gt; telf (93) 311.34.89</p>

<p>&#45;  Date: màscara de data.<br/>
Amb aquest tipus de màscara podem aplicar els  següents patrons:</p>

<p>d: dia [0-9].<br/>
m: mes [0-9].<br/>
y: any [0-9].</p>

<p>Exemples:</p>

<p>dd/mm/yyyy &#45;&gt; 24/05/1980<br/>
m/dd/yyyy &#45;&gt; 2/05/1980<br/>
yyyy.mm.dd &#45;&gt;  1972.02.28</p>

<p>&#45;  Number: màscara numèrica.</p>

<p>$: indica la moneda (apareix automàticament).<br/>
&#35;: número [0-9].<br/>
0:  número 0. S'utilitza pels decimals (apareix automàticament).<br/>
&#43;: Iindicador  número positiu (apareix automàticament).<br/>
&#45;: Iindicador número negatiu  (apareix automàticament).<br/>
,: Separador dels milers, milions, etc.. (apareix  automàticament).<br/>
.: Indica on comencen els decimals.<br/>
(: principi  parèntesis (apareix automàticament).<br/>
): fi parèntesis (apareix  automàticament).</p>

<p>Exemples:</p>

<p>0#####.## &#45;&gt; 000534.23<br/>
&#43;##,###.## &#45;&gt; &#43;534.23<br/>
(-#,###.##) &#45;&gt;  (-534.23)</p>

<p>&#42; Per defecte el tipus de màscara és "text".</p>
<ul>
	<li><b>source</b></li>
</ul>


<p>Id del camp al qual volem aplicar la màscara. Només aplicable al decorador  formatKeyStroke, ja que en el tag Text el camp al qual es vol aplicar la màscara  és ell mateix.</p>

<p>Exemple amb decorador (fwk:formatKeyStroke):
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text

styleId=<span class="code-quote">"firstname"</span>

property=<span class="code-quote">"firstname"</span>/&gt;

&lt;fwk:formatKeyStroke

source=<span class="code-quote">"firstname"</span>

mask=<span class="code-quote">"xxxx##"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Exemple sense decorador (fwk:text):
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text

styleId=<span class="code-quote">"firstname"</span>

property=<span class="code-quote">"firstname"</span>

mask=<span class="code-quote">"xxxx##"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-Llistatseditables"></a>Llistats editables</h2>

<p>Els llistats editables es basen en el suport de les propietats indexades. Per  poder donar aquest suport s'han construït un seguit de tags per tal que es pugui  fer un gestió correcte d'aquesta informació.</p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Introducci%C3%B3"></a>Introducció</h3>

<p><br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">Una propietat indexada és:

&lt;fwk:text styleId=<span class="code-quote">"city"</span>  property=<span class="code-quote">"direccions[0].ciutat"</span> /&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Aquest camp mostra de la llista de direccions del bean pare, la ciutat de la  primera direcció.
<br clear="all" />
<br clear="all" />
En la versió 1.0 canigo sap renderitzar aquesta propietat, però no sap  construir aquesta llista de direccions en la baixada del submit dins el bean  pare.<br/>
El problema principal que hi ha per construir la col.lecció de direccions, és  que ningú coneix quins objectes ha de tenir dins. Per poder informar a canigo  d'aquesta tasca s'ha construït un tag anomenat <b>DefinePropertyTag</b>. Tota  llista del bean que és vol materialitzar en la baixa és necessari que estigui  definida amb aquest tag.<br/>
Les col.leccions editables poden provenir de moltes fonts.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<p>Un cas típic es que en el load del bean del formulari es carreguin també  seves col.leccions per després mostrar en pantalla.</p>

<p>Un altra cas seria aquell on les col.leccions tenen molts elements. Aquí és  molt aconsellable fer servir la ValueList ja que dona suport a la paginació, i  navegació entre pàgines de manera amigable. La gran diferència amb el model  primer, es que aquesta llista es carrega mitjançant una query definida en  canigo-web-lists.xml. Per tal que els tags de propietats indexades es  renderitzin correctament, s'ha de enganxar-li al bean del formulari la  col.lecció que ha vingut de la valueList. Aquest enganxament es pot fer amb el <b>SetListTag</b>, on se li ha d'indicar quina és la propietat indexada del bean  del form, i on és la llista ha afegir.</p>

<p>El suport a llistats editables també ofereix el poder afegir, seleccionar i  esborrar elements d'un llistat. Aquests pressuposen que el llistat està  contingut dins una table de HTML.</p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-SetListTag"></a>SetListTag</h3>

<p>El tag SetListTag és un component que permet omplir els elements d'una llista  del Bean d'un formulari amb els d'una llista que tenim guardada en qualsevol  scope de la pàgina. Per exemple, si les dades provenen d'una valuelist, haurem  d'omplir la llista del Form Bean amb la propietat 'list' de l'scope 'page':
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:setList listProperty=<span class="code-quote">"accounts"</span> scopeKey=<span class="code-quote">"list"</span> scope=<span class="code-quote">"page"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Aquest exemple mostra com agafar la llista provinent de la ValueList i  l'afegeix a la propietat accounts del bean del formulari.
<br clear="all" />
<br clear="all" />
Les propietats d'aquest tag són les següents:
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> listProperty </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la llista en el Form Bean. </td>
</tr>
<tr>
<td class='confluenceTd'> scopeKey </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Clau que té la llista en l'scope  seleccionat. </td>
</tr>
<tr>
<td class='confluenceTd'> scope </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Scope on es troba la llista amb la  clau definida a 'scopeKey'. </td>
</tr>
</tbody></table>
<ul>
	<li><b>listProperty</b></li>
</ul>


<p>Nom de la propietat indexada en el bean del formulari.</p>
<ul>
	<li><b>scopeKey</b></li>
</ul>


<p>Nom de la clau que conté la llista a afegir al bean del formulari.</p>
<ul>
	<li><b>scope</b></li>
</ul>


<p>Aquesta propietat només accepta 3 possibles valors:<br/>
&#45;  page<br/>
&#45;  request<br/>
&#45;  session</p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-DefinePropertyTag"></a>DefinePropertyTag</h3>

<p>El tag DefinePropertyTag serveix per informar a canigo quins tipus de classe  conté la col.lecció definir la classe que tenen els objectes continguts en la  llista del Form Bean. Això es fa per poder fer el 'binding' dels nous objectes  que es creïn a l'editar el llistat amb el Form Bean.</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> listProperty </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la llista del bean del  formulari. </td>
</tr>
<tr>
<td class='confluenceTd'> itemsClass </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Classe dels objectes continguts en  la llista del bena del formulari. </td>
</tr>
</tbody></table>
<p><br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk: DefineProperty listProperty=<span class="code-quote">"accounts"</span>  itemsClass="net.gencat.ctti.canigo.samples.
jpetstore.model.Account"/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Aquest tag crearà dos inputs ocults amb el següent format:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;input type=<span class="code-quote">"hidden"</span> name=<span class="code-quote">"Metadata.nom_llista. itemsClass"</span>  value=<span class="code-quote">"classe_items_llista"</span>/&gt;

&lt;input type=<span class="code-quote">"hidden"</span>  name=<span class="code-quote">"Metadata.nom_llista. lastIndex"</span> value=<span class="code-quote">"tamany_llista"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;input type=<span class="code-quote">"hidden"</span> name=<span class="code-quote">"_Metadata.accounts.itemsClass_"</span>  value=<span class="code-quote">"net.canigo.samples.model.Account"</span>/&gt;

&lt;input type=<span class="code-quote">"hidden"</span>  name=<span class="code-quote">"_Metadata.accounts.lastIndex_"</span> value=<span class="code-quote">"2"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-SelectionTag"></a>SelectionTag</h3>

<p>El tag SelectionTag serveix per seleccionar i deseleccionar tots els elements  d'un llistat editable.</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> listName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la llista en el Form Bean. </td>
</tr>
<tr>
<td class='confluenceTd'> selectionProperty </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la propietat de selecció. </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de l'element disparador de  l'event. </td>
</tr>
<tr>
<td class='confluenceTd'> target </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Id de la taula que conté el llista  editable </td>
</tr>
<tr>
<td class='confluenceTd'> action </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Acció de selecció o deselecció. </td>
</tr>
</tbody></table>
<ul>
	<li><b>selectionProperty</b></li>
</ul>


<p>Aquesta propietat defineix el camp del Form Bean que indicarà si el registre  al qual pertany està seleccionat. El camp ha de ser un valor booleà i es  representarà amb un element 'checkbox'.</p>
<ul>
	<li><b>source</b></li>
</ul>


<p>Aquesta propietat defineix l'id de l'element al qual s'hi s'assignarà l'event  'onclick' que dispararà la funció de seleccionar o deseleccionar tots els  'checkbox' de la taula.</p>
<ul>
	<li><b>target</b></li>
</ul>


<p>Els llistats editables es faràn sobre taules. La taula que contingui els  registres haurà de tenir un id. Aquest id és el que hem d'indicar en la  propietat 'target'.</p>
<ul>
	<li><b>selectionProperty</b></li>
</ul>


<p>Acció que s'ha d'executar. Els possibles valors són:<br/>
&#45;  selectAll  (seleccionar tots els registres)<br/>
&#45;  unselectAll (deseleccionar tots els  registres)</p>

<p>Un exemple de la seva utilització podria ésser el següent:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:selection source=<span class="code-quote">"selectionButton"</span> target=<span class="code-quote">"taulaId"</span>  listName=<span class="code-quote">"accounts"</span>
selectionProperty=<span class="code-quote">"selected"</span> action=<span class="code-quote">"selectAll"</span>/&gt;

&lt;fwk:selection source=<span class="code-quote">"unselectionButton"</span> target=<span class="code-quote">"taulaId"</span>  listName=<span class="code-quote">"accounts"</span>
selectionProperty=<span class="code-quote">"selected"</span> action=<span class="code-quote">"unselectAll"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En l'exemple anterior s'assigna a 2 botons (selectionButton i  unselectionButton) les funcions de seleccionar i deseleccionar tots els  registres de la taula (amb id 'taulaId') respectivament.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-DeleteRowsTag"></a>DeleteRowsTag</h3>

<p>El tag DeleteRowsTag serveix per eliminar els elements seleccionats d'un  llistat editable.</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> listName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la llista en el Form Bean. </td>
</tr>
<tr>
<td class='confluenceTd'> selectionProperty </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la propietat de selecció. </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de l'element disparador de  l'event. </td>
</tr>
<tr>
<td class='confluenceTd'> target </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Id de la taula que conté el llista  editable. </td>
</tr>
</tbody></table>
<ul>
	<li><b>selectionProperty</b></li>
</ul>


<p>Aquesta propietat defineix el camp del Form Bean que indicarà si el registre  al qual pertany està seleccionat. El camp ha de ser un valor booleà i es  representarà amb un element 'checkbox'. Tots els 'checkbox' seleccionats  indicaran els registres a esborrar.</p>
<ul>
	<li><b>source</b></li>
</ul>


<p>Aquesta propietat defineix l'id de l'element al qual s'hi s'assignarà l'event  'onclick' que dispararà la funció de esborrar tots els registres  seleccionats.</p>
<ul>
	<li><b>target</b></li>
</ul>


<p>Id de la taula on s'esborraran els registres.</p>

<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk: Deleterows source=<span class="code-quote">"deleteRowsButton"</span> target=<span class="code-quote">"taulaId"</span>  listName=<span class="code-quote">"accounts"</span>
selectionProperty=<span class="code-quote">"selected"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En l'exemple anterior s'assigna al botó amb id 'deleteRowsButton' la funció  d'eliminar tots els registres seleccionats de la taula.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-AddRowTag"></a>AddRowTag</h3>

<p>El tag AddRowTag serveix per afegir nous registres a un llistat editable.</p>

<p>Funcionament</p>

<p>Aquest fa una única petició a servidor d'obtenir la plantilla de fila nova.  En aquesta es podran posar en els camps el valors per defecte de cada camp.</p>

<p>Aquesta petició es fa amb el reqCode addRowEditList. Si l'action hereta del  DispatchActionSuport en té un de genèric. Aquest construeix el bean pare buit  amb la col.lecció indexada amb un element buit, i llavors fa el forward indicat  per a que es construeixi la plantilla de fila nova. Aquest mètode es pot  redefinit per tal que es creï un element dins la col.lecció amb els valors per  defecte desitjats.</p>

<p>La plantilla de fila nova té unes característiques especials.</p>

<p>Les propietats indexades han de fer referència a l'element 0 de la  col.lecció. Això és causa ja que canigo abans de renderitzar la plana omple la  col.lecció amb un bean buit. Si és fes referència a un element superior a 0 en  la plantilla sortirà una excepció.</p>

<p>La variable {rowIndex} es reemplaça just en el pintat per la posició que  ocupar en la llista indexada del bean. És molt útil per poder fer referència a  component dins la mateixa fila, com és el cas de les validacions.</p>

<p>Per tal que els components caixes de text es pintin és necessita que estiguin  dins un formulari. I aquest tingui dins un table amb un tr, que és el que es  pintarà com a plantilla de fila nova.</p>

<p>Per tal que les validacions obligatòries de submit funcionin, es necessita  que aquest formulari tingui el mateix identificador intern que el que conté el  llistat editable. Per fer això s'ha d'afegir al formulari de la plantilla nova  el següent:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">generateId=<span class="code-quote">"&lt;%=request.getParameter("</span>formIdent<span class="code-quote">")%&gt;"</span></pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<p>Un cop el navegador té la plantilla de fila nova del servidor, a cada petició  d'afegir fila nova el que fa és copia aquesta plantilla i li reemplaça la  propietat indexada amb el valor 0 pel que li correspon en aquell moment en el  llistat editable.
<br clear="all" />
<br clear="all" />
Propietats del tag<br/>
Les propietats d'aquest tag són les següents:
<br clear="all" />
<br clear="all" /></p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> listName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la llista en el Form Bean. </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de l'element disparador de  l'event. </td>
</tr>
<tr>
<td class='confluenceTd'> target </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Id de la taula que conté el llista  editable. </td>
</tr>
<tr>
<td class='confluenceTd'> insertInRow </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Posició dins la taula en la qual  volem afegir els nous registres. </td>
</tr>
<tr>
<td class='confluenceTd'> startIndex </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Índex a partir del qual afegirem  nous registres en la llista. </td>
</tr>
<tr>
<td class='confluenceTd'> url </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Url on es troba l'action que  retornarà la jsp que conté la plantilla del TR a afegir. </td>
</tr>
<tr>
<td class='confluenceTd'> reqCode </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Nom de la funció dins l'Action  indicada en la propietat 'url'. </td>
</tr>
<tr>
<td class='confluenceTd'> parameters </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Paràmetres addicionals per afegir a  la url. </td>
</tr>
<tr>
<td class='confluenceTd'> forward </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom del forward que s'executarà en  la funció de la Action. </td>
</tr>
</tbody></table>
<ul>
	<li><b>source</b></li>
</ul>


<p>Aquesta propietat defineix l'id de l'element al qual s'assignarà l'event 'onclick' que dispararà la funció d'afegir un nou registre.</p>
<ul>
	<li><b>target</b></li>
</ul>


<p>Id de la taula on es crearan els nous registres.</p>
<ul>
	<li><b>insertInRow</b></li>
</ul>


<p>Posició gràfica de la taula on afegirem les noves plantilles. Els possibles valors poden ser:<br/>
&#45;  first<br/>
&#45;  second<br/>
&#45;  third<br/>
&#45;  last<br/>
&#45;   penultimate<br/>
&#45;  qualsevol nombre enter, tenint en compte que 0 és la primera  posició i que les nombres negatius són el número de fila començant pel final de  la taula. Així, si la propietat val &#45;1, s'afegiran els nous registres a la  penúltima posició de la taula, si val &#45;2, l'avantpenúltima, etc..</p>
<ul>
	<li><b>startIndex</b></li>
</ul>


<p>Índex de la propietat indexada a partir del qual s'aniran renombrant les  noves files. Lo més habitual és que l'startIndex sigui el nombre d'elements de  lllista. Com que normalment no es sap s'ha d'emprar un variable que faci de  comptador dins el jsp.</p>
<ul>
	<li><b>url</b></li>
</ul>


<p>Els nous registres(o TRs) que s'han d'afegir a la taula es crearan a partir  una plantilla. Aquesta plantilla serà una jsp on les propietats indexades sempre  tindran index 0. El tag ja s'encarregarà de substituir el 0 per l'índex  apropiat. La propietat 'url' indica la Action on es troba aquesta jsp, que  contindrà una taula amb el TR que vulguem definir i que haurà de tenir la  mateixa estructura que tots els altres registres (o <ins>TRs</ins>) de la  taula.<br/>
Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;table&gt;
    &lt;tr onmouseover=<span class="code-quote">"<span class="code-keyword">this</span>.className='selected';"</span> onmouseout=<span class="code-quote">"<span class="code-keyword">this</span>.className='zebra0';"</span>&gt;
        &lt;td&gt;
            &lt;input type=<span class="code-quote">"checkbox"</span> name=<span class="code-quote">"accounts[0].selected"</span>/&gt;
        &lt;/td&gt;
        &lt;td&gt;
            &lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"accounts[0].lastname"</span>/&gt;
        &lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<p>En l'exemple anterior definim una taula que conté la plantilla dels nous  registres. Si en el tag hem informat la propietat 'startIndex' amb el valor 2,  en afegir un nou registre el tag substituirà 'accounts[0]' per 'accounts[2]'; si  n'afegim un altre, ho farà per 'accounts[3]', etc..
<br clear="all" /></p>

<p><br clear="all" /></p>
<ul>
	<li><b>reqCode</b></li>
</ul>


<p>Nom de la funció dins la Action definida en 'url' que gestionarà l'enviament  de la plantilla jsp.</p>
<ul>
	<li><b>forward</b></li>
</ul>


<p>Nom del forward que envia la plantilla jsp. Aquesta jsp ha de ser la jsp que representi a la nova fila.</p>

<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:addRow url=<span class="code-quote">"/canigo-samples-jPetstore/AppJava/accounts.<span class="code-keyword">do</span>"</span>

target=<span class="code-quote">"taulaId"</span>

source=<span class="code-quote">"triggerButton"</span>

listName=<span class="code-quote">"accounts"</span>

startIndex=<span class="code-quote">"$\{count\}"</span>

insertInRow=<span class="code-quote">"penultimate"</span>

reqCode=<span class="code-quote">"addRowEditList"</span>

forward=<span class="code-quote">"addRow"</span> /&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<p>En l'exemple anterior s'assigna al botó amb id 'triggerButton' la funció  d'afegir els nous registres de la taula.
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image022.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
Exemple complet de llistat editable amb valuelist:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;%@ include file=<span class="code-quote">"/WEB-INF/jsp/includes/fwkTagLibs.jsp"</span> %&gt;
 &lt;br&gt;
&lt;script src=<span class="code-quote">"/canigo-samples-jPetstore/scripts/ajax/ajaxtags/canigo-ajaxtags-editList.js"</span> type=<span class="code-quote">"text/javascript"</span>&gt;&lt;/script&gt;
&lt;script src=<span class="code-quote">"/canigo-samples-jPetstore/scripts/ajax/json/json.js"</span>  type=<span class="code-quote">"text/javascript"</span>&gt;&lt;/script&gt;

&lt;c:set <span class="code-keyword">var</span>=<span class="code-quote">"count"</span> value=<span class="code-quote">"0"</span>/&gt;

&lt;fwk:vlhroot value=<span class="code-quote">"list"</span> url=<span class="code-quote">"accounts.<span class="code-keyword">do</span>?"</span> includeParameters=<span class="code-quote">"reqCode"</span> configName=<span class="code-quote">"vlConfig"</span>&gt;
   &lt;fwk:form styleId=<span class="code-quote">"actionForm"</span> action=<span class="code-quote">"accounts.<span class="code-keyword">do</span>"</span> reqCode=<span class="code-quote">"search"</span>&gt;
      &lt;fwk:setList listProperty=<span class="code-quote">"accounts"</span> scopeKey=<span class="code-quote">"list"</span> scope=<span class="code-quote">"page"</span>/&gt;
      &lt;fwk: DefineProperty listProperty=<span class="code-quote">"accounts"</span> itemsClass=<span class="code-quote">"net.gencat.ctti.canigo.samples.jpetstore.model.Account"</span>/&gt;

      &lt;table width=<span class="code-quote">"450"</span> align=<span class="code-quote">"center"</span> border=<span class="code-quote">"0"</span>&gt;
         &lt;!-- pagination section --&gt;
         &lt;tr&gt;
            &lt;td align=<span class="code-quote">"left"</span> nowrap=<span class="code-quote">"<span class="code-keyword">true</span>"</span>&gt;&lt;c:out
            value=<span class="code-quote">"$\{list.valueListInfo.totalNumberOfEntries\}"</span> /&gt; &lt;fmt:message key="jsp.accounts.accountList.
            total<span class="code-quote">"/&gt; - &lt;fmt:message key="</span>jsp.accounts.accountList.page"/&gt;
            (&lt;c:out value=<span class="code-quote">"$\{list.valueListInfo.pagingPage\}"</span> /&gt; &lt;fmt:message key=<span class="code-quote">"jsp.accounts.accountList.of"</span>/&gt;
            &lt;c:out value=<span class="code-quote">"$\{list.valueListInfo.totalNumberOfPages\}"</span> /&gt;)&lt;/td&gt;
            &lt;td &gt;&lt;table border=<span class="code-quote">"0"</span> align=<span class="code-quote">"right"</span>&gt;&lt;tr&gt;&lt;td&gt;&lt;fwk:vlhpaging /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;
         &lt;/tr&gt;
         &lt;!-- end of Pagination --&gt;
         &lt;tr&gt;
            &lt;td colspan=<span class="code-quote">"2"</span>&gt;
                &lt;table width=<span class="code-quote">"100%"</span> class=<span class="code-quote">"classicLook"</span> cellspacing=<span class="code-quote">"0"</span> cellpadding=<span class="code-quote">"0"</span> id=<span class="code-quote">"taulaId"</span>&gt;
                    &lt;tbody&gt;
                        &lt;%
                            <span class="code-object">String</span> displayProvider = (request.getAttribute(<span class="code-quote">"displayProvider"</span>)!=<span class="code-keyword">null</span>)?request.
                            getAttribute(<span class="code-quote">"displayProvider"</span>).toString():"";
                        %&gt;
                        &lt;fwk:vlhrow bean=<span class="code-quote">"account"</span> display=<span class="code-quote">"&lt;%=displayProvider%&gt;"</span>&gt;
                            &lt;vlh:attribute name=<span class="code-quote">"onmouseover"</span>&gt;<span class="code-keyword">this</span>.className='selected';&lt;/vlh:attribute&gt;
                            &lt;vlh:attribute name=<span class="code-quote">"onmouseout"</span>&gt;<span class="code-keyword">this</span>.className='zebra0';&lt;/vlh:attribute&gt;
                            &lt;fwk:vlhcolumn titleKey=<span class="code-quote">"jsp.accounts.accountList.lastname"</span> property=<span class="code-quote">"lastname"</span>&gt;
                                &lt;fwk:checkbox property=<span class="code-quote">"accounts[$\{count\}].selected"</span> styleId=<span class="code-quote">"accounts[$\{count\}].selected"</span>
                                layout=<span class="code-quote">"<span class="code-keyword">false</span>"</span> mode=<span class="code-quote">"E,E,E"</span>/&gt;
                            &lt;/fwk:vlhcolumn&gt;
                            &lt;fwk:vlhcolumn titleKey=<span class="code-quote">"jsp.accounts.accountList.id"</span> property=<span class="code-quote">"id"</span>&gt;
                                &lt;fwk:vlhaction url=<span class="code-quote">"editAccount.<span class="code-keyword">do</span>?"</span>&gt;
                                    &lt;fwk:vlhaddParam name=<span class="code-quote">"reqCode"</span> value=<span class="code-quote">"edit"</span> temp=<span class="code-quote">"<span class="code-keyword">false</span>"</span> /&gt;
                                    &lt;fwk:vlhaddParam name=<span class="code-quote">"id"</span> property=<span class="code-quote">"id"</span> temp=<span class="code-quote">"<span class="code-keyword">false</span>"</span> /&gt;
                                    &lt;c:out value=<span class="code-quote">"$\{account.id\}"</span>&gt;&lt;/c:out&gt;
                                &lt;/fwk:vlhaction&gt;
                            &lt;/fwk:vlhcolumn&gt;
                            &lt;fwk:vlhcolumn titleKey=<span class="code-quote">"jsp.accounts.accountList.firstname"</span> property=<span class="code-quote">"firstname"</span>/&gt;
                            &lt;fwk:vlhcolumn titleKey=<span class="code-quote">"jsp.accounts.accountList.lastname"</span> property=<span class="code-quote">"lastname"</span>&gt;
                                &lt;fwk:text property=<span class="code-quote">"accounts[$\{count\}].lastname"</span> styleId=<span class="code-quote">"accounts[$\{count\}].lastname"</span>
                                layout=<span class="code-quote">"<span class="code-keyword">false</span>"</span>/&gt;
                            &lt;/fwk:vlhcolumn&gt;
                            &lt;fwk:vlhcolumn titleKey=<span class="code-quote">"forms.accountForm.field.preferredCategory"</span> property=<span class="code-quote">"preferredCategory.id"</span>&gt;
                                &lt;fwk:select styleId=<span class="code-quote">"preferredCategory.id"</span> property=<span class="code-quote">"preferredCategory.id"</span>/&gt;
                            &lt;/fwk:vlhcolumn&gt;
                            &lt;c:set <span class="code-keyword">var</span>=<span class="code-quote">"count"</span> value=<span class="code-quote">"$\{count + 1\}"</span>/&gt;
                        &lt;/fwk:vlhrow&gt;
                        &lt;tr&gt;
                            &lt;td colspan=<span class="code-quote">"4"</span> style=<span class="code-quote">"text-align:right"</span>&gt;
                                &lt;table align=<span class="code-quote">"right"</span>&gt;
                                    &lt;tr&gt;
                                        &lt;td style=<span class="code-quote">"border: 0px"</span>&gt;
                                            &lt;fmt:message key=<span class="code-quote">"jsp.common.export"</span>/&gt;
                                        &lt;/td&gt;
                                        &lt;td style=<span class="code-quote">"border: 0px"</span>&gt;
                                            &lt;html:link page=<span class="code-quote">"/accounts.<span class="code-keyword">do</span>?reqCode=searchExportPDF"</span> target=<span class="code-quote">"_blank"</span>&gt;
                                                &lt;img src=<span class="code-quote">"&lt;%=request.getContextPath()%&gt;/images/icono_acrobat.gif"</span>  border=<span class="code-quote">"0"</span>/&gt;
                                            &lt;/html:link&gt;
                                        &lt;/td&gt;
                                        &lt;td style=<span class="code-quote">"border: 0px"</span>&gt;
                                            &lt;html:link page=<span class="code-quote">"/accounts.<span class="code-keyword">do</span>?reqCode=searchExportExcel"</span> target=<span class="code-quote">"_blank"</span>&gt;
                                                &lt;img src=<span class="code-quote">"&lt;%=request.getContextPath()%&gt;/images/icono_excel.gif"</span>  border=<span class="code-quote">"0"</span>/&gt;
                                            &lt;/html:link&gt;
                                        &lt;/td&gt;
                                &lt;/table&gt;
                            &lt;/td&gt;
                        &lt;/tr&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt;

      &lt;input type=<span class="code-quote">"button"</span> name=<span class="code-quote">"triggerButton"</span> id=<span class="code-quote">"triggerButton"</span> value=<span class="code-quote">"Add Row"</span>/&gt;
      &lt;input type=<span class="code-quote">"button"</span> name=<span class="code-quote">"selectionButton"</span> id=<span class="code-quote">"selectionButton"</span> value=<span class="code-quote">"Select All"</span>/&gt;
      &lt;input type=<span class="code-quote">"button"</span> name=<span class="code-quote">"unselectionButton"</span> id=<span class="code-quote">"unselectionButton"</span> value=<span class="code-quote">"Unselect All"</span>/&gt;
      &lt;input type=<span class="code-quote">"button"</span> name=<span class="code-quote">"deleteRowsButton"</span> id=<span class="code-quote">"deleteRowsButton"</span> value=<span class="code-quote">"Delete selecteds"</span>/&gt;

      &lt;br&gt;

      &lt;fwk:selection source=<span class="code-quote">"selectionButton"</span> target=<span class="code-quote">"taulaId"</span> listName=<span class="code-quote">"accounts"</span>
            selectionProperty=<span class="code-quote">"selected"</span> action=<span class="code-quote">"selectAll"</span>/&gt;
      &lt;fwk:selection source=<span class="code-quote">"unselectionButton"</span> target=<span class="code-quote">"taulaId"</span> listName=<span class="code-quote">"accounts"</span>
            selectionProperty=<span class="code-quote">"selected"</span> action=<span class="code-quote">"unselectAll"</span>/&gt;

      &lt;fwk:deleterows source=<span class="code-quote">"deleteRowsButton"</span> target=<span class="code-quote">"taulaId"</span> listName=<span class="code-quote">"accounts"</span>
            selectionProperty=<span class="code-quote">"selected"</span>/&gt;

      &lt;fwk:addRow url=<span class="code-quote">"/canigo-samples-jPetstore/AppJava/accounts.<span class="code-keyword">do</span>"</span>
            target=<span class="code-quote">"taulaId"</span>
            source=<span class="code-quote">"triggerButton"</span>
            listName=<span class="code-quote">"accounts"</span>
            startIndex=<span class="code-quote">"$\{count\}"</span>
            insertInRow=<span class="code-quote">"penultimate"</span>
            reqCode=<span class="code-quote">"addRowEditList"</span>
            forward=<span class="code-quote">"addRow"</span> /&gt;

      &lt;fwk:submit value=<span class="code-quote">"submit"</span> styleId=<span class="code-quote">"submit"</span> reqCode=<span class="code-quote">"save"</span>/&gt;

   &lt;/fwk:form&gt;
&lt;/fwk:vlhroot&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image023.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-Serveidevalidacionseneljsp"></a>Servei de  validacions en el jsp</h2>

<p>El dividirem en dos gran àrees. La primera serà el motor de regles, i la  segona el servei de presentació de missatges d'error.</p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Motorderegles"></a>Motor  de regles</h3>

<p>El motor de regles és el conjunt de mètodes que permeten validar si les dades  són correctes.<br/>
Aquestes s'han de poder executar tant en client com en  servidor.</p>

<h4><a name="Serveidepresentaci%C3%B3detags2.2-Definici%C3%B3deregles"></a>Definició de  regles</h4>

<p>Per definir les regles de validació és fa servir el framework  commons-validator 1.3.0 d'Apache.<br/>
En el framework es poden veure definides en  el fitxer validations-rules.xml.
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;validator name=<span class="code-quote">"maxlength"</span>
classname=<span class="code-quote">"org.springmodules.validation.commons.FieldChecks"</span>
method=<span class="code-quote">"validateMaxLength"</span>
methodParams="java.lang.<span class="code-object">Object</span>,
org.apache.commons.validator.ValidatorAction,
org.apache.commons.validator.Field,
org.springframework.validation.Errors"

depends=""
msg=<span class="code-quote">"errors.maxlength"</span>&gt;

&lt;javascript&gt;&lt;![CDATA[
function validateMaxLength(form) {
<span class="code-keyword">var</span> isValid = <span class="code-keyword">true</span>;
<span class="code-keyword">var</span> focusField = <span class="code-keyword">null</span>;
<span class="code-keyword">var</span> i = 0;
<span class="code-keyword">var</span> fields = <span class="code-keyword">new</span> Array();
oMaxLength = <span class="code-keyword">new</span> maxlength();
<span class="code-keyword">for</span> (x in oMaxLength) {
<span class="code-keyword">var</span> field = form[oMaxLength[x][0]];

<span class="code-comment">// canigo modification. Added <span class="code-keyword">if</span>. In some cases, a 'extend'
</span><span class="code-comment">// field appears that is not a field.
</span><span class="code-keyword">if</span> (field) {

<span class="code-keyword">if</span> (field.type == 'text' ||
field.type == 'textarea') {

<span class="code-keyword">var</span> iMax = parseInt(oMaxLength[x][2](<span class="code-quote">"maxlength"</span>));
<span class="code-keyword">if</span> (field.value.length &gt; iMax) {
<span class="code-keyword">if</span> (i == 0) {
focusField = field;
}
fields[i++] = oMaxLength[x][1];
isValid = <span class="code-keyword">false</span>;
}
}
}
}
<span class="code-keyword">if</span> (fields.length &gt; 0) {
focusField.focus();
alert(fields.join('\n'));
}
<span class="code-keyword">return</span> isValid;
}]]&gt;
&lt;/javascript&gt;

&lt;/validator&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Les regles que tenen definida la funció javascript permeten l'execució en  client, però sempre han de tenir la implementació en java per garantir  l'execució en servidor.
<br clear="all" />
<br clear="all" />
Les regles poden dependre d'un o més camps. Aquelles que necessiten més d'un  camps per validar en direm que són regles amb camps dependents. Per tant se li  ha d'indicar d'alguna manera aquesta necessitat. Amb el commons-validator és fa  mitjançant passant-li els valors dels camps com argument, en canvi amb el nou  tag de validacions s'indica amb un atribut a mida.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h4><a name="Serveidepresentaci%C3%B3detags2.2-Eventsdevalidaci%C3%B3"></a>Events de  validació</h4>

<p>Els events que llencen el sistema de validació són els següents:</p>

<p><b>&#45; onSubmit del formulari:</b></p>

<p>Quan es fa un submit del formulari és llença una petició de validació via  AJAX cap a servidor o s' executa regles de javascipt si es validació client . Si  aquesta és correcta es fa el submit.</p>

<p>Per qüestions de seguretat, quan es fa el submit en servidor es torna a  validar les dades que són les que entraran a l'action. Per exemple si es  desactivés el javascript les validacions AJAX no funcionarien, però al baixar  les dades és validaran per les validacions obligatòries de submit.</p>

<p>Aquestes validacions de submit obligatòries són configurables i pots establir  quin mètodes han de tenir validacions obligatòries.
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean name=<span class="code-quote">"/accountList"</span>  parent=<span class="code-quote">"accountListBaseDefinition"</span>&gt;

&lt;property  name=<span class="code-quote">"webValidationSubmit"</span> ref=<span class="code-quote">"webValidationSubmit"</span>/&gt;

&lt;property  name=<span class="code-quote">"metodosList"</span>&gt;

&lt;list&gt;

&lt;value&gt;save&lt;/value&gt;

&lt;/list&gt;

&lt;/property&gt;

&lt;/bean&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En l'action accountList s'ha definit que hi ha validacions obligatòries de  submit pel mètode save de l'action.
<br clear="all" />
<br clear="all" />
Les regles a executar per un formulari és defineixen en el validation.xml
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;form name=<span class="code-quote">"accountList"</span>&gt;

&lt;field property=<span class="code-quote">"firstname"</span>  depends=<span class="code-quote">"required"</span>&gt;

&lt;arg0  key=<span class="code-quote">"forms.accountForm.field.firstname"</span>/&gt;

&lt;/field&gt;

&lt;field  property=<span class="code-quote">"lastname"</span> depends=<span class="code-quote">"required"</span>&gt;

&lt;arg0  key=<span class="code-quote">"forms.accountForm.field.firstname"</span>/&gt;

&lt;/field&gt;

&lt;/form&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
El conjunt de regles anomenades accountList obliguen ha tenir el camp  firstname i lastname informats.
<br clear="all" />
<br clear="all" />
Altrament aquesta seria la manera antiga. Amb la nova versió és permet  definir les validacions de submit d'un camp en el mateix tag del jsp. Aquesta  manera és més flexible i es poden veure fàcilment les validacions d'una  pàgina.<br/>
Un exemple és :
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text styleId=<span class="code-quote">"firstname"</span>  styleClass=<span class="code-quote">"fieldtext"</span>

property=<span class="code-quote">"firstname"</span> validations=<span class="code-quote">"ONSUBMIT(required)"</span>  /&gt;

&lt;fwk:text styleId=<span class="code-quote">"lastname"</span> styleClass=<span class="code-quote">"fieldtext"</span>

property=<span class="code-quote">"lastname"</span>  validations=<span class="code-quote">"ONSUBMIT(required)"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Aquest exemple és sinònim de l'anterior.
<br clear="all" />
<br clear="all" />
A l'atribut validations es posa ONSUBMIT( &lt; regla de validació &gt;, &lt;  regla de validació &gt; ..) on les regles de validacions han d'estar definides  en el validation-rules.xml.<br/>
<b>&#45; onChange d'un camp de text:</b><br/>
Aquest event permet validar el contingut d'un camp un cop ha canviat. Són el  que s'anomenen les validacions de camp.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<p>Aquestes validacions només permeten execució de regles en servidor,  mitjançant petició AJAX.<br/>
Al produir-se l'event onChange del camp, es llença  petició a servidor indicant quin camp s'ha de validar i les regles de validació  a aplicar.<br/>
En el cas que tingués camps dependents, s'enviarà el valor  d'aquests camps.</p>

<p>La manera d'expressar aquestes validacions és:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text styleId=<span class="code-quote">"lastname"</span> styleClass=<span class="code-quote">"fieldtext"</span>

property=<span class="code-quote">"lastname"</span>  validationFieldMessageMode=<span class="code-quote">"ICON,TEXTERROR"</span>

validations=<span class="code-quote">"ONCHANGE(required)  "</span>

errorClass=<span class="code-quote">"errorNew"</span>  errorKey=<span class="code-quote">"forms.accountForm.field.lastname"</span>

iconStyleId=<span class="code-quote">"lastnameIconError"</span>

textErrorStyleId=<span class="code-quote">"lastnameTextError"</span>  /&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Escrivint ONCHANGE(..&lt;regla de validació&gt;, &lt;regla de validació&gt;)  en l'atribut validations és defineix les validacions camp a camp. Aquestes  regles de validació han d'estar definides en el fitxer validation-rules.xml.
<br clear="all" />
<br clear="all" />
Les regles de validació poden tenir un o més paràmetres. La forma  d'indicar-los és posar els paràmetres dins de la notació {} i separats per  punt i coma:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text styleId=<span class="code-quote">"birthdate"</span> styleClass=<span class="code-quote">"fieldtext"</span>

property=<span class="code-quote">"  birthdate "</span>  validationFieldMessageMode=<span class="code-quote">"ICON,TEXTERROR"</span>

validations=<span class="code-quote">"ONCHANGE(required,  date\{datePattern: Dd/MM/yyyy;dateLength:10\})"</span>

errorClass=<span class="code-quote">"errorNew"</span>  errorKey=<span class="code-quote">"forms.accountForm.field.lastname"</span>

iconStyleId=<span class="code-quote">"lastnameIconError"</span>

textErrorStyleId=<span class="code-quote">"lastnameTextError"</span>  /&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Els altres atributs serveixen per mostrar l'avís d'error que seguidament  s'explicarà en el següent apartat.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Presentaci%C3%B3demissatges"></a>Presentació  de missatges</h3>

<p>Principalment són quatre tags, dos per validacions camp a camp i els altres  dos per validacions de formulari.</p>

<h4><a name="Serveidepresentaci%C3%B3detags2.2-FormiFormValidator"></a>Form i  FormValidator</h4>

<p>El FormValidator és un decorador que permet associar a un formulari  validacions. Els atributs dels dos són bastant semblants per tant s'explicaran  junts.</p>

<p><b>fwk:Form</b>: Només s'exposen atributs de validació.</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> validationFormMessageMode </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Pot ser PANEL, FIELDS, WINDOW </td>
</tr>
<tr>
<td class='confluenceTd'> validationMessageFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció de presentació. </td>
</tr>
<tr>
<td class='confluenceTd'> indicator </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div que es mostra quan es fa petició  AJAX </td>
</tr>
<tr>
<td class='confluenceTd'> mode </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> CLIENT o SERVIDOR </td>
</tr>
<tr>
<td class='confluenceTd'> generateId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Id del formulari intern. </td>
</tr>
<tr>
<td class='confluenceTd'> errorPanelStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Id del panell d'errors. </td>
</tr>
</tbody></table>
<p><b>fwk:FormValidator:</b></p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Formulari a associar-li validacions. </td>
</tr>
<tr>
<td class='confluenceTd'> validationFormMessageMode </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Pot ser PANEL, FIELDS, WINDOW </td>
</tr>
<tr>
<td class='confluenceTd'> validationMessageFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció de presentació. </td>
</tr>
<tr>
<td class='confluenceTd'> indicator </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div que es mostra quan es fa petició  AJAX </td>
</tr>
<tr>
<td class='confluenceTd'> mode </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> CLIENT o SERVIDOR </td>
</tr>
<tr>
<td class='confluenceTd'> errorPanelStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Id del panell d'errors. </td>
</tr>
</tbody></table>
<ul>
	<li><b>validationFormMessageMode</b></li>
</ul>


<p>Indica les maneres de mostrar els errors de formulari. Hi ha 3 maneres  possibles.<br/>
PANEL: Panell incrustat en la pàgina.<br/>
WINDOW: Mostra un alert  amb els missatge d'error<br/>
FIELDS: Mostra els errors com si fos un validació  camp a camp.</p>

<p>Es poden combinar els tres elements, encara que PANEL i WINDOW poden semblar  contradictori, com per exemple PANEL,FIELDS;WINDOW o PANEL,FIELDS.</p>
<ul>
	<li><b>validationMessageFunction</b></li>
</ul>


<p>Funció javascript que s'encarrega de fer la presentació del errors. Aquest és  pels usuaris que volguessin fer un presentació d'errors a mida.</p>
<ul>
	<li><b>indicator</b></li>
</ul>


<p>Div que es mostra mentre s'està fent petició a servidor via AJAX.</p>
<ul>
	<li><b>mode</b></li>
</ul>


<p>Aquest atribut és necessari per quan no estant configurades les validacions  del commons validator i només hi ha validacions dels tags.</p>

<p>El seu valor pot ser CLIENT o SERVER, i indica on s'executaran les  validacions.<br/>
En el cas que estiguessin configurades les validacions del  commons-validator, agafarà el mode de l'atribut validationType.</p>

<p>Si l'atribut mode i el validationType no fossin iguals saltarà una excepció  avisant del conflicte.</p>
<ul>
	<li><b>errorPanelStyleId</b></li>
</ul>


<p>Identificador del panell incrustat. Si no s'identifica fa servir el per  defecte.</p>

<h4><a name="Serveidepresentaci%C3%B3detags2.2-TextiFieldValidator"></a>Text i  FieldValidator</h4>

<p><b>fwk:text:</b> Només es mostren els atributs referents a validacions.</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id d'enllaç amb la configuració XML. </td>
</tr>
<tr>
<td class='confluenceTd'> validations </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> validacions pel camp, </td>
</tr>
<tr>
<td class='confluenceTd'> validationFieldMessageMode </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> ICON,TOOLTIP,CHANGESTYLE,TEXTERROR, </td>
</tr>
<tr>
<td class='confluenceTd'> sourceErrorTooltip </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Pot ser ICON, TEXT </td>
</tr>
<tr>
<td class='confluenceTd'> iconStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Identificador de l' icona </td>
</tr>
<tr>
<td class='confluenceTd'> textErrorStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div amb el text d'error. </td>
</tr>
<tr>
<td class='confluenceTd'> errorClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Estil de la classe quan està en  error. </td>
</tr>
<tr>
<td class='confluenceTd'> validationMessageFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció de presentació </td>
</tr>
<tr>
<td class='confluenceTd'> dependentFields </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Camps dependents </td>
</tr>
<tr>
<td class='confluenceTd'> errorKey </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom del camp internacionalitzat. </td>
</tr>
<tr>
<td class='confluenceTd'> Indicator </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div a mostrar quan es fa petició  AJAX. </td>
</tr>
</tbody></table>
<ul>
	<li><b>fwk:fieldValidator</b>: permet que a qualsevol camp de text se li puguin  associar validacions
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Usar el valor 'configurationTag' </td>
</tr>
<tr>
<td class='confluenceTd'> Source </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Component a associar les  validacions. </td>
</tr>
<tr>
<td class='confluenceTd'> validations </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> validacions pel camp, </td>
</tr>
<tr>
<td class='confluenceTd'> validationFieldMessageMode </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> ICON,TOOLTIP,CHANGESTYLE,TEXTERROR, </td>
</tr>
<tr>
<td class='confluenceTd'> sourceErrorTooltip </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Pot ser ICON, TEXT </td>
</tr>
<tr>
<td class='confluenceTd'> iconStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Identificador de l' icona </td>
</tr>
<tr>
<td class='confluenceTd'> textErrorStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div amb el text d'error. </td>
</tr>
<tr>
<td class='confluenceTd'> errorClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Estil de la classe quan està en  error. </td>
</tr>
<tr>
<td class='confluenceTd'> validationMessageFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció de presentació </td>
</tr>
<tr>
<td class='confluenceTd'> dependentFields </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Camps dependents </td>
</tr>
<tr>
<td class='confluenceTd'> errorKey </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom del camp internacionalitzat. </td>
</tr>
<tr>
<td class='confluenceTd'> indicator </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div a mostrar quan es fa petició  AJAX. </td>
</tr>
</tbody></table></li>
	<li><b>validations</b></li>
</ul>


<p>Cadena que indica les validacions d'un camp. La cadena permesa  és:<br/>
ONCHANGE(r1,r2,...), ONSUBMIT(r3,r4,..)<br/>
Les regles de validació r1 i  r2 s'executaran amb l'event onChange, i les regles r3 i r4 s'executaran en  l'onSubmit del formulari.</p>

<p>r1,r2,r3,r4 han d'estar definides en el validation-rules.xml.</p>
<ul>
	<li><b>validationFieldMessageMode</b></li>
</ul>


<p>Els valors permesos és un combinació separada per comes dels següents  valors.</p>

<p>TOOLTIP: És mostra un tooltip amb el missatge d'error en el camp o en l'  icona.<br/>
ICON: Icona d'avís que el camp té un error. Cal informar iconStyleId.<br/>
TEXTERROR: Mostra el missatge en un div. Cal informar  textErrorStyleId.<br/>
CHANGESTYLE: Canvi l'aspecte del component. Cal informar  errorClass.</p>

<p>Per exemple, si fos TOOLTIP, ICON, mostra un tooltip i una icona.</p>
<ul>
	<li><b>sourceErrorTooltip</b></li>
</ul>


<p>Indica on és vol mostrar el tooltip. Els valors possibles són dos:<br/>
ICON:  Mostrar tooltip en l' icona<br/>
TEXT: Mostrar tooltip en el camp.</p>
<ul>
	<li><b>iconStyleId</b></li>
</ul>


<p>Identificador del div que conté l' icona. El tag iconError és un tag fet a  mida per mostrar icones.</p>
<ul>
	<li><b>textErrorStyleId</b></li>
</ul>


<p>Identificador del div que mostra el missatge d'error incrustat. El tag  textError ajuda en aquesta tasca.</p>
<ul>
	<li><b>errorClass</b></li>
</ul>


<p>Nom de classe CSS que s'aplica en cas d'error en el camp. Normalment posa el  marc en vermell del camp i canvia el color de fons.</p>
<ul>
	<li><b>validationMessageFunction</b></li>
</ul>


<p>Funció javascript que permet la presentació del missatge d'error a mida.</p>
<ul>
	<li><b>dependentFields</b></li>
</ul>


<p>Llista de camps dependents. Per exemple pot ser:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text property=<span class="code-quote">"age"</span> dependentFields=<span class="code-quote">"currentDate,birdhDate"</span>  /&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
L'atribut dependentFields està composat d'identificadors (styleId) de diferents camps del formulari.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ul>
	<li><b>errorKey</b></li>
</ul>


<p>Argument que es s'envia per construir el missatge d'error.<br/>
Generalment els  missatges d'error es construeixen amb una variable<br/>
Per exemple:<br/>
El camp  {0} es obligatori.</p>

<p>Suposem errorKey = ' ciutat'<br/>
Llavors el missatge d'error serà El camp  ciutat es obligatori.</p>

<p>Si hi ha les validacions activades aquest camp es obligatori.</p>
<ul>
	<li><b>indicator</b></li>
</ul>


<p>Identificador del div que es mostra quan hi ha petició a servidor.</p>

<h4><a name="Serveidepresentaci%C3%B3detags2.2-IconErroriTextError"></a>IconError i  TextError</h4>

<p>Aquests dos tags són d'ajuda per tal de facilitar la mostra d'errors del  sistema de validació.<br/>
Mostren molt clarament la funcionalitat dels divs. Són  molt aconsellables ja que ajuden es veu clarament la funcionalitat de cada  tag.</p>

<p>L'IconError s'encarrega d'encapsular la imatge d'avís d'error.</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del div </td>
</tr>
<tr>
<td class='confluenceTd'> styleClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> CSS del div </td>
</tr>
<tr>
<td class='confluenceTd'> style </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Style del div </td>
</tr>
<tr>
<td class='confluenceTd'> services </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Permet injectar serveis del  contenidor d' spring. </td>
</tr>
</tbody></table>
<p>Exemple</p>

<p>El TextError és un div que permet afegir-hi el missatge d'error.</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del div </td>
</tr>
<tr>
<td class='confluenceTd'> styleClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> CSS del div </td>
</tr>
<tr>
<td class='confluenceTd'> style </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Style del div </td>
</tr>
<tr>
<td class='confluenceTd'> services </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Permet injectar serveis del  contenidor d' spring. </td>
</tr>
</tbody></table>
<p>Exemples:</p>

<p><b>&#45;</b> ICON &amp; TEXTERROR
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;td&gt;&lt;fwk:text styleId=<span class="code-quote">"lastname"</span> styleClass=<span class="code-quote">"fieldtext"</span>
property=<span class="code-quote">"lastname"</span> validationFieldMessageMode=<span class="code-quote">"ICON,TEXTERROR"</span>
validations=<span class="code-quote">"ONCHANGE(required),ONSUBMIT(required)"</span>
sourceErrorTooltip=<span class="code-quote">"TEXT"</span> dependentFields=<span class="code-quote">"firstname"</span>
errorClass=<span class="code-quote">"errorNew"</span> errorKey=<span class="code-quote">"forms.accountForm.field.lastname"</span>
iconStyleId=<span class="code-quote">"lastnameIconError"</span>
textErrorStyleId=<span class="code-quote">"lastnameTextError"</span> /&gt;&lt;/td&gt;
&lt;td&gt;&lt;fwk:iconError styleId=<span class="code-quote">"lastnameIconError"</span>
style=<span class="code-quote">"display:none"</span> styleClass=<span class="code-quote">"iconError"</span>&gt;
&lt;img src=<span class="code-quote">"&lt;c:url value="</span>/images/iconWarning.gif<span class="code-quote">"/&gt;"</span>
id=<span class="code-quote">"imagen"</span> class=<span class="code-quote">"icon"</span> /&gt;
&lt;/fwk:iconError&gt;&lt;/td&gt;
&lt;td&gt;&lt;fwk:textError styleId=<span class="code-quote">"lastnameTextError"</span>
styleClass=<span class="code-quote">"errorText"</span> /&gt;&lt;/td&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image024.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <b>&#45;</b> ICON, TOOLTIP &amp; CHANGESTYLE
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;td&gt;&lt;fwk:text styleId=<span class="code-quote">"state"</span> property=<span class="code-quote">"state"</span>
styleClass=<span class="code-quote">"fieldtext"</span>
validationFieldMessageMode=<span class="code-quote">"ICON,TOOLTIP,CHANGESTYLE"</span>
validations=<span class="code-quote">"ONCHANGE(required),ONSUBMIT(required)"</span>
sourceErrorTooltip=<span class="code-quote">"TEXT"</span> dependentFields=<span class="code-quote">"firstname"</span>
errorClass=<span class="code-quote">"errorNew"</span> errorKey=<span class="code-quote">"forms.accountForm.field.state"</span>
iconStyleId=<span class="code-quote">"stateIconError"</span> textErrorStyleId=<span class="code-quote">"stateTextError"</span> /&gt;
&lt;/td&gt;
&lt;td&gt;&lt;fwk:iconError styleId=<span class="code-quote">"stateIconError"</span> style=<span class="code-quote">"display:none"</span>
styleClass=<span class="code-quote">"iconError"</span>&gt;
&lt;img src=<span class="code-quote">"&lt;c:url value="</span>/images/iconWarning.gif<span class="code-quote">"/&gt;"</span>
id=<span class="code-quote">"imagen"</span> class=<span class="code-quote">"icon"</span> /&gt;
&lt;/fwk:iconError&gt;&lt;/td&gt;
&lt;td&gt;&lt;fwk:textError styleId=<span class="code-quote">"stateTextError"</span> styleClass=<span class="code-quote">"errorText"</span> /&gt;
&lt;/td&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <img src="Servei de presentació de tags 2.2_attachments/image025.jpg" align="absmiddle" border="0" /><br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Validacionsenllistatseditables"></a>Validacions  en llistats editables</h3>

<p>Les validacions en llistats editables és el suport a propietats indexades. És  a dir poder validar camps amb els noms de propietats a[1].id o a.b[2].name,etc.  Els [] denoten propietats indexades i són pròpies de llistats editables.</p>

<p>Seguidament és mostra un exemple de validació en propietats indexades.
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text styleId=<span class="code-quote">"city"</span> property=<span class="code-quote">"accounts[0].city"</span> size=<span class="code-quote">"20"</span>
validationFieldMessageMode=<span class="code-quote">"ICON,TOOLTIP,CHANGESTYLE"</span> validations="ONCHANGE(required),
ONSUBMIT(required)<span class="code-quote">" sourceErrorTooltip="</span>TEXT<span class="code-quote">" iconStyleId="</span>iconErrorCity$\{count\}"
errorKey=<span class="code-quote">"forms.accountForm.field.city"</span> errorClass=<span class="code-quote">"errorNew"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Seguidament s'explicarà les peculiaritats segons el mètode de validació.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />  <b>&#45;onChange:</b><br/>
Per aquest sistema no hi ha absolutament cap problema ja que el camp és un  etiqueta per aquest sistema de validació i li és igual com s'escrigui.<br/>
<b>&#45;onSubmit per commons validator:</b>
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<p><ins>No s'aconsella pel motius seguidament explicats</ins>.</p>

<p>Les propietats indexades s'han d'especificar amb l'atribut  indexedListProperty i s'ha d'especificar el nom de la propietat que és una  llista.
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;form name=<span class="code-quote">"accountList"</span>&gt;
&lt;field property=<span class="code-quote">"firstname"</span> indexedListProperty=<span class="code-quote">"accounts"</span> depends=<span class="code-quote">"required"</span>&gt;
&lt;arg0 key=<span class="code-quote">"forms.accountForm.field.firstname"</span>/&gt;
&lt;/field&gt;
&lt;field property=<span class="code-quote">"lastname"</span> indexedListProperty=<span class="code-quote">"accounts"</span> depends=<span class="code-quote">"required"</span>&gt;
&lt;arg0 key=<span class="code-quote">"forms.accountForm.field.firstname"</span>/&gt;
&lt;/field&gt;

&lt;/form&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
El problema d'aquest sistema és que el sistema de presentació d'errors rep el  camp erroni però no s'indica la fila errònia i per tant no es pot saber quin  camp està malament.
<br clear="all" />
<br clear="all" />
Per exemple en el cas anterior, es rebria com error accounts[].city.<br/>
<b>&#45;onSubmit per tags</b>.<br/>
Si es defineix l'event onSubmit en els tags el problema sorgeix en el  mecanisme d'afegir files noves.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<p>Aquest mecanisme dispara un única petició a servidor en busca de la plantilla  nova d' afegir. Un cop la té el navegador reemplaça el nomCollecció[0], pel  número nomColecció[ultimIndex].<br/>
Aquest últim pas es va repetint tants cops  com addRows es facin.</p>

<p>El problema d'aquest mecanisme es que les validacions de submit s'associen a  un identificador intern de formulari i es queden a sessió, i per tant per les  noves files no hi ha associades validacions de submit.<br/>
Llavors s'ha de fer  dos passes.</p>
<ol>
	<li>La primera es indicar-li al servidor que tenim una propietat indexada i que  totes les validacions de submit de la posició X, generalment la 0, es propaguin  a totes les files de la col&#45; lecció.</li>
</ol>


<p>Això és fa amb el tag validateCollection.</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Atributs</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Descripció</b> </th>
</tr>
<tr>
<td class='confluenceTd'> property </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Nom de la propietat que és  col&#45; lecció </td>
</tr>
<tr>
<td class='confluenceTd'> indexReference </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Numero de fila referència per a  propagar les validacions de submit. Si no s'informa s'assumeix 0. </td>
</tr>
</tbody></table>
<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:validateCollection property=<span class="code-quote">"accounts"</span> indexReference=<span class="code-quote">"0"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Si en la plantilla de files noves (addRow.jsp) és tenen tags del fwk,  segurament caldrà un formulari. En el cas de definir validacions de submit en  aquesta plantilla, s'haurà d'informar en el formulari l'atribut  generateId.
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:form styleId=<span class="code-quote">"actionForm11"</span>

action=<span class="code-quote">"accountList.<span class="code-keyword">do</span>"</span>  reqCode=<span class="code-quote">"save"</span>

generateId=<span class="code-quote">"&lt;%=request.getParameter("</span>formIdent<span class="code-quote">")%&gt;"</span>  services=<span class="code-quote">"logService:loggingService"</span> &gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-Utilitzaci%C3%B3delServei"></a>Utilització  del Servei</h2>


<h3><a name="Serveidepresentaci%C3%B3detags2.2-%C3%9Asdelstagsalesp%C3%A0ginesJSP"></a>Ús  dels tags a les pàgines JSP</h3>

<p>L'ús de cadascun dels tags implica 2 passos:</p>
<ol>
	<li>Definició de la referència a la llibreria de tags</li>
</ol>


<p>Des de la versió JSP 1.2 no és necessari configurar al fitxer web.xml la  llibreria i podem fer referències directes mitjançant url al jar, tal i com es  mostra a continuació:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;%@ taglib prefix=<span class="code-quote">"fwk"</span> uri=<span class="code-quote">"http:<span class="code-comment">//www.ctti.net/canigo/open-layout"</span>  %&gt;</span></pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<ol>
	<li>Definició del tag a la pàgina JSP</li>
</ol>


<p>Una vegada definida la referència a la llibreria i el seu prefix 'fwk' podem  incorporar qualsevol tag mitjançant '&lt;fwk:nomTag&gt;'.</p>

<p>Per tots els tags d'entrada de dades de formulari es definiran els  atributs:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Propietat</b> </th>
<th class='confluenceTh'> <b>Requerit</b> </th>
<th class='confluenceTh'> <b>Valor</b> </th>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Identificador del camp. Aquest  identificador és el que correspon a la propietat 'styleId' en el fitxer de  configuració del tag </td>
</tr>
<tr>
<td class='confluenceTd'> property </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Nom del atribut del bean associat al  formulari que volem mostrar. (l'associació del bean es fa mitjançant la  propietat 'pojoClass' del fitxer de configuració de l'acció) </td>
</tr>
</tbody></table>
<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fwk:text styleId=<span class="code-quote">"firstname"</span> property=<span class="code-quote">"firstname"</span>/&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En la següent taula es dona un resum dels tags permesos i la correspondència  amb la seva classe que s'ha de definir en el fitxer de configuració:
<br clear="all" />
<br clear="all" />
&#124;&#124; <b>Tag</b> &#124;&#124; <b>Classe</b> &#124;&#124;
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> fwk:actionImage </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.ActionImageTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:checkbox </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.CheckboxFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:configuration </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.configuration.ConfigurationTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:file </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.FileFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:form </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.FormTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:options </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.OptionsFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:password </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.PasswordFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:radio </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.RadioFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:select </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.SelectFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:submit </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.SubmitTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:text </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.TextFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> fwk:textarea </td>
<td class='confluenceTd'> net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.TextAreaFieldTag </td>
</tr>
</tbody></table>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-ComentarisEspec%C3%ADficsaalgunsTags"></a>Comentaris  Específics a alguns Tags</h3>

<p>En l'ús del tag 'select' es recomana l'ús de JSTL per a la generació de les  opcions incloses.</p>

<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;fkw:select styleId=<span class="code-quote">"..."</span> property=<span class="code-quote">"..."</span>&gt;

&lt;c:forEach  items=<span class="code-quote">"$\{nombreLista\}"</span> <span class="code-keyword">var</span>=<span class="code-quote">"item"</span>&gt;

&lt;fwk:option  value=<span class="code-quote">"$\{item\}"</span>&gt;$\{item.descripcion\}&lt;/fwk:option&gt;

&lt;/c:forEach&gt;

&lt;/select&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Especificaci%C3%B3delModedelFormulari"></a>Especificació  del Mode del Formulari</h3>

<p>En la configuració dels components d'entrada de formulari s'ha explicat com  podem mostrar-los de forma diferents segons el mode del formulari. Aquest mode  de formulari pot canviar-se mitjançant la crida:</p>

<p>FormUtils.setFormDisplayMode(request, actionForm,mode);</p>

<p>On mode pot ser un dels següents valors:</p>

<p>&#45; FormUtils.INSPECT_MODE. Mode de consulta<br/>
&#45; FormUtils.EDIT_MODE. Mode  d'edició<br/>
&#45; FormUtils.CREATE_MODE. Mode de creació</p>

<p><b>NOTA:</b><br/>
canigo, dins la seva classe 'ActionExtendedSupport' (classe  pare de les nostres action) efectua aquesta tasca per a que no ens haguem de  preocupar. Per a això utilitza un <em>resolver</em> que segons el reqCode que  arribi per paràmetre decidirà el model del formulari. A continuació es mostra  una taula amb els modes usats segons el reqCode:</p>

<p>public static final String EDIT_METHOD_PREFIX = "edit";<br/>
public static  final String SEARCH_METHOD_PREFIX = "search";<br/>
public static final String  NEW_METHOD_PREFIX = "create";<br/>
public static final String DELETE_METHOD_PREFIX  = "delete";<br/>
public static final String SAVE_METHOD_PREFIX = "save";<br/>
public  static final String VIEW_METHOD_PREFIX = "view";</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>reqCode</b> </th>
<th class='confluenceTh'> <b>Mode utilitzat</b> </th>
</tr>
<tr>
<td class='confluenceTd'> <b>edit</b> </td>
<td class='confluenceTd'> FormUtils.EDIT_MODE </td>
</tr>
<tr>
<td class='confluenceTd'> search </td>
<td class='confluenceTd'> FormUtils.INSPECT_MODE </td>
</tr>
<tr>
<td class='confluenceTd'> create </td>
<td class='confluenceTd'> FormUtils.CREATE_MODE </td>
</tr>
<tr>
<td class='confluenceTd'> view </td>
<td class='confluenceTd'> FormUtils.INSPECT_MODE </td>
</tr>
<tr>
<td class='confluenceTd'> En altres casos </td>
<td class='confluenceTd'> FormUtils.EDIT_MODE </td>
</tr>
</tbody></table>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-EinesdeSuport"></a>Eines  de Suport</h2>


<h3><a name="Serveidepresentaci%C3%B3detags2.2-DebugdelesP%C3%A0gines"></a>Debug de les  Pàgines</h3>

<p>En l'ús de les nostres pàgines és convenient sempre conèixer si estan ben  construïdes. Tal i com es comenta al document 'Entorn de Desenvolupament'  mitjançant l'extensió 'Web Developer' i 'Javascript Debugger' podem esbrinar i  detectar problemàtiques de les nostres pàgines.</p>

<h1><a name="Serveidepresentaci%C3%B3detags2.2-Annexos"></a>Annexos</h1>


<h2><a name="Serveidepresentaci%C3%B3detags2.2-JSTL"></a>JSTL</h2>

<p>Des de fa un temps existeix <b>JSTL</b> (JSP Standard Tag Library). Aquesta  llibreria de tags defineix algunes de les tasques bàsiques que necessitem a les  nostres pàgines JSP (condicionals, presentació de valors, internacionalització,  ...). Si bé no ofereix totes les necessitats que requerim d'una aplicació Web sí  ofereix la base del que prèviament es feia amb codi Java o els tags de  Struts.</p>

<p>Es recomana l'ús dels tags JSTL de 'core' i 'fmt' que es poden referenciar  dins les nostres pàgines com:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;%@ taglib prefix=<span class="code-quote">"c"</span> uri=<span class="code-quote">"http:<span class="code-comment">//java.sun.com/jstl/core"</span> %&gt;
</span>
&lt;%@  taglib prefix=<span class="code-quote">"fmt"</span> uri=<span class="code-quote">"http:<span class="code-comment">//java.sun.com/jstl/fmt"</span> %&gt;</span></pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Podeu veure un resum de JSTL a la url  'http://www.1x4x9.info/files/jstl/html/online-chunked'.
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-AltresTags"></a>Altres  Tags</h2>

<p>Tot i l'oferta de tags de canigo, existeixen altres necessitats, com per  exemple l'ús de pestanyes.</p>

<p>En aquest apartat s'ofereixen una llista de components disponibles a la  comunitat que poden resoldre aquestes necessitats:</p>
<ol>
	<li>Tags de Crumbs</li>
</ol>


<p>Per a mostrar el típic tag d'enllaços a on ens trobem dins la pàgina podem  usar el tag de Crumbs de 'Struts Layout'.</p>

<p><img src="Servei de presentació de tags 2.2_attachments/image026.jpg" align="absmiddle" border="0" /></p>

<p>Consultar '<a href="http://struts.application-servers.com/doc/tags/crumbs.html" title="Visit page outside Confluence">http://struts.application-servers.com/doc/tags/crumbs.html</a>' per conèixer  la seva utilització.</p>
<ol>
	<li>Tags de Pestanyes</li>
</ol>


<p>Per a utilitzar pestanyes es recomana la utilització del tag de  'Ditchnet'<sup>3</sup></p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-Aspectesd%27Usabilitat"></a>Aspectes  d'Usabilitat</h2>

<p>Aquesta secció pretén donar una visió general del quins aspectes s'han tingut  en consideració en els components canigo per a complir amb normes bàsiques  d'usabilitat i accessibilitat.</p>

<p>Algunes de les guies proporcionades poden resultar òbvies però considerem la  necessitat de fer-les esmentar per a tenir en consideració. En qualsevol cas,  moltes de les guies explicades es troben implementades per canigo en els seus  tags, pel que no s'hauran de tenir en consideració per al desenvolupament de les  aplicacions Web. Si més no, també és el nostre propósit mostrar per què s'han  pres determinades decisions basades en les guies aquí establertes.</p>

<p>A continuació es detallen les guies utilitzades:</p>
<ol>
	<li>La descripció del component d'entrada hauria de precedir al component  (excepte els radio i els checkbox)</li>
	<li>Usar l'etiqueta 'label' i l'atribut 'for' per a fer referència al component  que descriu.</li>
</ol>


<p>(1) i (2) són realitzats pels tags canigo.</p>
<ol>
	<li>Els camps de tipus text haurien de ser seleccionats quan reben el  focus</li>
</ol>


<p>canigo permet especificar la propietat 'selectOnFocus' per a lligar aquest  comportament als nostres components. Per defecte es troba a 'true'.</p>
<ol>
	<li>Els camps haurien de definir la seva longitud màxima mitjançant les  propietats 'maxLength', 'width', 'size' i 'cols'</li>
</ol>


<p>Aquestes propietats han de ser definides pels desenvolupadors.</p>
<ol>
	<li>En els camps requerits haurem d'utilitzar alguna representació per indicar  que són obligatoris. Si es fa servir una icona o símbol <img class="emoticon" src="./icons/emoticons/star_yellow.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> indicar a la pàgina  què significa</li>
</ol>


<p>canigo mostra, per defecte, un asterisc a l'esquerra de l'etiqueta del  component si el seu atribut associat ha estat definit com a obligatori dins el  Servei de Validació.</p>
<ol>
	<li>Quan anem a entrar dades a un component hauríem de mostrar alguna decoració  que indiqui que estem en aquell component</li>
</ol>


<p>Per exemple podem usar el següent estil (basat en 'theserverside.com'):
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">form input, form textarea, form select {

padding-left: 4px;

color:  #666;

}</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
O bé:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">input.input-text, textarea { border: 1px solid #859085; background:  transparent; padding: 1px 3px; }

input.hover, textarea.hover {  border-color: #000; background-color: #ffe; }

input.active, textarea.active  { border-color: #f00; background-color: #fff; }

input.input-button, button,  select { border-width: 1px; padding: 0px; }

input.input-text,  input.input-button, button, select, textarea { font: 90%  tahoma,verdana,sans-serif; }

input.input-disabled { background-color: #ccc;  border-color: #999; color: #777; }</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h2><a name="Serveidepresentaci%C3%B3detags2.2-CSS%28CascadeStyleSheets%29"></a>CSS  (Cascade Style Sheets)</h2>

<p>Tot i que no és propòsit de canigo oferir un tutorial en detall de què són  els CSS i com fer-los servir es considera bàsic el seu coneixement.</p>

<p>A continuació s'ofereix un resum de quins aspectes es consideren important a  tenir en compte:</p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Importaci%C3%B3defitxersd%27estils"></a>Importació  de fitxers d'estils</h3>

<p>Podem agrupar l'ús de varis fitxers d'estils mitjançant la sentència  '@import'.
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;style type=<span class="code-quote">"text/css"</span> media=<span class="code-quote">"all"</span>&gt;

@<span class="code-keyword">import</span> <span class="code-quote">"file1.css"</span>;

@<span class="code-keyword">import</span>  <span class="code-quote">"file2.css"</span>;

&lt;/style&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-Utilitzaci%C3%B3deidsiclasses"></a>Utilització de ids i classes</h3>

<p>Mitjançant l'ús d'identificadors de classe (incorporant '.' al davant del nom  de la classe) podem definir quin serà l'estil a aplicar a tots els tags que  incorporin aquest nom de class (en els tags canigo correspon a la propietat  'styleClass').
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">.required \{font-family: Verdana; font-size: 12pt; color: red; \}</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Aquest estil s'aplicarà a tots els components que tinguin com a  class='required', siguin divs, spans, ...
<br clear="all" />
<br clear="all" />
En cas que volem aplicar un estil a un únic component farem servir  identificadors. És a dir, partint del id assignat al component (en canigo  l'atribut 'styleId' dels components), podem assignar un estil usant '#':
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">#header \{width: 90%; background: white; font-size: 20px; color:  purple; \}</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;div id=<span class="code-quote">"header"</span>&gt;...&lt;/div&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Sempre podem definir els estils al mateix component (atribut 'style') o  sobreescriure els definits al fitxer d'estil:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;span class=<span class="code-quote">"caution"</span> style=<span class="code-quote">"color: green"</span>&gt;text&lt;/span&gt;</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Si volem definir el mateix estil a diferents ids o classes podem separar  cadascun d'ells amb espai tal i com es mostra en el següent exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">p b \{color: red; \}</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
Inclús podem definir que tots els components inclosos a un id o class  determinat actuïn de forma determinada:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">div#navigation a \{color: white; \}</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
En aquest cas, s'aplicarà l'estil a tots els '&lt;a href...' que estiguin  inclosos a un div amb id='navigation'
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-EfectesComuns"></a>Efectes Comuns</h3>

<p>En la següent taula es mostra un resum d'algunes de les propietats més útils  a definir:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Efecte</b> </th>
<th class='confluenceTh'> <b>Configuració</b> </th>
</tr>
<tr>
<td class='confluenceTd'> <b>Text en itàlica</b> </td>
<td class='confluenceTd'> font-style: italic; (tornar a normal  amb font-style:normal) </td>
</tr>
<tr>
<td class='confluenceTd'> Text en negreta </td>
<td class='confluenceTd'> font-weight: bold; (tornar a normal  amb font-weight:normal) </td>
</tr>
<tr>
<td class='confluenceTd'> Text en normal </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> Capitalització </td>
<td class='confluenceTd'><ol>
	<li>Tot a majúscules: text-transform: uppercase; <br clear="all" />
&#35; Tot a  minúscules: text-transform: lowercase; <br clear="all" />
&#35; Primera lletra a  majúscules: text-transform: capitalize; <br clear="all" />
&#35; Normal:text-transform:  normal; <br clear="all" /> </li>
</ol>
</td>
</tr>
<tr>
<td class='confluenceTd'> Enllaç sense decoració </td>
<td class='confluenceTd'> <b>a</b> {text-decoration: none; } </td>
</tr>
<tr>
<td class='confluenceTd'> <b>Marges</b> </td>
<td class='confluenceTd'> margin: 20px; <br clear="all" />
margin-left: 2px; margin-top: 80px; margin-right: 45px; margin-bottom:  &#45;5px; <br clear="all" />
<br clear="all" />
<b>IMPORTANT</b>: <br clear="all" />
<br clear="all" />
Des de que va sortir HTML el body incorpora un espai addicional que  podem eliminar amb: <br clear="all" />
<br clear="all" />
<b>body</b> {margin: 0px;  padding: 0px; } <br clear="all" />
<br clear="all" /> </td>
</tr>
<tr>
<td class='confluenceTd'> Padding </td>
<td class='confluenceTd'> S'aplica entre els elements <br clear="all" />
padding: 6px; padding-bottom: 2px; padding-left: 18px; </td>
</tr>
<tr>
<td class='confluenceTd'> Color de Background als elements </td>
<td class='confluenceTd'> background-color: green; <br clear="all" />
background-color: rgb(0,108,64); </td>
</tr>
<tr>
<td class='confluenceTd'> Imatge de background als elements </td>
<td class='confluenceTd'> background-image:  url(images/required.gif); </td>
</tr>
</tbody></table>

<h3><a name="Serveidepresentaci%C3%B3detags2.2-PseudoClasses"></a>Pseudo  Classes</h3>

<p>Tot i que podem definir selectors o estils a la majoria d'elements, hi ha  parts que no són elements en sí sinó parts d'aquests. Mitjançant pseudo classes  podem accedir a aquests elements.</p>

<p>Com a guia de canigo es proporciona al fitxer d'estils una pseudo classe per  presentar els components d'entrada de diferent forma quan ubiquem el focus.
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">form input, form textarea, form select {
    padding-left: 4px;
    color: #666;
}

/* Warning: IE doesn't support pseudo-class :focus */
form input:focus, form textarea:focus, form select:focus {
    border-bottom: #ffdead solid 2px;
    border-right: #ffdead solid 2px;
    border-left: #c07300 solid 2px;
    border-top: #c07300 solid 2px;
    color: #000;
}</pre>
</div></div><br clear="all" /> <br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
NOTA: Internet Explorer no suporta pseudo classes
<br clear="all" />
<br clear="all" />
Podeu veure una introducció a  'http://www.adaptivepath.com/publications/essays/archives/000385.php'<br/>
llibreria de generació de access keys: <a href="http://www.gerv.net/software/aul/" title="Visit page outside Confluence">http://www.gerv.net/software/aul/</a><br/>
<a href="http://209.61.157.8:8080/taglibs/" title="Visit page outside Confluence">http://209.61.157.8:8080/taglibs/</a>
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" />
<br clear="all" /></p>

				    					    <br/>
               
				    
                    			    </td>
		    </tr>
	    </table>
	  
    </body>
</html>